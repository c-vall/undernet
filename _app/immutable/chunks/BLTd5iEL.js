import{g as vt}from"./CqkleIqs.js";var pt={exports:{}},_t;function bt(){return _t||(_t=1,function(Et,Pt){(function(E,m){Et.exports=m()})(window,function(){return function(j){var E={};function m(l){if(E[l])return E[l].exports;var g=E[l]={i:l,l:!1,exports:{}};return j[l].call(g.exports,g,g.exports,m),g.l=!0,g.exports}return m.m=j,m.c=E,m.d=function(l,g,A){m.o(l,g)||Object.defineProperty(l,g,{enumerable:!0,get:A})},m.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},m.t=function(l,g){if(g&1&&(l=m(l)),g&8||g&4&&typeof l=="object"&&l&&l.__esModule)return l;var A=Object.create(null);if(m.r(A),Object.defineProperty(A,"default",{enumerable:!0,value:l}),g&2&&typeof l!="string")for(var t in l)m.d(A,t,(function(e){return l[e]}).bind(null,t));return A},m.n=function(l){var g=l&&l.__esModule?function(){return l.default}:function(){return l};return m.d(g,"a",g),g},m.o=function(l,g){return Object.prototype.hasOwnProperty.call(l,g)},m.p="",m(m.s="./src/index.js")}({"./node_modules/@assemblyscript/loader/index.js":function(j,E,m){m.r(E),m.d(E,"instantiate",function(){return x}),m.d(E,"instantiateSync",function(){return I}),m.d(E,"instantiateStreaming",function(){return U}),m.d(E,"demangle",function(){return R});const l=-8,g=-4,A=0,t=1,e=1,s=2,i=4,a=6,h=2048,n=4096,r=16384,u=0,v=4,c=8,f=12,o=12,p=16,d=typeof BigUint64Array<"u",P=Symbol(),X=32,M=new TextDecoder("utf-16le");function C(S,y){const F=new Uint32Array(S)[y+g>>>2]>>>1,D=new Uint16Array(S,y,F);return F<=X?String.fromCharCode.apply(String,D):M.decode(D)}function w(S){const y={};function F(z,O){return z?C(z.buffer,O):"<yet unknown>"}const D=S.env=S.env||{};return D.abort=D.abort||function(O,V,K,B){const Q=y.memory||D.memory;throw Error(`abort: ${F(Q,O)} at ${F(Q,V)}:${K}:${B}`)},D.trace=D.trace||function(O,V,...K){const B=y.memory||D.memory;console.log(`trace: ${F(B,O)}${V?" ":""}${K.slice(0,V).join(", ")}`)},D.seed=D.seed||Date.now,S.Math=S.Math||Math,S.Date=S.Date||Date,y}function b(S,y){const F=y.exports,D=F.memory,z=F.table,O=F.__new,V=F.__retain,K=F.__rtti_base||-1;function B(W){const H=new Uint32Array(D.buffer),J=H[K>>>2];if((W>>>=0)>=J)throw Error(`invalid id: ${W}`);return H[(K+4>>>2)+W*2]}function Q(W){const H=B(W);if(!(H&(e|s|i)))throw Error(`not an array: ${W}, flags=${H}`);return H}function N(W){const H=new Uint32Array(D.buffer),J=H[K>>>2];if((W>>>=0)>=J)throw Error(`invalid id: ${W}`);return H[(K+4>>>2)+W*2+1]}function q(W){return 31-Math.clz32(W>>>a&31)}function Y(W){if(W==null)return 0;const H=W.length,J=O(H<<1,t),k=new Uint16Array(D.buffer);for(var Z=0,$=J>>>1;Z<H;++Z)k[$+Z]=W.charCodeAt(Z);return J}S.__newString=Y;function L(W){if(!W)return null;const H=D.buffer;if(new Uint32Array(H)[W+l>>>2]!==t)throw Error(`not a string: ${W}`);return C(H,W)}S.__getString=L;function it(W,H,J){const k=D.buffer;if(J)switch(W){case 2:return new Float32Array(k);case 3:return new Float64Array(k)}else switch(W){case 0:return new(H?Int8Array:Uint8Array)(k);case 1:return new(H?Int16Array:Uint16Array)(k);case 2:return new(H?Int32Array:Uint32Array)(k);case 3:return new(H?BigInt64Array:BigUint64Array)(k)}throw Error(`unsupported align: ${W}`)}function G(W,H){const J=Q(W),k=q(J),Z=H.length,$=O(Z<<k,J&i?W:A);let lt;if(J&i)lt=$;else{const tt=O(J&s?p:f,W),et=new Uint32Array(D.buffer);et[tt+u>>>2]=V($),et[tt+v>>>2]=$,et[tt+c>>>2]=Z<<k,J&s&&(et[tt+o>>>2]=Z),lt=tt}const At=it(k,J&h,J&n);if(J&r)for(let tt=0;tt<Z;++tt)At[($>>>k)+tt]=V(H[tt]);else At.set(H,$>>>k);return lt}S.__newArray=G;function at(W){const H=new Uint32Array(D.buffer),J=H[W+l>>>2],k=Q(J),Z=q(k);let $=k&i?W:H[W+v>>>2];const lt=k&s?H[W+o>>>2]:H[$+g>>>2]>>>Z;return it(Z,k&h,k&n).subarray($>>>=Z,$+lt)}S.__getArrayView=at;function ot(W){const H=at(W),J=H.length,k=new Array(J);for(let Z=0;Z<J;Z++)k[Z]=H[Z];return k}S.__getArray=ot;function ht(W){const H=D.buffer,J=new Uint32Array(H)[W+g>>>2];return H.slice(W,W+J)}S.__getArrayBuffer=ht;function gt(W,H,J){return new W(st(W,H,J))}function st(W,H,J){const k=D.buffer,Z=new Uint32Array(k),$=Z[J+v>>>2];return new W(k,$,Z[$+g>>>2]>>>H)}function rt(W,H,J){S[`__get${H}`]=gt.bind(null,W,J),S[`__get${H}View`]=st.bind(null,W,J)}[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array].forEach(W=>{rt(W,W.name,31-Math.clz32(W.BYTES_PER_ELEMENT))}),d&&[BigUint64Array,BigInt64Array].forEach(W=>{rt(W,W.name.slice(3),3)});function ut(W,H){const J=new Uint32Array(D.buffer);let k=J[W+l>>>2];if(k<=J[K>>>2])do{if(k==H)return!0;k=N(k)}while(k);return!1}return S.__instanceof=ut,S.memory=S.memory||D,S.table=S.table||z,R(F,S)}function _(S){return typeof Response<"u"&&S instanceof Response}function T(S){return S instanceof WebAssembly.Module}async function x(S,y={}){if(_(S=await S))return U(S,y);const F=T(S)?S:await WebAssembly.compile(S),D=w(y),z=await WebAssembly.instantiate(F,y),O=b(D,z);return{module:F,instance:z,exports:O}}function I(S,y={}){const F=T(S)?S:new WebAssembly.Module(S),D=w(y),z=new WebAssembly.Instance(F,y),O=b(D,z);return{module:F,instance:z,exports:O}}async function U(S,y={}){if(!WebAssembly.instantiateStreaming)return x(_(S=await S)?S.arrayBuffer():S,y);const F=w(y),D=await WebAssembly.instantiateStreaming(S,y),z=b(F,D.instance);return{...D,exports:z}}function R(S,y={}){const F=S.__argumentsLength?D=>{S.__argumentsLength.value=D}:S.__setArgumentsLength||S.__setargc||(()=>{});for(let D in S){if(!Object.prototype.hasOwnProperty.call(S,D))continue;const z=S[D];let O=D.split("."),V=y;for(;O.length>1;){let Q=O.shift();Object.prototype.hasOwnProperty.call(V,Q)||(V[Q]={}),V=V[Q]}let K=O[0],B=K.indexOf("#");if(B>=0){const Q=K.substring(0,B),N=V[Q];if(typeof N>"u"||!N.prototype){const q=function(...Y){return q.wrap(q.prototype.constructor(0,...Y))};q.prototype={valueOf(){return this[P]}},q.wrap=function(Y){return Object.create(q.prototype,{[P]:{value:Y,writable:!1}})},N&&Object.getOwnPropertyNames(N).forEach(Y=>Object.defineProperty(q,Y,Object.getOwnPropertyDescriptor(N,Y))),V[Q]=q}if(K=K.substring(B+1),V=V[Q].prototype,/^(get|set):/.test(K)){if(!Object.prototype.hasOwnProperty.call(V,K=K.substring(4))){let q=S[D.replace("set:","get:")],Y=S[D.replace("get:","set:")];Object.defineProperty(V,K,{get(){return q(this[P])},set(L){Y(this[P],L)},enumerable:!0})}}else K==="constructor"?(V[K]=(...q)=>(F(q.length),z(...q))).original=z:(V[K]=function(...q){return F(q.length),z(this[P],...q)}).original=z}else/^(get|set):/.test(K)?Object.prototype.hasOwnProperty.call(V,K=K.substring(4))||Object.defineProperty(V,K,{get:S[D.replace("set:","get:")],set:S[D.replace("get:","set:")],enumerable:!0}):typeof z=="function"&&z!==F?(V[K]=(...Q)=>(F(Q.length),z(...Q))).original=z:V[K]=z}return y}E.default={instantiate:x,instantiateSync:I,instantiateStreaming:U,demangle:R}},"./node_modules/@babel/runtime/helpers/defineProperty.js":function(j,E){function m(l,g,A){return g in l?Object.defineProperty(l,g,{value:A,enumerable:!0,configurable:!0,writable:!0}):l[g]=A,l}j.exports=m},"./node_modules/ecma-proposal-math-extensions/reference-implementation/index.js":function(j,E,m){{const l=(A,t)=>{var e=typeof t=="function",s=typeof t=="function",i=typeof t=="function";Object.defineProperty(Math,A,{configurable:e,enumerable:i,writable:s,value:t})};l("DEG_PER_RAD",Math.PI/180),l("RAD_PER_DEG",180/Math.PI);const g=new Float32Array(1);l("scale",function(t,e,s,i,a){return arguments.length===0?NaN:Number.isNaN(t)||Number.isNaN(e)||Number.isNaN(s)||Number.isNaN(i)||Number.isNaN(a)?NaN:t===1/0||t===-1/0?t:(t-e)*(a-i)/(s-e)+i}),l("fscale",function(t,e,s,i,a){return g[0]=Math.scale(t,e,s,i,a),g[0]}),l("clamp",function(t,e,s){return Math.min(s,Math.max(e,t))}),l("radians",function(t){return t*Math.DEG_PER_RAD}),l("degrees",function(t){return t*Math.RAD_PER_DEG})}},"./node_modules/eel-wasm/dist/build/parser.js":function(j,E,m){(function(l,g){var A=function(){var t=function(K,B,Q,N){for(Q=Q||{},N=K.length;N--;Q[K[N]]=B);return Q},e=[1,18],s=[1,7],i=[1,19],a=[1,20],h=[1,14],n=[1,15],r=[1,16],u=[1,33],v=[1,31],c=[1,23],f=[1,22],o=[1,24],p=[1,25],d=[1,26],P=[1,27],X=[1,28],M=[1,29],C=[1,30],w=[5,8,15,18,20,28,29,32,33,34,35,36,37,38],b=[5,15,18],_=[5,12,15,17,18,24,25,28,29,30],T=[1,57],x=[5,8,12,15,17,18,24,25,28,29,30],I=[15,18],U=[5,8,15,18,28,29,38],R=[5,8,15,18,28,29,32,33,38],S=[5,8,15,18,28,29,32,33,34,37,38],y=[5,8,15,18,28,29,32,33,34,35,36,37,38],F=[5,8,15,18],D=[5,8,15,18,20,22,28,29,32,33,34,35,36,37,38],z={trace:function(){},yy:{},symbols_:{error:2,SCRIPT:3,expression:4,EOF:5,expressionsOptionalTrailingSemi:6,separator:7,";":8,expressions:9,EXPRESSION_BLOCK:10,IDENTIFIER:11,IDENTIFIER_TOKEN:12,argument:13,arguments:14,",":15,FUNCTION_CALL:16,"(":17,")":18,LOGICAL_EXPRESSION:19,LOGICAL_OPERATOR_TOKEN:20,ASSIGNMENT:21,ASSIGNMENT_OPERATOR_TOKEN:22,number:23,DIGITS_TOKEN:24,".":25,NUMBER_LITERAL:26,UNARY_EXPRESSION:27,"-":28,"+":29,"!":30,BINARY_EXPRESSION:31,"*":32,"/":33,"%":34,"&":35,"|":36,"^":37,COMPARISON_TOKEN:38,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",8:";",12:"IDENTIFIER_TOKEN",15:",",17:"(",18:")",20:"LOGICAL_OPERATOR_TOKEN",22:"ASSIGNMENT_OPERATOR_TOKEN",24:"DIGITS_TOKEN",25:".",28:"-",29:"+",30:"!",32:"*",33:"/",34:"%",35:"&",36:"|",37:"^",38:"COMPARISON_TOKEN"},productions_:[0,[3,2],[3,2],[3,1],[7,1],[7,2],[9,2],[9,3],[6,1],[6,2],[10,1],[11,1],[13,1],[13,1],[14,1],[14,3],[16,3],[16,4],[19,3],[21,3],[21,3],[23,1],[23,2],[23,3],[23,2],[23,1],[26,1],[27,2],[27,2],[27,2],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[4,1],[4,1],[4,3],[4,1],[4,1],[4,1],[4,1],[4,1],[4,3]],performAction:function(B,Q,N,q,Y,L,it){var G=L.length-1;switch(Y){case 1:return{type:"SCRIPT",body:[L[G-1]],loc:this._$};case 2:return{type:"SCRIPT",body:L[G-1],loc:this._$};case 3:return{type:"SCRIPT",body:[],loc:this._$};case 6:this.$=[L[G-1]];break;case 7:this.$=L[G-2].concat([L[G-1]]);break;case 8:this.$=L[G];break;case 9:this.$=L[G-1].concat([L[G]]);break;case 10:this.$={type:"EXPRESSION_BLOCK",body:L[G],loc:this._$};break;case 11:this.$={type:"IDENTIFIER",value:L[G].toLowerCase(),loc:this._$};break;case 14:this.$=[L[G]];break;case 15:this.$=L[G-2].concat([L[G]]);break;case 16:this.$={type:"CALL_EXPRESSION",callee:L[G-2],arguments:[],loc:this._$};break;case 17:this.$={type:"CALL_EXPRESSION",callee:L[G-3],arguments:L[G-1],loc:this._$};break;case 18:this.$={type:"LOGICAL_EXPRESSION",left:L[G-2],right:L[G],operator:L[G-1],loc:this._$};break;case 19:case 20:this.$={type:"ASSIGNMENT_EXPRESSION",left:L[G-2],operator:L[G-1],right:L[G],loc:this._$};break;case 21:this.$=Number(L[G]);break;case 22:this.$=Number(L[G-1]);break;case 23:this.$=Number(L[G-2]+L[G-1]+L[G]);break;case 24:this.$=+("0"+L[G-1]+L[G]);break;case 25:this.$=0;break;case 26:this.$={type:"NUMBER_LITERAL",value:L[G],loc:this._$};break;case 27:case 28:case 29:this.$={type:"UNARY_EXPRESSION",value:L[G],operator:L[G-1],loc:this._$};break;case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:case 38:this.$={type:"BINARY_EXPRESSION",left:L[G-2],right:L[G],operator:L[G-1],loc:this._$};break;case 41:case 47:this.$=L[G-1];break}},table:[{3:1,4:2,5:[1,4],6:3,9:13,11:11,12:e,16:10,17:s,19:12,21:9,23:17,24:i,25:a,26:8,27:6,28:h,29:n,30:r,31:5},{1:[3]},{5:[1,21],7:32,8:u,20:v,28:c,29:f,32:o,33:p,34:d,35:P,36:X,37:M,38:C},{5:[1,34]},{1:[2,3]},t(w,[2,39]),t(w,[2,40]),{4:35,6:37,9:13,10:36,11:11,12:e,16:10,17:s,19:12,21:9,23:17,24:i,25:a,26:8,27:6,28:h,29:n,30:r,31:5},t(w,[2,42]),t(w,[2,43]),t(w,[2,44],{22:[1,38]}),t(w,[2,45],{17:[1,40],22:[1,39]}),t(w,[2,46]),t(b,[2,8],{31:5,27:6,26:8,21:9,16:10,11:11,19:12,23:17,4:41,12:e,17:s,24:i,25:a,28:h,29:n,30:r}),{4:42,11:11,12:e,16:10,17:s,19:12,21:9,23:17,24:i,25:a,26:8,27:6,28:h,29:n,30:r,31:5},{4:43,11:11,12:e,16:10,17:s,19:12,21:9,23:17,24:i,25:a,26:8,27:6,28:h,29:n,30:r,31:5},{4:44,11:11,12:e,16:10,17:s,19:12,21:9,23:17,24:i,25:a,26:8,27:6,28:h,29:n,30:r,31:5},t(w,[2,26]),t([5,8,15,17,18,20,22,28,29,32,33,34,35,36,37,38],[2,11]),t(w,[2,21],{25:[1,45]}),t(w,[2,25],{24:[1,46]}),{1:[2,1]},{4:47,11:11,12:e,16:10,17:s,19:12,21:9,23:17,24:i,25:a,26:8,27:6,28:h,29:n,30:r,31:5},{4:48,11:11,12:e,16:10,17:s,19:12,21:9,23:17,24:i,25:a,26:8,27:6,28:h,29:n,30:r,31:5},{4:49,11:11,12:e,16:10,17:s,19:12,21:9,23:17,24:i,25:a,26:8,27:6,28:h,29:n,30:r,31:5},{4:50,11:11,12:e,16:10,17:s,19:12,21:9,23:17,24:i,25:a,26:8,27:6,28:h,29:n,30:r,31:5},{4:51,11:11,12:e,16:10,17:s,19:12,21:9,23:17,24:i,25:a,26:8,27:6,28:h,29:n,30:r,31:5},{4:52,11:11,12:e,16:10,17:s,19:12,21:9,23:17,24:i,25:a,26:8,27:6,28:h,29:n,30:r,31:5},{4:53,11:11,12:e,16:10,17:s,19:12,21:9,23:17,24:i,25:a,26:8,27:6,28:h,29:n,30:r,31:5},{4:54,11:11,12:e,16:10,17:s,19:12,21:9,23:17,24:i,25:a,26:8,27:6,28:h,29:n,30:r,31:5},{4:55,11:11,12:e,16:10,17:s,19:12,21:9,23:17,24:i,25:a,26:8,27:6,28:h,29:n,30:r,31:5},{4:56,11:11,12:e,16:10,17:s,19:12,21:9,23:17,24:i,25:a,26:8,27:6,28:h,29:n,30:r,31:5},t(_,[2,6],{8:T}),t(x,[2,4]),{1:[2,2]},{7:32,8:u,18:[1,58],20:v,28:c,29:f,32:o,33:p,34:d,35:P,36:X,37:M,38:C},{18:[1,59]},t(I,[2,10]),{4:60,11:11,12:e,16:10,17:s,19:12,21:9,23:17,24:i,25:a,26:8,27:6,28:h,29:n,30:r,31:5},{4:61,11:11,12:e,16:10,17:s,19:12,21:9,23:17,24:i,25:a,26:8,27:6,28:h,29:n,30:r,31:5},{4:65,6:37,9:13,10:66,11:11,12:e,13:64,14:63,16:10,17:s,18:[1,62],19:12,21:9,23:17,24:i,25:a,26:8,27:6,28:h,29:n,30:r,31:5},t(b,[2,9],{7:67,8:u,20:v,28:c,29:f,32:o,33:p,34:d,35:P,36:X,37:M,38:C}),t(U,[2,27],{20:v,32:o,33:p,34:d,35:P,36:X,37:M}),t(U,[2,28],{20:v,32:o,33:p,34:d,35:P,36:X,37:M}),t(U,[2,29],{20:v,32:o,33:p,34:d,35:P,36:X,37:M}),t(w,[2,22],{24:[1,68]}),t(w,[2,24]),t(U,[2,30],{20:v,32:o,33:p,34:d,35:P,36:X,37:M}),t(U,[2,31],{20:v,32:o,33:p,34:d,35:P,36:X,37:M}),t(R,[2,32],{20:v,34:d,35:P,36:X,37:M}),t(R,[2,33],{20:v,34:d,35:P,36:X,37:M}),t(S,[2,34],{20:v,35:P,36:X}),t(y,[2,35],{20:v}),t(y,[2,36],{20:v}),t(S,[2,37],{20:v,35:P,36:X}),t(F,[2,38],{20:v,28:c,29:f,32:o,33:p,34:d,35:P,36:X,37:M,38:C}),t(w,[2,18]),t(x,[2,5]),t(w,[2,41]),t(w,[2,47]),t(F,[2,20],{20:v,28:c,29:f,32:o,33:p,34:d,35:P,36:X,37:M,38:C}),t(F,[2,19],{20:v,28:c,29:f,32:o,33:p,34:d,35:P,36:X,37:M,38:C}),t(D,[2,16]),{15:[1,70],18:[1,69]},t(I,[2,14]),t(I,[2,12],{7:32,8:u,20:v,28:c,29:f,32:o,33:p,34:d,35:P,36:X,37:M,38:C}),t(I,[2,13]),t(_,[2,7],{8:T}),t(w,[2,23]),t(D,[2,17]),{4:65,6:37,9:13,10:66,11:11,12:e,13:71,16:10,17:s,19:12,21:9,23:17,24:i,25:a,26:8,27:6,28:h,29:n,30:r,31:5},t(I,[2,15])],defaultActions:{4:[2,3],21:[2,1],34:[2,2]},parseError:function(B,Q){if(Q.recoverable)this.trace(B);else{var N=new Error(B);throw N.hash=Q,N}},parse:function(B){var Q=this,N=[0],q=[null],Y=[],L=this.table,it="",G=0,at=0,ot=2,ht=1,gt=Y.slice.call(arguments,1),st=Object.create(this.lexer),rt={yy:{}};for(var ut in this.yy)Object.prototype.hasOwnProperty.call(this.yy,ut)&&(rt.yy[ut]=this.yy[ut]);st.setInput(B,rt.yy),rt.yy.lexer=st,rt.yy.parser=this,typeof st.yylloc>"u"&&(st.yylloc={});var W=st.yylloc;Y.push(W);var H=st.options&&st.options.ranges;typeof rt.yy.parseError=="function"?this.parseError=rt.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var J=function(){var ct;return ct=st.lex()||ht,typeof ct!="number"&&(ct=Q.symbols_[ct]||ct),ct},k,Z,$,lt,At={},tt,et,dt,ft;;){if(Z=N[N.length-1],this.defaultActions[Z]?$=this.defaultActions[Z]:((k===null||typeof k>"u")&&(k=J()),$=L[Z]&&L[Z][k]),typeof $>"u"||!$.length||!$[0]){var mt="";ft=[];for(tt in L[Z])this.terminals_[tt]&&tt>ot&&ft.push("'"+this.terminals_[tt]+"'");st.showPosition?mt="Parse error on line "+(G+1)+`:
`+st.showPosition()+`
Expecting `+ft.join(", ")+", got '"+(this.terminals_[k]||k)+"'":mt="Parse error on line "+(G+1)+": Unexpected "+(k==ht?"end of input":"'"+(this.terminals_[k]||k)+"'"),this.parseError(mt,{text:st.match,token:this.terminals_[k]||k,line:st.yylineno,loc:W,expected:ft})}if($[0]instanceof Array&&$.length>1)throw new Error("Parse Error: multiple actions possible at state: "+Z+", token: "+k);switch($[0]){case 1:N.push(k),q.push(st.yytext),Y.push(st.yylloc),N.push($[1]),k=null,at=st.yyleng,it=st.yytext,G=st.yylineno,W=st.yylloc;break;case 2:if(et=this.productions_[$[1]][1],At.$=q[q.length-et],At._$={first_line:Y[Y.length-(et||1)].first_line,last_line:Y[Y.length-1].last_line,first_column:Y[Y.length-(et||1)].first_column,last_column:Y[Y.length-1].last_column},H&&(At._$.range=[Y[Y.length-(et||1)].range[0],Y[Y.length-1].range[1]]),lt=this.performAction.apply(At,[it,at,G,rt.yy,$[1],q,Y].concat(gt)),typeof lt<"u")return lt;et&&(N=N.slice(0,-1*et*2),q=q.slice(0,-1*et),Y=Y.slice(0,-1*et)),N.push(this.productions_[$[1]][0]),q.push(At.$),Y.push(At._$),dt=L[N[N.length-2]][N[N.length-1]],N.push(dt);break;case 3:return!0}}return!0}},O=function(){var K={EOF:1,parseError:function(Q,N){if(this.yy.parser)this.yy.parser.parseError(Q,N);else throw new Error(Q)},setInput:function(B,Q){return this.yy=Q||this.yy||{},this._input=B,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var B=this._input[0];this.yytext+=B,this.yyleng++,this.offset++,this.match+=B,this.matched+=B;var Q=B.match(/(?:\r\n?|\n).*/g);return Q?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),B},unput:function(B){var Q=B.length,N=B.split(/(?:\r\n?|\n)/g);this._input=B+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-Q),this.offset-=Q;var q=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),N.length-1&&(this.yylineno-=N.length-1);var Y=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:N?(N.length===q.length?this.yylloc.first_column:0)+q[q.length-N.length].length-N[0].length:this.yylloc.first_column-Q},this.options.ranges&&(this.yylloc.range=[Y[0],Y[0]+this.yyleng-Q]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(B){this.unput(this.match.slice(B))},pastInput:function(){var B=this.matched.substr(0,this.matched.length-this.match.length);return(B.length>20?"...":"")+B.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var B=this.match;return B.length<20&&(B+=this._input.substr(0,20-B.length)),(B.substr(0,20)+(B.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var B=this.pastInput(),Q=new Array(B.length+1).join("-");return B+this.upcomingInput()+`
`+Q+"^"},test_match:function(B,Q){var N,q,Y;if(this.options.backtrack_lexer&&(Y={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(Y.yylloc.range=this.yylloc.range.slice(0))),q=B[0].match(/(?:\r\n?|\n).*/g),q&&(this.yylineno+=q.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:q?q[q.length-1].length-q[q.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+B[0].length},this.yytext+=B[0],this.match+=B[0],this.matches=B,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(B[0].length),this.matched+=B[0],N=this.performAction.call(this,this.yy,this,Q,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),N)return N;if(this._backtrack){for(var L in Y)this[L]=Y[L];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var B,Q,N,q;this._more||(this.yytext="",this.match="");for(var Y=this._currentRules(),L=0;L<Y.length;L++)if(N=this._input.match(this.rules[Y[L]]),N&&(!Q||N[0].length>Q[0].length)){if(Q=N,q=L,this.options.backtrack_lexer){if(B=this.test_match(N,Y[L]),B!==!1)return B;if(this._backtrack){Q=!1;continue}else return!1}else if(!this.options.flex)break}return Q?(B=this.test_match(Q,Y[q]),B!==!1?B:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var Q=this.next();return Q||this.lex()},begin:function(Q){this.conditionStack.push(Q)},popState:function(){var Q=this.conditionStack.length-1;return Q>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(Q){return Q=this.conditionStack.length-1-Math.abs(Q||0),Q>=0?this.conditionStack[Q]:"INITIAL"},pushState:function(Q){this.begin(Q)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(Q,N,q,Y){switch(q){case 0:break;case 1:return 24;case 2:return 38;case 3:return 22;case 4:return 20;case 5:return 12;case 6:return 5;case 7:return N.yytext[0]}},rules:[/^(?:\s+)/,/^(?:[0-9]+)/,/^(?:(==|!=|<=|>=|<|>))/,/^(?:[+\-*/%]?=)/,/^(?:(\&\&)|\|\|)/,/^(?:[a-zA-Z_][a-zA-Z0-9._]*)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7],inclusive:!0}}};return K}();z.lexer=O;function V(){this.yy={}}return V.prototype=z,z.Parser=V,new V}();E.parser=A,E.Parser=A.Parser,E.parse=function(){return A.parse.apply(A,arguments)},E.main=()=>{},m.c[m.s]===l&&E.main(g.argv.slice(1))}).call(this,m("./node_modules/webpack/buildin/module.js")(j),m("./node_modules/process/browser.js"))},"./node_modules/eel-wasm/dist/src/astUtils.js":function(j,E,m){Object.defineProperty(E,"__esModule",{value:!0});const l={ASSIGNMENT_EXPRESSION:[{type:"NODE",key:"right"}],SCRIPT:[{type:"ARRAY",key:"body"}],EXPRESSION_BLOCK:[{type:"ARRAY",key:"body"}],UNARY_EXPRESSION:[{type:"NODE",key:"value"}],NUMBER_LITERAL:[],IDENTIFIER:[],CALL_EXPRESSION:[{type:"ARRAY",key:"arguments"},{type:"NODE",key:"callee"}],BINARY_EXPRESSION:[{type:"NODE",key:"left"},{type:"NODE",key:"right"}],LOGICAL_EXPRESSION:[{type:"NODE",key:"left"},{type:"NODE",key:"right"}]};function g(A,t){const e=l[A.type];let s=A;if(e==null)throw new Error(`Unknown children definition for ${A.type}`);return e.forEach(i=>{if(i.type==="NODE"){const a=A[i.key],h=g(a,t);h!==a&&(s=Object.assign(Object.assign({},s),{[i.key]:h}))}else if(i.type==="ARRAY"){const a=A[i.key],h=a.map(r=>g(r,t));a.some((r,u)=>r!==h[u])&&(s=Object.assign(Object.assign({},s),{[i.key]:h}))}}),t(s)}E.mapAst=g},"./node_modules/eel-wasm/dist/src/compiler.js":function(j,E,m){var l=this&&this.__importDefault||function(r){return r&&r.__esModule?r:{default:r}},g=this&&this.__importStar||function(r){if(r&&r.__esModule)return r;var u={};if(r!=null)for(var v in r)Object.hasOwnProperty.call(r,v)&&(u[v]=r[v]);return u.default=r,u};Object.defineProperty(E,"__esModule",{value:!0});const A=m("./node_modules/eel-wasm/dist/src/parser.js"),t=m("./node_modules/eel-wasm/dist/src/emitter.js"),e=m("./node_modules/eel-wasm/dist/src/encoding.js"),s=l(m("./node_modules/eel-wasm/dist/src/shims.js")),i=g(m("./node_modules/eel-wasm/dist/src/utils.js")),a=m("./node_modules/eel-wasm/dist/src/wasmFunctions.js"),h=m("./node_modules/eel-wasm/dist/src/constants.js");function n({pools:r,functions:u,eelVersion:v=2,preParsed:c=!1}){if(Object.keys(r).includes("shims"))throw new Error('You may not name a pool "shims". "shims" is reserved for injected JavaScript functions.');const f=[];Object.entries(r).forEach(([y,F])=>{F.forEach(D=>{f.push([y,D])})});const o=new i.ScopedIdMap;f.forEach(([y,F])=>{o.get(y,F)});const p=Object.entries(s.default).map(([y,F])=>({args:new Array(F.length).fill(null).map(D=>e.VAL_TYPE.f64),returns:[e.VAL_TYPE.f64],name:y})),d=[],P=[];Object.entries(u).forEach(([y,{pool:F,code:D}])=>{if(r[F]==null){const B=Object.keys(r);throw B.length===0?new Error(`The function "${y}" was declared as using a variable pool named "${F}" but no pools were defined.`):new Error(`The function "${y}" was declared as using a variable pool named "${F}" which is not among the variable pools defined. The defined variable pools are: ${i.formatList(B)}.`)}const z=c?D:A.parse(D);if(typeof z=="string")throw new Error("Got passed unparsed code without setting the preParsed flag");if(z.type!=="SCRIPT")throw new Error("Invalid AST");if(z.body.length===0)return;const O=[],V={resolveVar:B=>/^reg\d\d$/.test(B)?o.get(null,B):o.get(F,B),resolveLocal:B=>(O.push(B),O.length-1),resolveFunc:B=>{const Q=p.findIndex(q=>q.name===B);if(Q!==-1){const q=e.op.call(Q);return B==="rand"&&v===1?[...q,e.op.f64_floor]:q}if(a.localFuncMap[B]==null)return null;let N=d.indexOf(B);return N===-1&&(d.push(B),N=d.length-1),e.op.call(N+p.length)},rawSource:D},K=t.emit(z,V);P.push({binary:K,exportName:y,args:[],returns:[],localVariables:O})});const X=d.map(y=>{const F=a.localFuncMap[y];if(F==null)throw new Error(`Undefined local function "${y}"`);return F}),M=y=>[...y.args,"|",...y.returns].join("-"),C=[],w=new Map;[...p,...X,...P].forEach(y=>{const F=M(y);w.has(F)||(C.push([e.FUNCTION_TYPE,...e.encodeFlatVector(y.args),...e.encodeFlatVector(y.returns)]),w.set(F,C.length-1))});function b(y){const F=M(y),D=w.get(F);if(D==null)throw new Error(`Failed to get a type index for key ${F}`);return D}const _=[...f.map(([y,F])=>[...e.encodeString(y),...e.encodeString(F),e.GLOBAL_TYPE,e.VAL_TYPE.f64,e.MUTABILITY.var]),...p.map((y,F)=>{const D=b(y);return[...e.encodeString("shims"),...e.encodeString(y.name),e.TYPE_IDX,...e.unsignedLEB128(D)]})],T=[...X,...P].map(y=>{const F=b(y);return e.unsignedLEB128(F)}),x=[[1,...e.unsignedLEB128(h.WASM_MEMORY_SIZE),...e.unsignedLEB128(h.WASM_MEMORY_SIZE)]],I=o.size()-f.length,U=i.times(I,()=>[e.VAL_TYPE.f64,e.MUTABILITY.var,...e.op.f64_const(0),e.op.end]),R=[...P].map((y,F)=>{const D=F+p.length+X.length;return[...e.encodeString(y.exportName),e.EXPORT_TYPE.FUNC,...e.unsignedLEB128(D)]}),S=[...X,...P].map(y=>{var F;const D=((F=y.localVariables)!==null&&F!==void 0?F:[]).map(z=>[...e.unsignedLEB128(1),z]);return e.encodeFlatVector([...e.encodeNestedVector(D),...y.binary,e.op.end])});return new Uint8Array([...e.MAGIC,...e.WASM_VERSION,...e.encodeSection(e.SECTION.TYPE,C),...e.encodeSection(e.SECTION.IMPORT,_),...e.encodeSection(e.SECTION.FUNC,T),...e.encodeSection(e.SECTION.MEMORY,x),...e.encodeSection(e.SECTION.GLOBAL,U),...e.encodeSection(e.SECTION.EXPORT,R),...e.encodeSection(e.SECTION.CODE,S)])}E.compileModule=n},"./node_modules/eel-wasm/dist/src/constants.js":function(j,E,m){Object.defineProperty(E,"__esModule",{value:!0});const l=65536,g=8,A=2;E.MAX_LOOP_COUNT=1048576,E.BUFFER_SIZE=65536*128,E.WASM_MEMORY_SIZE=Math.ceil(E.BUFFER_SIZE*g*A/l)},"./node_modules/eel-wasm/dist/src/emitter.js":function(j,E,m){var l=this&&this.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(E,"__esModule",{value:!0});const g=m("./node_modules/eel-wasm/dist/src/encoding.js"),A=l(m("./node_modules/eel-wasm/dist/src/shims.js")),t=m("./node_modules/eel-wasm/dist/src/errorUtils.js"),e=m("./node_modules/eel-wasm/dist/src/wasmFunctions.js"),s=m("./node_modules/eel-wasm/dist/src/utils.js"),i=m("./node_modules/eel-wasm/dist/src/constants.js");function a(f,o){var p,d,P;switch(f.type){case"SCRIPT":{const M=f.body.map((C,w)=>[...a(C,o),g.op.drop]);return s.flatten(M)}case"EXPRESSION_BLOCK":return h(f.body,o);case"BINARY_EXPRESSION":{const M=a(f.left,o),C=a(f.right,o),b={"+":[g.op.f64_add],"-":[g.op.f64_sub],"*":[g.op.f64_mul],"/":o.resolveFunc("div"),"%":o.resolveFunc("mod"),"|":o.resolveFunc("bitwiseOr"),"&":o.resolveFunc("bitwiseAnd"),"^":o.resolveFunc("pow"),"==":[g.op.f64_sub,...g.IS_ZEROISH,g.op.f64_convert_i32_s],"!=":[g.op.f64_sub,...g.IS_NOT_ZEROISH,g.op.f64_convert_i32_s],"<":[g.op.f64_lt,g.op.f64_convert_i32_s],">":[g.op.f64_gt,g.op.f64_convert_i32_s],"<=":[g.op.f64_le,g.op.f64_convert_i32_s],">=":[g.op.f64_ge,g.op.f64_convert_i32_s]}[f.operator];if(b==null)throw t.createCompilerError(`Unknown binary expression operator ${f.operator}`,f.loc,o.rawSource);return[...M,...C,...b]}case"CALL_EXPRESSION":{const M=f.callee.value,C=f.arguments,w=T=>{if(C.length<T)throw t.createUserError(`Too few arguments passed to \`${M}()\`. Expected ${T} but only got ${C.length}.`,f.loc,o.rawSource);if(C.length>T)throw t.createUserError(`Too many arguments passed to \`${M}()\`. Expected ${T} but got ${C.length}.`,C[T].loc,o.rawSource)};switch(M){case"exec2":return w(2),h(f.arguments,o);case"exec3":return w(3),h(f.arguments,o);case"if":w(3);const[T,x,I]=f.arguments;return u(T,x,I,o);case"while":return w(1),n(f.arguments[0],o);case"loop":return w(2),r(f.arguments[0],f.arguments[1],o);case"megabuf":case"gmegabuf":w(1);const U=o.resolveLocal(g.VAL_TYPE.i32);return[...a(f.arguments[0],o),...(p=o.resolveFunc("_getBufferIndex"))!==null&&p!==void 0?p:[],...g.op.local_tee(U),...g.op.i32_const(-1),g.op.i32_ne,...g.op.if(g.BLOCK.f64),...g.op.local_get(U),...g.op.f64_load(3,v(M)),g.op.else,...g.op.f64_const(0),g.op.end];case"assign":w(2);const R=f.arguments[0];if(R.type!="IDENTIFIER")throw t.createUserError("Expected the first argument of `assign()` to be an identifier.",R.loc,o.rawSource);const S=o.resolveVar(R.value);return[...a(f.arguments[1],o),...g.op.global_set(S),...g.op.global_get(S)]}const b=s.flatten(f.arguments.map(T=>a(T,o)));switch(M){case"abs":return w(1),[...b,g.op.f64_abs];case"sqrt":return w(1),[...b,g.op.f64_abs,g.op.f64_sqrt];case"int":return w(1),[...b,g.op.f64_floor];case"min":return w(2),[...b,g.op.f64_min];case"max":return w(2),[...b,g.op.f64_max];case"above":return w(2),[...b,g.op.f64_gt,g.op.f64_convert_i32_s];case"below":return w(2),[...b,g.op.f64_lt,g.op.f64_convert_i32_s];case"equal":return w(2),[...b,g.op.f64_sub,...g.IS_ZEROISH,g.op.f64_convert_i32_s];case"bnot":return w(1),[...b,...g.IS_ZEROISH,g.op.f64_convert_i32_s];case"floor":return w(1),[...b,g.op.f64_floor];case"ceil":return w(1),[...b,g.op.f64_ceil]}const _=o.resolveFunc(M);if(_==null||M.startsWith("_"))throw t.createUserError(`"${M}" is not defined.`,f.callee.loc,o.rawSource);if(A.default[M]!=null)w(A.default[M].length);else if(e.localFuncMap[M]!=null)w(e.localFuncMap[M].args.length);else throw t.createCompilerError(`Missing arity information for the function \`${M}()\``,f.callee.loc,o.rawSource);return[...b,..._]}case"ASSIGNMENT_EXPRESSION":{const{left:M}=f,C=a(f.right,o),w=c(f,o);if(M.type==="IDENTIFIER"){const S=o.resolveVar(M.value),y=g.op.global_get(S),F=g.op.global_set(S);return w===null?[...C,...F,...y]:[...y,...C,...w,...F,...y]}if(M.type!=="CALL_EXPRESSION")throw t.createCompilerError(`Unexpected left hand side type for assignment: ${M.type}`,f.loc,o.rawSource);const b=o.resolveLocal(g.VAL_TYPE.i32);if(M.arguments.length!==1)throw t.createUserError(`Expected 1 argument when assinging to a buffer but got ${M.arguments.length}.`,M.arguments.length===0?M.loc:M.arguments[1].loc,o.rawSource);const _=M.callee.value;if(_!=="gmegabuf"&&_!=="megabuf")throw t.createUserError("The only function calls which may be assigned to are `gmegabuf()` and `megabuf()`.",M.callee.loc,o.rawSource);const T=v(_);if(w===null){const S=o.resolveLocal(g.VAL_TYPE.i32),y=o.resolveLocal(g.VAL_TYPE.f64);return[...C,...g.op.local_set(y),...a(M.arguments[0],o),...(d=o.resolveFunc("_getBufferIndex"))!==null&&d!==void 0?d:[],...g.op.local_tee(S),...g.op.i32_const(0),g.op.i32_lt_s,...g.op.if(g.BLOCK.f64),...g.op.f64_const(0),g.op.else,...g.op.local_get(S),...g.op.local_tee(b),...g.op.local_get(y),...g.op.f64_store(3,T),...g.op.local_get(y),g.op.end]}const x=o.resolveLocal(g.VAL_TYPE.i32),I=o.resolveLocal(g.VAL_TYPE.i32),U=o.resolveLocal(g.VAL_TYPE.f64),R=o.resolveLocal(g.VAL_TYPE.f64);return[...C,...g.op.local_set(U),...a(M.arguments[0],o),...(P=o.resolveFunc("_getBufferIndex"))!==null&&P!==void 0?P:[],...g.op.local_tee(x),...g.op.i32_const(-1),g.op.i32_ne,...g.op.local_tee(I),...g.op.if(g.BLOCK.f64),...g.op.local_get(x),...g.op.f64_load(3,T),g.op.else,...g.op.f64_const(0),g.op.end,...g.op.local_get(U),...w,...g.op.local_tee(R),...g.op.local_get(I),...g.op.if(g.BLOCK.void),...g.op.local_get(x),...g.op.local_get(R),...g.op.f64_store(3,T),g.op.end]}case"LOGICAL_EXPRESSION":{const M=a(f.left,o),C=a(f.right,o),b={"&&":{comparison:g.IS_ZEROISH,shortCircutValue:0},"||":{comparison:g.IS_NOT_ZEROISH,shortCircutValue:1}}[f.operator];if(b==null)throw t.createCompilerError(`Unknown logical expression operator ${f.operator}`,f.loc,o.rawSource);const{comparison:_,shortCircutValue:T}=b;return[...M,..._,...g.op.if(g.BLOCK.f64),...g.op.f64_const(T),g.op.else,...C,...g.IS_NOT_ZEROISH,g.op.f64_convert_i32_s,g.op.end]}case"UNARY_EXPRESSION":{const M=a(f.value,o),w={"-":[g.op.f64_neg],"+":[],"!":[...g.IS_ZEROISH,g.op.f64_convert_i32_s]}[f.operator];if(w==null)throw t.createCompilerError(`Unknown logical unary operator ${f.operator}`,f.loc,o.rawSource);return[...M,...w]}case"IDENTIFIER":const X=f.value;return g.op.global_get(o.resolveVar(X));case"NUMBER_LITERAL":return g.op.f64_const(f.value);default:throw t.createCompilerError(`Unknown AST node type ${f.type}`,f.loc,o.rawSource)}}E.emit=a;function h(f,o){const p=f.map((d,P)=>a(d,o));return s.flatten(s.arrayJoin(p,[g.op.drop]))}function n(f,o){const p=a(f,o),d=o.resolveLocal(g.VAL_TYPE.i32);return[...g.op.i32_const(0),...g.op.local_set(d),...g.op.loop(g.BLOCK.void),...g.op.local_get(d),...g.op.i32_const(1),g.op.i32_add,...g.op.local_tee(d),...g.op.i32_const(i.MAX_LOOP_COUNT),g.op.i32_lt_u,...p,...g.IS_NOT_ZEROISH,g.op.i32_and,...g.op.br_if(0),g.op.end,...g.op.f64_const(0)]}function r(f,o,p){const d=a(o,p),P=p.resolveLocal(g.VAL_TYPE.i32);return[...g.op.block(g.BLOCK.void),...a(f,p),g.op.i32_trunc_f64_s,...g.op.local_tee(P),...g.op.i32_const(0),g.op.i32_le_s,...g.op.br_if(1),...g.op.loop(g.BLOCK.void),...d,g.op.drop,...g.op.local_get(P),...g.op.i32_const(1),g.op.i32_sub,...g.op.local_tee(P),...g.op.i32_const(0),g.op.i32_ne,...g.op.br_if(0),g.op.end,g.op.end,...g.op.f64_const(0)]}function u(f,o,p,d){return[...a(f,d),...g.IS_NOT_ZEROISH,...g.op.if(g.BLOCK.f64),...a(o,d),g.op.else,...a(p,d),g.op.end]}function v(f){switch(f){case"gmegabuf":return i.BUFFER_SIZE*8;case"megabuf":return 0}}function c(f,o){const d={"+=":[g.op.f64_add],"-=":[g.op.f64_sub],"*=":[g.op.f64_mul],"/=":[g.op.f64_div],"%=":o.resolveFunc("mod"),"=":null}[f.operator];if(d===void 0)throw t.createCompilerError(`Unknown assignment operator "${f.operator}"`,f.loc,o.rawSource);return d}},"./node_modules/eel-wasm/dist/src/encoding.js":function(j,E,m){var l=this&&this.__importStar||function(a){if(a&&a.__esModule)return a;var h={};if(a!=null)for(var n in a)Object.hasOwnProperty.call(a,n)&&(h[n]=a[n]);return h.default=a,h};Object.defineProperty(E,"__esModule",{value:!0});const g=l(m("./node_modules/eel-wasm/dist/src/ieee754.js")),A=m("./node_modules/eel-wasm/dist/src/utils.js");E.MAGIC=[0,97,115,109],E.WASM_VERSION=[1,0,0,0],E.EPSILON=1e-5,E.SECTION={TYPE:1,IMPORT:2,FUNC:3,MEMORY:5,GLOBAL:6,EXPORT:7,CODE:10},E.EXPORT_TYPE={FUNC:0,TABLE:1,MEMORY:2,GLOBAL:3},E.op={block:a=>[2,a],loop:a=>[3,a],if:a=>[4,a],else:5,end:11,br_if:a=>[13,...e(a)],call:a=>[16,...e(a)],drop:26,select:27,local_get:a=>[32,...e(a)],local_set:a=>[33,...e(a)],local_tee:a=>[34,...e(a)],global_get:a=>[35,...e(a)],global_set:a=>[36,...e(a)],f64_load:(a,h)=>[43,...e(a),...e(h)],f64_store:(a,h)=>[57,...e(a),...e(h)],i32_const:a=>[65,...s(a)],f64_const:a=>[68,...t(a)],i32_eqz:69,i32_ne:71,i32_lt_s:72,i32_lt_u:73,i32_gt_s:74,i32_le_s:76,i32_le_u:77,i32_ge_s:78,f64_eq:97,f64_ne:98,f64_lt:99,f64_gt:100,f64_le:101,f64_ge:102,i32_add:106,i32_sub:107,i32_mul:108,i32_rem_s:111,i32_and:113,i32_or:114,i64_rem_s:129,i64_and:131,i64_or:132,f64_abs:153,f64_neg:154,f64_ceil:155,f64_floor:156,f64_sqrt:159,f64_add:160,f64_sub:161,f64_mul:162,f64_div:163,f64_min:164,f64_max:165,i32_trunc_f64_s:170,i32_trunc_f64_u:171,i64_trunc_s_f64:176,f64_convert_i64_s:185,f64_convert_i32_s:183},E.VAL_TYPE={i32:127,i64:126,f32:125,f64:124},E.MUTABILITY={const:0,var:1},E.BLOCK={void:64,i32:127,i64:126,f32:125,f64:124},E.FUNCTION_TYPE=96,E.MEMORY_IDX=2,E.GLOBAL_TYPE=3,E.TYPE_IDX=0,E.IS_ZEROISH=[E.op.f64_abs,...E.op.f64_const(E.EPSILON),E.op.f64_lt],E.IS_NOT_ZEROISH=[E.op.f64_abs,...E.op.f64_const(E.EPSILON),E.op.f64_gt];function t(a){const h=new Uint8Array(8);return g.write(h,a),h}E.encodef64=t,E.encodeString=a=>[a.length].concat(a.split("").map(h=>h.charCodeAt(0)));function e(a){const h=[];do{let n=a&127;a>>>=7,a!==0&&(n|=128),h.push(n)}while(a!==0);return h}E.unsignedLEB128=e;function s(a){let h=[],n=0,r=Math.ceil(Math.log2(Math.abs(a))),u=a<0,v=!0;for(;v;)n=a&127,a=a>>7,u&&(a=a|-(1<<r-7)),a==0&&(n&64)==0||a==-1&&(n&64)==64?v=!1:n=n|128,h.push(n);return h}E.signedLEB128=s,E.encodeFlatVector=a=>e(a.length).concat(a),E.encodeNestedVector=a=>e(a.length).concat(A.flatten(a));function i(a,h){if(h.length===0)return[];const n=E.encodeFlatVector(E.encodeNestedVector(h));return n.unshift(a),n}E.encodeSection=i},"./node_modules/eel-wasm/dist/src/envParser.js":function(j,E,m){let l=m("./node_modules/eel-wasm/dist/build/parser.js");j.exports={parse:l.parse}},"./node_modules/eel-wasm/dist/src/errorUtils.js":function(j,E,m){Object.defineProperty(E,"__esModule",{value:!0});const l=m("./node_modules/eel-wasm/dist/src/utils.js");function g(i,a,h=1){const n=Math.max(i.first_line-1-h,0),r=i.last_line+h,v=a.split(`
`).slice(n,r).map((c,f)=>{const o=f+n+1;return`${o>=i.first_line&&o<=i.last_line?">":" "} ${o} | ${c}`});if(i.first_line===i.last_line){const c=l.repeat(i.first_column," "),f=l.repeat(i.last_column-i.first_column,"^"),o=i.first_line-n;v.splice(o,0,`    | ${c}${f}`)}return v.join(`
`)}E.printLoc=g;class A extends Error{constructor(a,h,n){super(a),this.sourceContext=g(h,n),this.loc=h}}class t extends A{}function e(i,a,h){return new t(i,a,h)}E.createUserError=e;function s(i,a,h){return new A(i,a,h)}E.createCompilerError=s},"./node_modules/eel-wasm/dist/src/ieee754.js":function(j,E,m){Object.defineProperty(E,"__esModule",{value:!0});function l(g,A){let e=52;const s=8;var i,a,h,n=s*8-e-1,r=(1<<n)-1,u=r>>1,v=e===23?Math.pow(2,-24)-Math.pow(2,-77):0,c=0,f=1,o=A<0||A===0&&1/A<0?1:0;for(A=Math.abs(A),isNaN(A)||A===1/0?(a=isNaN(A)?1:0,i=r):(i=Math.floor(Math.log(A)/Math.LN2),A*(h=Math.pow(2,-i))<1&&(i--,h*=2),i+u>=1?A+=v/h:A+=v*Math.pow(2,1-u),A*h>=2&&(i++,h/=2),i+u>=r?(a=0,i=r):i+u>=1?(a=(A*h-1)*Math.pow(2,e),i=i+u):(a=A*Math.pow(2,u-1)*Math.pow(2,e),i=0));e>=8;g[0+c]=a&255,c+=f,a/=256,e-=8);for(i=i<<e|a,n+=e;n>0;g[0+c]=i&255,c+=f,i/=256,n-=8);g[0+c-f]|=o*128}E.write=l},"./node_modules/eel-wasm/dist/src/index.js":function(j,E,m){var l=this&&this.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(E,"__esModule",{value:!0});const g=m("./node_modules/eel-wasm/dist/src/parser.js");E.parse=g.parse;const A=m("./node_modules/eel-wasm/dist/src/compiler.js");E.compileModule=A.compileModule;const t=l(m("./node_modules/eel-wasm/dist/src/shims.js"));E.shims=t.default;const e=m("./node_modules/eel-wasm/dist/src/loader.js");E.loadModule=e.loadModule},"./node_modules/eel-wasm/dist/src/loader.js":function(j,E,m){var l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(E,"__esModule",{value:!0});const g=l(m("./node_modules/eel-wasm/dist/src/shims.js")),A=m("./node_modules/eel-wasm/dist/src/compiler.js");async function t({pools:e,functions:s,eelVersion:i=2}){let a={};Object.entries(e).forEach(([u,v])=>{a[u]=new Set(Object.keys(v))});const h=A.compileModule({pools:a,functions:s,eelVersion:i}),n=await WebAssembly.compile(h);var r=Object.assign(Object.assign({},e),{shims:g.default});return await WebAssembly.instantiate(n,r)}E.loadModule=t},"./node_modules/eel-wasm/dist/src/parser.js":function(j,E,m){Object.defineProperty(E,"__esModule",{value:!0});const l=m("./node_modules/eel-wasm/dist/src/preProcessor.js"),g=m("./node_modules/eel-wasm/dist/src/envParser.js"),A=m("./node_modules/eel-wasm/dist/src/astUtils.js"),t=m("./node_modules/eel-wasm/dist/src/errorUtils.js");function e(i,a){const h=l.getLoc(a,i.first_column),n=l.getLoc(a,i.last_column);return{first_column:h.column,last_column:n.column,first_line:h.line,last_line:n.line}}function s(i){const[a,h]=l.preProcess(i);try{const n=g.parse(a);return A.mapAst(n,r=>{if(r.loc.first_line!==1||r.loc.last_line!=1)throw t.createCompilerError("Unexpected multiline",r.loc,i);return Object.assign(Object.assign({},r),{loc:e(r.loc,h)})})}catch(n){throw n.hash==null?n:t.createUserError(`Parse Error: ${n.message.split(`
`)[3]}`,e(n.hash.loc,h),i)}}E.parse=s},"./node_modules/eel-wasm/dist/src/preProcessor.js":function(j,E,m){Object.defineProperty(E,"__esModule",{value:!0});function l(A,t){let e={destCol:1,srcCol:1,srcLine:1};A.forEach(i=>{i.destCol>t||(e=i)});const s=t-e.destCol;return{column:e.srcCol+s,line:e.srcLine}}E.getLoc=l;function g(A){const t=[];let e=1,s="",i=0,a=!1,h=!1,n=!1;for(let r=0;r<A.length;r++){const u=A[r];if(n){const v=s.length+1,c=r-i+1;t.push({destCol:v,srcCol:c,srcLine:e}),n=!1}u===`
`?(a=!1,e++,i=r+1,n=!0):u==="\r"&&A[r+1]===`
`?(r++,a=!1,e++,i=r+1,n=!0):h&&u==="*"&&A[r+1]==="/"?(h=!1,r++,n=!0):u==="\\"&&A[r+1]==="\\"||u==="/"&&A[r+1]==="/"?(a=!0,r++):u==="/"&&A[r+1]==="*"?(h=!0,r++):!a&&!h&&(s+=u)}return[s,t]}E.preProcess=g},"./node_modules/eel-wasm/dist/src/shims.js":function(j,E,m){Object.defineProperty(E,"__esModule",{value:!0});const l=1e-5,g={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,atan2:Math.atan2,rand:A=>Math.random()*A,pow:Math.pow,log:Math.log,log10:Math.log10,exp:Math.exp,sigmoid:function(A,t){const e=1+Math.exp(-A*t);return Math.abs(e)>l?1/e:0}};E.default=g},"./node_modules/eel-wasm/dist/src/utils.js":function(j,E,m){Object.defineProperty(E,"__esModule",{value:!0});function l(i,a){const h=[];for(let n=0;n<i.length;n++)h.push(i[n]),n===i.length-1||h.push(a);return h}E.arrayJoin=l;function g(i){return[].concat.apply([],i)}E.flatten=g;function A(i,a){return new Array(i).fill(null).map((h,n)=>a(n))}E.times=A;function t(i,a){return new Array(i).fill(a).join("")}E.repeat=t;class e{constructor(){this._map=new Map}get(a,h){const n=a==null?h:`${a}::${h}`;return this._map.has(n)||this._map.set(n,this._map.size),this._map.get(n)}size(){return this._map.size}}E.ScopedIdMap=e;function s(i){if(i.length===0)throw new Error("Cannot format an empty list");if(i.length===1)return i[0];const a=i.map(n=>`"${n}"`),h=a.pop();return a.join(", ")+` and ${h}`}E.formatList=s},"./node_modules/eel-wasm/dist/src/wasmFunctions.js":function(j,E,m){Object.defineProperty(E,"__esModule",{value:!0});const l=m("./node_modules/eel-wasm/dist/src/encoding.js"),g=m("./node_modules/eel-wasm/dist/src/constants.js");E.localFuncMap={sqr:{args:[l.VAL_TYPE.f64],returns:[l.VAL_TYPE.f64],binary:[...l.op.local_get(0),...l.op.local_get(0),l.op.f64_mul]},bor:{args:[l.VAL_TYPE.f64,l.VAL_TYPE.f64],returns:[l.VAL_TYPE.f64],binary:[...l.op.local_get(0),...l.IS_NOT_ZEROISH,...l.op.local_get(1),...l.IS_NOT_ZEROISH,l.op.i32_or,...l.op.i32_const(0),l.op.i32_ne,l.op.f64_convert_i32_s]},band:{args:[l.VAL_TYPE.f64,l.VAL_TYPE.f64],returns:[l.VAL_TYPE.f64],binary:[...l.op.local_get(0),...l.IS_NOT_ZEROISH,...l.op.local_get(1),...l.IS_NOT_ZEROISH,l.op.i32_and,...l.op.i32_const(0),l.op.i32_ne,l.op.f64_convert_i32_s]},sign:{args:[l.VAL_TYPE.f64],returns:[l.VAL_TYPE.f64],binary:[...l.op.f64_const(0),...l.op.local_get(0),l.op.f64_lt,...l.op.local_get(0),...l.op.f64_const(0),l.op.f64_lt,l.op.i32_sub,l.op.f64_convert_i32_s]},mod:{args:[l.VAL_TYPE.f64,l.VAL_TYPE.f64],returns:[l.VAL_TYPE.f64],localVariables:[l.VAL_TYPE.i32],binary:[...l.op.local_get(1),l.op.i32_trunc_f64_s,...l.op.local_tee(2),...l.op.i32_const(0),l.op.i32_ne,...l.op.if(l.BLOCK.f64),...l.op.local_get(0),l.op.i32_trunc_f64_s,...l.op.local_get(2),l.op.i32_rem_s,l.op.f64_convert_i32_s,l.op.else,...l.op.f64_const(0),l.op.end]},bitwiseOr:{args:[l.VAL_TYPE.f64,l.VAL_TYPE.f64],returns:[l.VAL_TYPE.f64],binary:[...l.op.local_get(0),l.op.i64_trunc_s_f64,...l.op.local_get(1),l.op.i64_trunc_s_f64,l.op.i64_or,l.op.f64_convert_i64_s]},bitwiseAnd:{args:[l.VAL_TYPE.f64,l.VAL_TYPE.f64],returns:[l.VAL_TYPE.f64],binary:[...l.op.local_get(0),l.op.i64_trunc_s_f64,...l.op.local_get(1),l.op.i64_trunc_s_f64,l.op.i64_and,l.op.f64_convert_i64_s]},div:{args:[l.VAL_TYPE.f64,l.VAL_TYPE.f64],returns:[l.VAL_TYPE.f64],localVariables:[l.VAL_TYPE.i32],binary:[...l.op.local_get(1),...l.op.f64_const(0),l.op.f64_ne,...l.op.if(l.BLOCK.f64),...l.op.local_get(0),...l.op.local_get(1),l.op.f64_div,l.op.else,...l.op.f64_const(0),l.op.end]},_getBufferIndex:{args:[l.VAL_TYPE.f64],returns:[l.VAL_TYPE.i32],localVariables:[l.VAL_TYPE.f64,l.VAL_TYPE.i32],binary:[...l.op.f64_const(l.EPSILON),...l.op.local_get(0),l.op.f64_add,...l.op.local_tee(1),l.op.i32_trunc_f64_s,...l.op.local_set(2),...l.op.i32_const(-1),...l.op.local_get(2),...l.op.i32_const(8),l.op.i32_mul,...l.op.local_get(2),...l.op.i32_const(0),l.op.i32_lt_s,...l.op.local_get(2),...l.op.i32_const(g.BUFFER_SIZE-1),l.op.i32_gt_s,l.op.i32_or,l.op.select]}}},"./node_modules/process/browser.js":function(j,E){var m=j.exports={},l,g;function A(){throw new Error("setTimeout has not been defined")}function t(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?l=setTimeout:l=A}catch{l=A}try{typeof clearTimeout=="function"?g=clearTimeout:g=t}catch{g=t}})();function e(f){if(l===setTimeout)return setTimeout(f,0);if((l===A||!l)&&setTimeout)return l=setTimeout,setTimeout(f,0);try{return l(f,0)}catch{try{return l.call(null,f,0)}catch{return l.call(this,f,0)}}}function s(f){if(g===clearTimeout)return clearTimeout(f);if((g===t||!g)&&clearTimeout)return g=clearTimeout,clearTimeout(f);try{return g(f)}catch{try{return g.call(null,f)}catch{return g.call(this,f)}}}var i=[],a=!1,h,n=-1;function r(){!a||!h||(a=!1,h.length?i=h.concat(i):n=-1,i.length&&u())}function u(){if(!a){var f=e(r);a=!0;for(var o=i.length;o;){for(h=i,i=[];++n<o;)h&&h[n].run();n=-1,o=i.length}h=null,a=!1,s(f)}}m.nextTick=function(f){var o=new Array(arguments.length-1);if(arguments.length>1)for(var p=1;p<arguments.length;p++)o[p-1]=arguments[p];i.push(new v(f,o)),i.length===1&&!a&&e(u)};function v(f,o){this.fun=f,this.array=o}v.prototype.run=function(){this.fun.apply(null,this.array)},m.title="browser",m.browser=!0,m.env={},m.argv=[],m.version="",m.versions={};function c(){}m.on=c,m.addListener=c,m.once=c,m.off=c,m.removeListener=c,m.removeAllListeners=c,m.emit=c,m.prependListener=c,m.prependOnceListener=c,m.listeners=function(f){return[]},m.binding=function(f){throw new Error("process.binding is not supported")},m.cwd=function(){return"/"},m.chdir=function(f){throw new Error("process.chdir is not supported")},m.umask=function(){return 0}},"./node_modules/webpack/buildin/module.js":function(j,E){j.exports=function(m){return m.webpackPolyfill||(m.deprecate=function(){},m.paths=[],m.children||(m.children=[]),Object.defineProperty(m,"loaded",{enumerable:!0,get:function(){return m.l}}),Object.defineProperty(m,"id",{enumerable:!0,get:function(){return m.i}}),m.webpackPolyfill=1),m}},"./src/assemblyscript/presetFunctions.ts":function(j,E){var m="AGFzbQEAAAABPQpgAABgAXwBfGACfHwBfGACf38AYAR/f39/AGAJf39/f3x8fHx8AGADf399AGABfwF/YAJ/fwF/YAF+AX8CuBWMAQNlbnYFYWJvcnQABAhwaXhlbEVxcwtwZXJQaXhlbEVxcwAADHBpeGVsVmFyUG9vbAR3YXJwA3wBDHBpeGVsVmFyUG9vbAR6b29tA3wBDHBpeGVsVmFyUG9vbAd6b29tZXhwA3wBDHBpeGVsVmFyUG9vbAJjeAN8AQxwaXhlbFZhclBvb2wCY3kDfAEMcGl4ZWxWYXJQb29sAnN4A3wBDHBpeGVsVmFyUG9vbAJzeQN8AQxwaXhlbFZhclBvb2wCZHgDfAEMcGl4ZWxWYXJQb29sAmR5A3wBDHBpeGVsVmFyUG9vbANyb3QDfAEMcGl4ZWxWYXJQb29sA3JhZAN8AQxwaXhlbFZhclBvb2wDYW5nA3wBDHBpeGVsVmFyUG9vbAF4A3wBDHBpeGVsVmFyUG9vbAF5A3wBCHFWYXJQb29sAnExA3wBCHFWYXJQb29sAnEyA3wBCHFWYXJQb29sAnEzA3wBCHFWYXJQb29sAnE0A3wBCHFWYXJQb29sAnE1A3wBCHFWYXJQb29sAnE2A3wBCHFWYXJQb29sAnE3A3wBCHFWYXJQb29sAnE4A3wBCHFWYXJQb29sAnE5A3wBCHFWYXJQb29sA3ExMAN8AQhxVmFyUG9vbANxMTEDfAEIcVZhclBvb2wDcTEyA3wBCHFWYXJQb29sA3ExMwN8AQhxVmFyUG9vbANxMTQDfAEIcVZhclBvb2wDcTE1A3wBCHFWYXJQb29sA3ExNgN8AQhxVmFyUG9vbANxMTcDfAEIcVZhclBvb2wDcTE4A3wBCHFWYXJQb29sA3ExOQN8AQhxVmFyUG9vbANxMjADfAEIcVZhclBvb2wDcTIxA3wBCHFWYXJQb29sA3EyMgN8AQhxVmFyUG9vbANxMjMDfAEIcVZhclBvb2wDcTI0A3wBCHFWYXJQb29sA3EyNQN8AQhxVmFyUG9vbANxMjYDfAEIcVZhclBvb2wDcTI3A3wBCHFWYXJQb29sA3EyOAN8AQhxVmFyUG9vbANxMjkDfAEIcVZhclBvb2wDcTMwA3wBCHFWYXJQb29sA3EzMQN8AQhxVmFyUG9vbANxMzIDfAEIdFZhclBvb2wCdDEDfAEIdFZhclBvb2wCdDIDfAEIdFZhclBvb2wCdDMDfAEIdFZhclBvb2wCdDQDfAEIdFZhclBvb2wCdDUDfAEIdFZhclBvb2wCdDYDfAEIdFZhclBvb2wCdDcDfAEIdFZhclBvb2wCdDgDfAEKc2hhcGVQb29sMAN4XzADfAEKc2hhcGVQb29sMAN5XzADfAEKc2hhcGVQb29sMAVyYWRfMAN8AQpzaGFwZVBvb2wwBWFuZ18wA3wBCnNoYXBlUG9vbDADcl8wA3wBCnNoYXBlUG9vbDADZ18wA3wBCnNoYXBlUG9vbDADYl8wA3wBCnNoYXBlUG9vbDADYV8wA3wBCnNoYXBlUG9vbDAEcjJfMAN8AQpzaGFwZVBvb2wwBGcyXzADfAEKc2hhcGVQb29sMARiMl8wA3wBCnNoYXBlUG9vbDAEYTJfMAN8AQpzaGFwZVBvb2wwCmJvcmRlcl9yXzADfAEKc2hhcGVQb29sMApib3JkZXJfZ18wA3wBCnNoYXBlUG9vbDAKYm9yZGVyX2JfMAN8AQpzaGFwZVBvb2wwCmJvcmRlcl9hXzADfAEKc2hhcGVQb29sMA50aGlja291dGxpbmVfMAN8AQpzaGFwZVBvb2wwCnRleHR1cmVkXzADfAEKc2hhcGVQb29sMAp0ZXhfem9vbV8wA3wBCnNoYXBlUG9vbDAJdGV4X2FuZ18wA3wBCnNoYXBlUG9vbDAKYWRkaXRpdmVfMAN8AQpzaGFwZVBvb2wxA3hfMQN8AQpzaGFwZVBvb2wxA3lfMQN8AQpzaGFwZVBvb2wxBXJhZF8xA3wBCnNoYXBlUG9vbDEFYW5nXzEDfAEKc2hhcGVQb29sMQNyXzEDfAEKc2hhcGVQb29sMQNnXzEDfAEKc2hhcGVQb29sMQNiXzEDfAEKc2hhcGVQb29sMQNhXzEDfAEKc2hhcGVQb29sMQRyMl8xA3wBCnNoYXBlUG9vbDEEZzJfMQN8AQpzaGFwZVBvb2wxBGIyXzEDfAEKc2hhcGVQb29sMQRhMl8xA3wBCnNoYXBlUG9vbDEKYm9yZGVyX3JfMQN8AQpzaGFwZVBvb2wxCmJvcmRlcl9nXzEDfAEKc2hhcGVQb29sMQpib3JkZXJfYl8xA3wBCnNoYXBlUG9vbDEKYm9yZGVyX2FfMQN8AQpzaGFwZVBvb2wxDnRoaWNrb3V0bGluZV8xA3wBCnNoYXBlUG9vbDEKdGV4dHVyZWRfMQN8AQpzaGFwZVBvb2wxCnRleF96b29tXzEDfAEKc2hhcGVQb29sMQl0ZXhfYW5nXzEDfAEKc2hhcGVQb29sMQphZGRpdGl2ZV8xA3wBCnNoYXBlUG9vbDIDeF8yA3wBCnNoYXBlUG9vbDIDeV8yA3wBCnNoYXBlUG9vbDIFcmFkXzIDfAEKc2hhcGVQb29sMgVhbmdfMgN8AQpzaGFwZVBvb2wyA3JfMgN8AQpzaGFwZVBvb2wyA2dfMgN8AQpzaGFwZVBvb2wyA2JfMgN8AQpzaGFwZVBvb2wyA2FfMgN8AQpzaGFwZVBvb2wyBHIyXzIDfAEKc2hhcGVQb29sMgRnMl8yA3wBCnNoYXBlUG9vbDIEYjJfMgN8AQpzaGFwZVBvb2wyBGEyXzIDfAEKc2hhcGVQb29sMgpib3JkZXJfcl8yA3wBCnNoYXBlUG9vbDIKYm9yZGVyX2dfMgN8AQpzaGFwZVBvb2wyCmJvcmRlcl9iXzIDfAEKc2hhcGVQb29sMgpib3JkZXJfYV8yA3wBCnNoYXBlUG9vbDIOdGhpY2tvdXRsaW5lXzIDfAEKc2hhcGVQb29sMgp0ZXh0dXJlZF8yA3wBCnNoYXBlUG9vbDIKdGV4X3pvb21fMgN8AQpzaGFwZVBvb2wyCXRleF9hbmdfMgN8AQpzaGFwZVBvb2wyCmFkZGl0aXZlXzIDfAEKc2hhcGVQb29sMwN4XzMDfAEKc2hhcGVQb29sMwN5XzMDfAEKc2hhcGVQb29sMwVyYWRfMwN8AQpzaGFwZVBvb2wzBWFuZ18zA3wBCnNoYXBlUG9vbDMDcl8zA3wBCnNoYXBlUG9vbDMDZ18zA3wBCnNoYXBlUG9vbDMDYl8zA3wBCnNoYXBlUG9vbDMDYV8zA3wBCnNoYXBlUG9vbDMEcjJfMwN8AQpzaGFwZVBvb2wzBGcyXzMDfAEKc2hhcGVQb29sMwRiMl8zA3wBCnNoYXBlUG9vbDMEYTJfMwN8AQpzaGFwZVBvb2wzCmJvcmRlcl9yXzMDfAEKc2hhcGVQb29sMwpib3JkZXJfZ18zA3wBCnNoYXBlUG9vbDMKYm9yZGVyX2JfMwN8AQpzaGFwZVBvb2wzCmJvcmRlcl9hXzMDfAEKc2hhcGVQb29sMw50aGlja291dGxpbmVfMwN8AQpzaGFwZVBvb2wzCnRleHR1cmVkXzMDfAEKc2hhcGVQb29sMwp0ZXhfem9vbV8zA3wBCnNoYXBlUG9vbDMJdGV4X2FuZ18zA3wBCnNoYXBlUG9vbDMKYWRkaXRpdmVfMwN8AQMZGAgDBwkBAQICAQYFAAAAAAAAAAAAAAAAAAUDAQABBuwMigF8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt/AUEAC3wBRAAAAAAAAAAAC3wBRAAAAAAAAAAAC34BQgALB9kB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";j.exports=()=>m},"./src/audio/audioLevels.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return l});class l{constructor(A){this.audio=A;let t;this.audio.audioContext?t=this.audio.audioContext.sampleRate:t=44100;const e=t/this.audio.fftSize,s=Math.clamp(Math.round(20/e)-1,0,this.audio.numSamps-1),i=Math.clamp(Math.round(320/e)-1,0,this.audio.numSamps-1),a=Math.clamp(Math.round(2800/e)-1,0,this.audio.numSamps-1),h=Math.clamp(Math.round(11025/e)-1,0,this.audio.numSamps-1);this.starts=[s,i,a],this.stops=[i,a,h],this.val=new Float32Array(3),this.imm=new Float32Array(3),this.att=new Float32Array(3),this.avg=new Float32Array(3),this.longAvg=new Float32Array(3),this.att.fill(1),this.avg.fill(1),this.longAvg.fill(1)}get bass(){return this.val[0]}get bass_att(){return this.att[0]}get mid(){return this.val[1]}get mid_att(){return this.att[1]}get treb(){return this.val[2]}get treb_att(){return this.att[2]}static isFiniteNumber(A){return Number.isFinite(A)&&!Number.isNaN(A)}static adjustRateToFPS(A,t,e){return A**(t/e)}updateAudioLevels(A,t){if(this.audio.freqArray.length>0){let e=A;!l.isFiniteNumber(e)||e<15?e=15:e>144&&(e=144),this.imm.fill(0);for(let s=0;s<3;s++)for(let i=this.starts[s];i<this.stops[s];i++)this.imm[s]+=this.audio.freqArray[i];for(let s=0;s<3;s++){let i;this.imm[s]>this.avg[s]?i=.2:i=.5,i=l.adjustRateToFPS(i,30,e),this.avg[s]=this.avg[s]*i+this.imm[s]*(1-i),t<50?i=.9:i=.992,i=l.adjustRateToFPS(i,30,e),this.longAvg[s]=this.longAvg[s]*i+this.imm[s]*(1-i),this.longAvg[s]<.001?(this.val[s]=1,this.att[s]=1):(this.val[s]=this.imm[s]/this.longAvg[s],this.att[s]=this.avg[s]/this.longAvg[s])}}}}},"./src/audio/audioProcessor.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return g});var l=m("./src/audio/fft.js");class g{constructor(t){this.numSamps=512,this.fftSize=this.numSamps*2,this.fft=new l.default(this.fftSize,512,!0),t&&(this.audioContext=t,this.audible=t.createDelay(),this.analyser=t.createAnalyser(),this.analyser.smoothingTimeConstant=0,this.analyser.fftSize=this.fftSize,this.audible.connect(this.analyser),this.analyserL=t.createAnalyser(),this.analyserL.smoothingTimeConstant=0,this.analyserL.fftSize=this.fftSize,this.analyserR=t.createAnalyser(),this.analyserR.smoothingTimeConstant=0,this.analyserR.fftSize=this.fftSize,this.splitter=t.createChannelSplitter(2),this.audible.connect(this.splitter),this.splitter.connect(this.analyserL,0),this.splitter.connect(this.analyserR,1)),this.timeByteArray=new Uint8Array(this.fftSize),this.timeByteArrayL=new Uint8Array(this.fftSize),this.timeByteArrayR=new Uint8Array(this.fftSize),this.timeArray=new Int8Array(this.fftSize),this.timeByteArraySignedL=new Int8Array(this.fftSize),this.timeByteArraySignedR=new Int8Array(this.fftSize),this.tempTimeArrayL=new Int8Array(this.fftSize),this.tempTimeArrayR=new Int8Array(this.fftSize),this.timeArrayL=new Int8Array(this.numSamps),this.timeArrayR=new Int8Array(this.numSamps)}sampleAudio(){this.analyser.getByteTimeDomainData(this.timeByteArray),this.analyserL.getByteTimeDomainData(this.timeByteArrayL),this.analyserR.getByteTimeDomainData(this.timeByteArrayR),this.processAudio()}updateAudio(t,e,s){this.timeByteArray.set(t),this.timeByteArrayL.set(e),this.timeByteArrayR.set(s),this.processAudio()}processAudio(){for(let t=0,e=0,s=0;t<this.fftSize;t++)this.timeArray[t]=this.timeByteArray[t]-128,this.timeByteArraySignedL[t]=this.timeByteArrayL[t]-128,this.timeByteArraySignedR[t]=this.timeByteArrayR[t]-128,this.tempTimeArrayL[t]=.5*(this.timeByteArraySignedL[t]+this.timeByteArraySignedL[s]),this.tempTimeArrayR[t]=.5*(this.timeByteArraySignedR[t]+this.timeByteArraySignedR[s]),t%2===0&&(this.timeArrayL[e]=this.tempTimeArrayL[t],this.timeArrayR[e]=this.tempTimeArrayR[t],e+=1),s=t;this.freqArray=this.fft.timeToFrequencyDomain(this.timeArray),this.freqArrayL=this.fft.timeToFrequencyDomain(this.timeByteArraySignedL),this.freqArrayR=this.fft.timeToFrequencyDomain(this.timeByteArraySignedR)}connectAudio(t){t.connect(this.audible)}disconnectAudio(t){t.disconnect(this.audible)}}},"./src/audio/fft.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return l});class l{constructor(A,t,e=!1){this.samplesIn=A,this.samplesOut=t,this.equalize=e,this.NFREQ=t*2,this.equalize&&this.initEqualizeTable(),this.initBitRevTable(),this.initCosSinTable()}initEqualizeTable(){this.equalizeArr=new Float32Array(this.samplesOut);const A=1/this.samplesOut;for(let t=0;t<this.samplesOut;t++)this.equalizeArr[t]=-.02*Math.log((this.samplesOut-t)*A)}initBitRevTable(){this.bitrevtable=new Uint16Array(this.NFREQ);for(let t=0;t<this.NFREQ;t++)this.bitrevtable[t]=t;let A=0;for(let t=0;t<this.NFREQ;t++){if(A>t){const s=this.bitrevtable[t];this.bitrevtable[t]=this.bitrevtable[A],this.bitrevtable[A]=s}let e=this.NFREQ>>1;for(;e>=1&&A>=e;)A-=e,e>>=1;A+=e}}initCosSinTable(){let A=2,t=0;for(;A<=this.NFREQ;)t+=1,A<<=1;this.cossintable=[new Float32Array(t),new Float32Array(t)],A=2;let e=0;for(;A<=this.NFREQ;){const s=-2*Math.PI/A;this.cossintable[0][e]=Math.cos(s),this.cossintable[1][e]=Math.sin(s),e+=1,A<<=1}}timeToFrequencyDomain(A){const t=new Float32Array(this.NFREQ),e=new Float32Array(this.NFREQ);for(let h=0;h<this.NFREQ;h++){const n=this.bitrevtable[h];n<this.samplesIn?t[h]=A[n]:t[h]=0,e[h]=0}let s=2,i=0;for(;s<=this.NFREQ;){const h=this.cossintable[0][i],n=this.cossintable[1][i];let r=1,u=0;const v=s>>1;for(let c=0;c<v;c++){for(let o=c;o<this.NFREQ;o+=s){const p=o+v,d=r*t[p]-u*e[p],P=r*e[p]+u*t[p];t[p]=t[o]-d,e[p]=e[o]-P,t[o]+=d,e[o]+=P}const f=r;r=f*h-u*n,u=u*h+f*n}s<<=1,i+=1}const a=new Float32Array(this.samplesOut);if(this.equalize)for(let h=0;h<this.samplesOut;h++)a[h]=this.equalizeArr[h]*Math.sqrt(t[h]*t[h]+e[h]*e[h]);else for(let h=0;h<this.samplesOut;h++)a[h]=Math.sqrt(t[h]*t[h]+e[h]*e[h]);return a}}},"./src/blankPreset.js":function(j,E,m){var l,g;l=[],g=(function(){"use strict;";var A={baseVals:{gammaadj:1.25,wave_g:.5,mv_x:12,warpscale:1,brighten:0,mv_y:9,wave_scale:1,echo_alpha:0,additivewave:0,sx:1,sy:1,warp:.01,red_blue:0,wave_mode:0,wave_brighten:0,wrap:0,zoomexp:1,fshader:0,wave_r:.5,echo_zoom:1,wave_smoothing:.75,warpanimspeed:1,wave_dots:0,wave_x:.5,wave_y:.5,zoom:1,solarize:0,modwavealphabyvolume:0,dx:0,cx:.5,dy:0,darken_center:0,cy:.5,invert:0,bmotionvectorson:0,rot:0,modwavealphaend:.95,wave_mystery:-.2,decay:.9,wave_a:1,wave_b:.5,rating:5,modwavealphastart:.75,darken:0,echo_orient:0,ib_r:.5,ib_g:.5,ib_b:.5,ib_a:0,ib_size:0,ob_r:.5,ob_g:.5,ob_b:.5,ob_a:0,ob_size:0,mv_dx:0,mv_dy:0,mv_a:0,mv_r:.5,mv_g:.5,mv_b:.5,mv_l:0},init_eqs:function(){var t={};return t},frame_eqs:function(t){return t.rkeys=["warp"],t.zoom=1.01+.02*t.treb_att,t.warp=.15+.25*t.bass_att,t},pixel_eqs:function(t){return t.warp=t.warp+t.rad*.15,t},waves:[{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(t){return t.rkeys=[],t},frame_eqs:function(t){return t},point_eqs:""},{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(t){return t.rkeys=[],t},frame_eqs:function(t){return t},point_eqs:""},{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(t){return t.rkeys=[],t},frame_eqs:function(t){return t},point_eqs:""},{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(t){return t.rkeys=[],t},frame_eqs:function(t){return t},point_eqs:""}],shapes:[{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(t){return t.rkeys=[],t},frame_eqs:function(t){return t}},{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(t){return t.rkeys=[],t},frame_eqs:function(t){return t}},{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(t){return t.rkeys=[],t},frame_eqs:function(t){return t}},{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(t){return t.rkeys=[],t},frame_eqs:function(t){return t}}],warp:`shader_body {
ret = texture2D(sampler_main, uv).rgb;
ret -= 0.004;
}
`,comp:`shader_body {
ret = texture2D(sampler_main, uv).rgb;
ret *= hue_shader;
}
`};return A}).apply(E,l),g!==void 0&&(j.exports=g)},"./src/equations/presetEquationRunner.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return g});var l=m("./src/utils.js");class g{constructor(t,e,s){this.preset=t,this.texsizeX=s.texsizeX,this.texsizeY=s.texsizeY,this.mesh_width=s.mesh_width,this.mesh_height=s.mesh_height,this.aspectx=s.aspectx,this.aspecty=s.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.qs=l.default.range(1,33).map(i=>`q${i}`),this.ts=l.default.range(1,9).map(i=>`t${i}`),this.regs=l.default.range(100).map(i=>i<10?`reg0${i}`:`reg${i}`),this.initializeEquations(e)}initializeEquations(t){this.runVertEQs=this.preset.pixel_eqs!=="",this.mdVSQInit=null,this.mdVSRegs=null,this.mdVSFrame=null,this.mdVSUserKeys=null,this.mdVSFrameMap=null,this.mdVSShapes=null,this.mdVSUserKeysShapes=null,this.mdVSFrameMapShapes=null,this.mdVSWaves=null,this.mdVSUserKeysWaves=null,this.mdVSFrameMapWaves=null,this.mdVSQAfterFrame=null,this.gmegabuf=new Array(1048576).fill(0);const e={frame:t.frame,time:t.time,fps:t.fps,bass:t.bass,bass_att:t.bass_att,mid:t.mid,mid_att:t.mid_att,treb:t.treb,treb_att:t.treb_att,meshx:this.mesh_width,meshy:this.mesh_height,aspectx:this.invAspectx,aspecty:this.invAspecty,pixelsx:this.texsizeX,pixelsy:this.texsizeY,gmegabuf:this.gmegabuf};this.mdVS=Object.assign({},this.preset.baseVals,e),this.mdVS.megabuf=new Array(1048576).fill(0),this.mdVS.rand_start=new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()]),this.mdVS.rand_preset=new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()]);const s=this.qs.concat(this.regs,Object.keys(this.mdVS)),i=this.preset.init_eqs(l.default.cloneVars(this.mdVS));this.mdVSQInit=l.default.pick(i,this.qs),this.mdVSRegs=l.default.pick(i,this.regs);const a=l.default.pick(i,Object.keys(l.default.omit(i,s)));if(a.megabuf=i.megabuf,a.gmegabuf=i.gmegabuf,this.mdVSFrame=this.preset.frame_eqs(Object.assign({},this.mdVS,this.mdVSQInit,this.mdVSRegs,a)),this.mdVSUserKeys=Object.keys(l.default.omit(this.mdVSFrame,s)),this.mdVSFrameMap=l.default.pick(this.mdVSFrame,this.mdVSUserKeys),this.mdVSQAfterFrame=l.default.pick(this.mdVSFrame,this.qs),this.mdVSRegs=l.default.pick(this.mdVSFrame,this.regs),this.mdVSWaves=[],this.mdVSTWaveInits=[],this.mdVSUserKeysWaves=[],this.mdVSFrameMapWaves=[],this.preset.waves&&this.preset.waves.length>0)for(let h=0;h<this.preset.waves.length;h++){const n=this.preset.waves[h],r=n.baseVals;if(r.enabled!==0){let u=Object.assign({},r,e);const v=this.qs.concat(this.ts,this.regs,Object.keys(u));Object.assign(u,this.mdVSQAfterFrame,this.mdVSRegs),u.megabuf=new Array(1048576).fill(0),n.init_eqs&&(u=n.init_eqs(u),this.mdVSRegs=l.default.pick(u,this.regs),Object.assign(u,r)),this.mdVSWaves.push(u),this.mdVSTWaveInits.push(l.default.pick(u,this.ts)),this.mdVSUserKeysWaves.push(Object.keys(l.default.omit(u,v))),this.mdVSFrameMapWaves.push(l.default.pick(u,this.mdVSUserKeysWaves[h]))}else this.mdVSWaves.push({}),this.mdVSTWaveInits.push({}),this.mdVSUserKeysWaves.push([]),this.mdVSFrameMapWaves.push({})}if(this.mdVSShapes=[],this.mdVSTShapeInits=[],this.mdVSUserKeysShapes=[],this.mdVSFrameMapShapes=[],this.preset.shapes&&this.preset.shapes.length>0)for(let h=0;h<this.preset.shapes.length;h++){const n=this.preset.shapes[h],r=n.baseVals;if(r.enabled!==0){let u=Object.assign({},r,e);const v=this.qs.concat(this.ts,this.regs,Object.keys(u));Object.assign(u,this.mdVSQAfterFrame,this.mdVSRegs),u.megabuf=new Array(1048576).fill(0),n.init_eqs&&(u=n.init_eqs(u),this.mdVSRegs=l.default.pick(u,this.regs),Object.assign(u,r)),this.mdVSShapes.push(u),this.mdVSTShapeInits.push(l.default.pick(u,this.ts)),this.mdVSUserKeysShapes.push(Object.keys(l.default.omit(u,v))),this.mdVSFrameMapShapes.push(l.default.pick(u,this.mdVSUserKeysShapes[h]))}else this.mdVSShapes.push({}),this.mdVSTShapeInits.push({}),this.mdVSUserKeysShapes.push([]),this.mdVSFrameMapShapes.push({})}}updatePreset(t,e){this.preset=t,this.initializeEquations(e)}updateGlobals(t){this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.mesh_width=t.mesh_width,this.mesh_height=t.mesh_height,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}runFrameEquations(t){return this.mdVSFrame=Object.assign({},this.mdVS,this.mdVSQInit,this.mdVSFrameMap,t),this.mdVSFrame=this.preset.frame_eqs(this.mdVSFrame),this.mdVSFrameMap=l.default.pick(this.mdVSFrame,this.mdVSUserKeys),this.mdVSQAfterFrame=l.default.pick(this.mdVSFrame,this.qs),this.mdVSFrame}runPixelEquations(t){return this.preset.pixel_eqs(t)}runShapeFrameEquations(t,e){return this.preset.shapes[t].frame_eqs(e)}runWaveFrameEquations(t,e){return this.preset.waves[t].frame_eqs(e)}runWavePointEquations(t,e){return this.preset.waves[t].point_eqs(e)}}},"./src/equations/presetEquationRunnerWASM.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return g});var l=m("./src/utils.js");class g{constructor(t,e,s){this.preset=t,this.texsizeX=s.texsizeX,this.texsizeY=s.texsizeY,this.mesh_width=s.mesh_width,this.mesh_height=s.mesh_height,this.aspectx=s.aspectx,this.aspecty=s.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.qs=l.default.range(1,33).map(i=>`q${i}`),this.ts=l.default.range(1,9).map(i=>`t${i}`),this.regs=l.default.range(100).map(i=>i<10?`reg0${i}`:`reg${i}`),this.globalKeys=["frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy"],this.frameKeys=["decay","wave_a","wave_r","wave_g","wave_b","wave_x","wave_y","wave_scale","wave_smoothing","wave_mode","old_wave_mode","wave_mystery","ob_size","ob_r","ob_g","ob_b","ob_a","ib_size","ib_r","ib_g","ib_b","ib_a","mv_x","mv_y","mv_dx","mv_dy","mv_l","mv_r","mv_g","mv_b","mv_a","echo_zoom","echo_alpha","echo_orient","wave_dots","wave_thick","additivewave","wave_brighten","modwavealphabyvolume","modwavealphastart","modwavealphaend","darken_center","gammaadj","warp","warpanimspeed","warpscale","zoom","zoomexp","rot","cx","cy","dx","dy","sx","sy","fshader","wrap","invert","brighten","darken","solarize","bmotionvectorson","b1n","b2n","b3n","b1x","b2x","b3x","b1ed"],this.waveFrameKeys=["samples","sep","scaling","spectrum","smoothing","r","g","b","a"],this.waveFrameInputKeys=["samples","r","g","b","a"],this.initializeEquations(e)}getQVars(t){return l.default.pickWasm(this.preset.globalPools[t],this.qs)}getTVars(t){return l.default.pickWasm(this.preset.globalPools[t],this.ts)}initializeEquations(t){this.runVertEQs=!!this.preset.pixel_eqs,this.mdVSQInit=null,this.mdVSQAfterFrame=null;const e={frame:t.frame,time:t.time,fps:t.fps,bass:t.bass,bass_att:t.bass_att,mid:t.mid,mid_att:t.mid_att,treb:t.treb,treb_att:t.treb_att,meshx:this.mesh_width,meshy:this.mesh_height,aspectx:this.invAspectx,aspecty:this.invAspecty,pixelsx:this.texsizeX,pixelsy:this.texsizeY};if(this.mdVS=Object.assign({},this.preset.baseVals,e),l.default.setWasm(this.preset.globalPools.perFrame,this.mdVS,Object.keys(this.mdVS)),this.rand_start=new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()]),this.rand_preset=new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()]),this.preset.init_eqs(),this.mdVSQInit=this.getQVars("perFrame"),this.preset.frame_eqs(),this.mdVSQAfterFrame=this.getQVars("perFrame"),this.mdVSTWaveInits=[],this.preset.waves&&this.preset.waves.length>0)for(let s=0;s<this.preset.waves.length;s++){const i=this.preset.waves[s],a=i.baseVals;a.enabled!==0?(l.default.setWasm(this.preset.globalPools[`wavePerFrame${s}`],a,Object.keys(a)),i.init_eqs&&(i.init_eqs(),l.default.setWasm(this.preset.globalPools[`wavePerFrame${s}`],a,Object.keys(a))),this.mdVSTWaveInits.push(this.getTVars(`wavePerFrame${s}`))):this.mdVSTWaveInits.push({})}if(this.mdVSTShapeInits=[],this.preset.shapes&&this.preset.shapes.length>0)for(let s=0;s<this.preset.shapes.length;s++){const i=this.preset.shapes[s],a=i.baseVals;a.enabled!==0?(l.default.setWasm(this.preset.globalPools[`shapePerFrame${s}`],a,Object.keys(a)),i.init_eqs&&(i.init_eqs(),l.default.setWasm(this.preset.globalPools[`shapePerFrame${s}`],a,Object.keys(a))),this.mdVSTShapeInits.push(this.getTVars(`shapePerFrame${s}`))):this.mdVSTShapeInits.push({})}}updatePreset(t,e){this.preset=t,this.initializeEquations(e)}updateGlobals(t){this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.mesh_width=t.mesh_width,this.mesh_height=t.mesh_height,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}runFrameEquations(t){l.default.setWasm(this.preset.globalPools.perFrame,this.mdVS,this.frameKeys),l.default.setWasm(this.preset.globalPools.perFrame,this.mdVSQInit,this.qs),l.default.setWasm(this.preset.globalPools.perFrame,t,this.globalKeys),this.preset.frame_eqs(),this.preset.save_qs(),this.mdVSQAfterFrame=this.getQVars("perFrame");const e=l.default.pickWasm(this.preset.globalPools.perFrame,[...this.frameKeys,...this.globalKeys]);return e.rand_preset=this.rand_preset,e.rand_start=this.rand_start,e}runWaveFrameEquations(t,e){const s=this.preset.waves[t].baseVals;return l.default.setWasm(this.preset.globalPools[`wavePerFrame${t}`],s,this.waveFrameInputKeys),l.default.setWasm(this.preset.globalPools[`wavePerFrame${t}`],this.mdVSQAfterFrame,this.qs),l.default.setWasm(this.preset.globalPools[`wavePerFrame${t}`],this.mdVSTWaveInits[t],this.ts),l.default.setWasm(this.preset.globalPools[`wavePerFrame${t}`],e,this.globalKeys),this.preset.waves[t].frame_eqs(),l.default.pickWasm(this.preset.globalPools[`wavePerFrame${t}`],this.waveFrameKeys)}}},"./src/image/imageTextures.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return l});class l{constructor(A){this.gl=A,this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.samplers={},this.clouds2Image=new Image,this.clouds2Image.onload=()=>{this.samplers.clouds2=this.gl.createTexture(),this.bindTexture(this.samplers.clouds2,this.clouds2Image,128,128)},this.clouds2Image.src="data:image/jpeg;base64,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",this.emptyImage=new Image,this.emptyImage.onload=()=>{this.samplers.empty=this.gl.createTexture(),this.bindTexture(this.samplers.empty,this.emptyImage,1,1)},this.emptyImage.src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs="}bindTexture(A,t,e,s){if(this.gl.bindTexture(this.gl.TEXTURE_2D,A),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,e,s,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const i=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,i)}}loadExtraImages(A){Object.keys(A).forEach(t=>{const{data:e,width:s,height:i}=A[t];if(!this.samplers[t]){const a=new Image;a.onload=()=>{this.samplers[t]=this.gl.createTexture(),this.bindTexture(this.samplers[t],a,s,i)},a.src=e}})}getTexture(A){const t=this.samplers[A];return t||this.samplers.clouds2}}},"./src/index.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return g}),m("./node_modules/ecma-proposal-math-extensions/reference-implementation/index.js"),m("./src/presetBase.js");var l=m("./src/visualizer.js");class g{static createVisualizer(t,e,s){return new l.default(t,e,s)}}},"./src/noise/noise.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return l});class l{constructor(A){this.gl=A,this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.noiseTexLQ=this.gl.createTexture(),this.noiseTexLQLite=this.gl.createTexture(),this.noiseTexMQ=this.gl.createTexture(),this.noiseTexHQ=this.gl.createTexture(),this.noiseTexVolLQ=this.gl.createTexture(),this.noiseTexVolHQ=this.gl.createTexture(),this.nTexArrLQ=l.createNoiseTex(256,1),this.nTexArrLQLite=l.createNoiseTex(32,1),this.nTexArrMQ=l.createNoiseTex(256,4),this.nTexArrHQ=l.createNoiseTex(256,8),this.nTexArrVolLQ=l.createNoiseVolTex(32,1),this.nTexArrVolHQ=l.createNoiseVolTex(32,4),this.bindTexture(this.noiseTexLQ,this.nTexArrLQ,256,256),this.bindTexture(this.noiseTexLQLite,this.nTexArrLQLite,32,32),this.bindTexture(this.noiseTexMQ,this.nTexArrMQ,256,256),this.bindTexture(this.noiseTexHQ,this.nTexArrHQ,256,256),this.bindTexture3D(this.noiseTexVolLQ,this.nTexArrVolLQ,32,32,32),this.bindTexture3D(this.noiseTexVolHQ,this.nTexArrVolHQ,32,32,32),this.noiseTexPointLQ=this.gl.createSampler(),A.samplerParameteri(this.noiseTexPointLQ,A.TEXTURE_MIN_FILTER,A.NEAREST_MIPMAP_NEAREST),A.samplerParameteri(this.noiseTexPointLQ,A.TEXTURE_MAG_FILTER,A.NEAREST),A.samplerParameteri(this.noiseTexPointLQ,A.TEXTURE_WRAP_S,A.REPEAT),A.samplerParameteri(this.noiseTexPointLQ,A.TEXTURE_WRAP_T,A.REPEAT)}bindTexture(A,t,e,s){if(this.gl.bindTexture(this.gl.TEXTURE_2D,A),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,e,s,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const i=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,i)}}bindTexture3D(A,t,e,s,i){if(this.gl.bindTexture(this.gl.TEXTURE_3D,A),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage3D(this.gl.TEXTURE_3D,0,this.gl.RGBA,e,s,i,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_3D),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const a=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_3D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,a)}}static fCubicInterpolate(A,t,e,s,i){const a=i*i,h=i*a,n=s-e-A+t,r=A-t-n,u=e-A,v=t;return n*h+r*a+u*i+v}static dwCubicInterpolate(A,t,e,s,i){const a=[];for(let h=0;h<4;h++){let n=l.fCubicInterpolate(A[h]/255,t[h]/255,e[h]/255,s[h]/255,i);n=Math.clamp(n,0,1),a[h]=n*255}return a}static createNoiseVolTex(A,t){const e=A*A*A,s=new Uint8Array(e*4),i=t>1?216:256,a=i*.5;for(let r=0;r<e;r++)s[r*4+0]=Math.floor(Math.random()*i+a),s[r*4+1]=Math.floor(Math.random()*i+a),s[r*4+2]=Math.floor(Math.random()*i+a),s[r*4+3]=Math.floor(Math.random()*i+a);const h=A*A,n=A;if(t>1){for(let r=0;r<A;r+=t)for(let u=0;u<A;u+=t)for(let v=0;v<A;v++)if(v%t!==0){const c=Math.floor(v/t)*t+A,f=r*h+u*n,o=[],p=[],d=[],P=[];for(let C=0;C<4;C++)o[C]=s[f*4+(c-t)%A*4+C],p[C]=s[f*4+c%A*4+C],d[C]=s[f*4+(c+t)%A*4+C],P[C]=s[f*4+(c+t*2)%A*4+C];const X=v%t/t,M=l.dwCubicInterpolate(o,p,d,P,X);for(let C=0;C<4;C++){const w=v*4+C;s[r*h*4+u*n*4+w]=M[C]}}for(let r=0;r<A;r+=t)for(let u=0;u<A;u++)for(let v=0;v<A;v++)if(v%t!==0){const c=Math.floor(v/t)*t+A,f=r*h,o=[],p=[],d=[],P=[];for(let C=0;C<4;C++){const w=u*4+f*4+C;o[C]=s[(c-t)%A*n*4+w],p[C]=s[c%A*n*4+w],d[C]=s[(c+t)%A*n*4+w],P[C]=s[(c+t*2)%A*n*4+w]}const X=v%t/t,M=l.dwCubicInterpolate(o,p,d,P,X);for(let C=0;C<4;C++){const w=u*4+f*4+C;s[v*n*4+w]=M[C]}}for(let r=0;r<A;r++)for(let u=0;u<A;u++)for(let v=0;v<A;v++)if(v%t!==0){const c=u*n,f=Math.floor(v/t)*t+A,o=[],p=[],d=[],P=[];for(let C=0;C<4;C++){const w=r*4+c*4+C;o[C]=s[(f-t)%A*h*4+w],p[C]=s[f%A*h*4+w],d[C]=s[(f+t)%A*h*4+w],P[C]=s[(f+t*2)%A*h*4+w]}const X=u%t/t,M=l.dwCubicInterpolate(o,p,d,P,X);for(let C=0;C<4;C++){const w=r*4+c*4+C;s[v*h*4+w]=M[C]}}}return s}static createNoiseTex(A,t){const e=A*A,s=new Uint8Array(e*4),i=t>1?216:256,a=i*.5;for(let h=0;h<e;h++)s[h*4+0]=Math.floor(Math.random()*i+a),s[h*4+1]=Math.floor(Math.random()*i+a),s[h*4+2]=Math.floor(Math.random()*i+a),s[h*4+3]=Math.floor(Math.random()*i+a);if(t>1){for(let h=0;h<A;h+=t)for(let n=0;n<A;n++)if(n%t!==0){const r=Math.floor(n/t)*t+A,u=h*A,v=[],c=[],f=[],o=[];for(let P=0;P<4;P++)v[P]=s[u*4+(r-t)%A*4+P],c[P]=s[u*4+r%A*4+P],f[P]=s[u*4+(r+t)%A*4+P],o[P]=s[u*4+(r+t*2)%A*4+P];const p=n%t/t,d=l.dwCubicInterpolate(v,c,f,o,p);for(let P=0;P<4;P++)s[h*A*4+n*4+P]=d[P]}for(let h=0;h<A;h++)for(let n=0;n<A;n++)if(n%t!==0){const r=Math.floor(n/t)*t+A,u=[],v=[],c=[],f=[];for(let d=0;d<4;d++)u[d]=s[(r-t)%A*A*4+h*4+d],v[d]=s[r%A*A*4+h*4+d],c[d]=s[(r+t)%A*A*4+h*4+d],f[d]=s[(r+t*2)%A*A*4+h*4+d];const o=n%t/t,p=l.dwCubicInterpolate(u,v,c,f,o);for(let d=0;d<4;d++)s[n*A*4+h*4+d]=p[d]}}return s}}},"./src/presetBase.js":function(j,E){var m=1e-5;window.sqr=function(A){return A*A},window.sqrt=function(A){return Math.sqrt(Math.abs(A))},window.log10=function(A){return Math.log(A)*Math.LOG10E},window.sign=function(A){return A>0?1:A<0?-1:0},window.rand=function(A){var t=Math.floor(A);return t<1?Math.random():Math.random()*t},window.randint=function(A){return Math.floor(rand(A))},window.bnot=function(A){return Math.abs(A)<m?1:0};function l(g){return isFinite(g)&&!isNaN(g)}window.pow=function(A,t){var e=Math.pow(A,t);return l(e)?e:0},window.div=function(A,t){return t===0?0:A/t},window.mod=function(A,t){if(t===0)return 0;var e=Math.floor(A)%Math.floor(t);return e},window.bitor=function(A,t){var e=Math.floor(A)|Math.floor(t);return e},window.bitand=function(A,t){var e=Math.floor(A)&Math.floor(t);return e},window.sigmoid=function(A,t){var e=1+Math.exp(-A*t);return Math.abs(e)>m?1/e:0},window.bor=function(A,t){return Math.abs(A)>m||Math.abs(t)>m?1:0},window.band=function(A,t){return Math.abs(A)>m&&Math.abs(t)>m?1:0},window.equal=function(A,t){return Math.abs(A-t)<m?1:0},window.above=function(A,t){return A>t?1:0},window.below=function(A,t){return A<t?1:0},window.ifcond=function(A,t,e){return Math.abs(A)>m?t:e},window.memcpy=function(A,t,e,s){let i=t,a=e,h=s;return a<0&&(h+=a,i-=a,a=0),i<0&&(h+=i,a-=i,i=0),h>0&&A.copyWithin(i,a,h),t}},"./src/rendering/blendPattern.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return l});class l{constructor(A){this.mesh_width=A.mesh_width,this.mesh_height=A.mesh_height,this.aspectx=A.aspectx,this.aspecty=A.aspecty,this.vertInfoA=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)),this.vertInfoC=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)),this.createBlendPattern()}static resizeMatrixValues(A,t,e,s,i){const a=new Float32Array((s+1)*(i+1));let h=0;for(let n=0;n<i+1;n++)for(let r=0;r<s+1;r++){let u=r/i,v=n/s;u*=t+1,v*=e+1,u=Math.clamp(u,0,t-1),v=Math.clamp(v,0,e-1);const c=Math.floor(u),f=Math.floor(v),o=u-c,p=v-f,d=A[f*(t+1)+c],P=A[f*(t+1)+(c+1)],X=A[(f+1)*(t+1)+c],M=A[(f+1)*(t+1)+(c+1)];a[h]=d*(1-o)*(1-p)+P*o*(1-p)+X*(1-o)*p+M*o*p,h+=1}return a}updateGlobals(A){const t=this.mesh_width,e=this.mesh_height;this.mesh_width=A.mesh_width,this.mesh_height=A.mesh_height,this.aspectx=A.aspectx,this.aspecty=A.aspecty,(this.mesh_width!==t||this.mesh_height!==e)&&(this.vertInfoA=l.resizeMatrixValues(this.vertInfoA,t,e,this.mesh_width,this.mesh_height),this.vertInfoC=l.resizeMatrixValues(this.vertInfoC,t,e,this.mesh_width,this.mesh_height))}genPlasma(A,t,e,s,i){const a=Math.floor((A+t)/2),h=Math.floor((e+s)/2);let n=this.vertInfoC[e*(this.mesh_width+1)+A],r=this.vertInfoC[e*(this.mesh_width+1)+t],u=this.vertInfoC[s*(this.mesh_width+1)+A],v=this.vertInfoC[s*(this.mesh_width+1)+t];s-e>=2&&(A===0&&(this.vertInfoC[h*(this.mesh_width+1)+A]=.5*(n+u)+(Math.random()*2-1)*i*this.aspecty),this.vertInfoC[h*(this.mesh_width+1)+t]=.5*(r+v)+(Math.random()*2-1)*i*this.aspecty),t-A>=2&&(e===0&&(this.vertInfoC[e*(this.mesh_width+1)+a]=.5*(n+r)+(Math.random()*2-1)*i*this.aspectx),this.vertInfoC[s*(this.mesh_width+1)+a]=.5*(u+v)+(Math.random()*2-1)*i*this.aspectx),s-e>=2&&t-A>=2&&(n=this.vertInfoC[h*(this.mesh_width+1)+A],r=this.vertInfoC[h*(this.mesh_width+1)+t],u=this.vertInfoC[e*(this.mesh_width+1)+a],v=this.vertInfoC[s*(this.mesh_width+1)+a],this.vertInfoC[h*(this.mesh_width+1)+a]=.25*(u+v+n+r)+(Math.random()*2-1)*i,this.genPlasma(A,a,e,h,i*.5),this.genPlasma(a,t,e,h,i*.5),this.genPlasma(A,a,h,s,i*.5),this.genPlasma(a,t,h,s,i*.5))}createBlendPattern(){const A=1+Math.floor(Math.random()*3);if(A===0){let t=0;for(let e=0;e<=this.mesh_height;e++)for(let s=0;s<=this.mesh_width;s++)this.vertInfoA[t]=1,this.vertInfoC[t]=0,t+=1}else if(A===1){const t=Math.random()*6.28,e=Math.cos(t),s=Math.sin(t),i=.1+.2*Math.random(),a=1/i;let h=0;for(let n=0;n<=this.mesh_height;n++){const r=n/this.mesh_height*this.aspecty;for(let u=0;u<=this.mesh_width;u++){let c=(u/this.mesh_width*this.aspectx-.5)*e+(r-.5)*s+.5;c=(c-.5)/Math.sqrt(2)+.5,this.vertInfoA[h]=a*(1+i),this.vertInfoC[h]=-a+a*c,h+=1}}}else if(A===2){const t=.12+.13*Math.random(),e=1/t;this.vertInfoC[0]=Math.random(),this.vertInfoC[this.mesh_width]=Math.random(),this.vertInfoC[this.mesh_height*(this.mesh_width+1)]=Math.random(),this.vertInfoC[this.mesh_height*(this.mesh_width+1)+this.mesh_width]=Math.random(),this.genPlasma(0,this.mesh_width,0,this.mesh_height,.25);let s=this.vertInfoC[0],i=this.vertInfoC[0],a=0;for(let n=0;n<=this.mesh_height;n++)for(let r=0;r<=this.mesh_width;r++)s>this.vertInfoC[a]&&(s=this.vertInfoC[a]),i<this.vertInfoC[a]&&(i=this.vertInfoC[a]),a+=1;const h=1/(i-s);a=0;for(let n=0;n<=this.mesh_height;n++)for(let r=0;r<=this.mesh_width;r++){const u=(this.vertInfoC[a]-s)*h;this.vertInfoA[a]=e*(1+t),this.vertInfoC[a]=-e+e*u,a+=1}}else if(A===3){const t=.02+.14*Math.random()+.34*Math.random(),e=1/t,s=Math.floor(Math.random()*2)*2-1;let i=0;for(let a=0;a<=this.mesh_height;a++){const h=(a/this.mesh_height-.5)*this.aspecty;for(let n=0;n<=this.mesh_width;n++){const r=(n/this.mesh_width-.5)*this.aspectx;let u=Math.sqrt(r*r+h*h)*1.41421;s===-1&&(u=1-u),this.vertInfoA[i]=e*(1+t),this.vertInfoC[i]=-e+e*u,i+=1}}}}}},"./src/rendering/motionVectors/motionVectors.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return g});var l=m("./src/rendering/shaders/shaderUtils.js");class g{constructor(t,e){this.gl=t,this.maxX=64,this.maxY=48,this.positions=new Float32Array(this.maxX*this.maxY*2*3),this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.positionVertexBuf=this.gl.createBuffer(),this.floatPrecision=l.default.getFragmentFloatPrecision(this.gl),this.createShader()}updateGlobals(t){this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.mesh_width=t.mesh_width,this.mesh_height=t.mesh_height}createShader(){this.shaderProgram=this.gl.createProgram();const t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`
      #version 300 es
      in vec3 aPos;
      void main(void) {
        gl_Position = vec4(aPos, 1.0);
      }
      `.trim()),this.gl.compileShader(t);const e=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(e,`
      #version 300 es
      precision ${this.floatPrecision} float;
      precision highp int;
      precision mediump sampler2D;
      out vec4 fragColor;
      uniform vec4 u_color;
      void main(void) {
        fragColor = u_color;
      }
      `.trim()),this.gl.compileShader(e),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,e),this.gl.linkProgram(this.shaderProgram),this.aPosLoc=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.colorLoc=this.gl.getUniformLocation(this.shaderProgram,"u_color")}getMotionDir(t,e,s){const i=Math.floor(s*this.mesh_height),a=s*this.mesh_height-i,h=Math.floor(e*this.mesh_width),n=e*this.mesh_width-h,r=h+1,u=i+1,v=this.mesh_width+1;let c,f;return c=t[(i*v+h)*2+0]*(1-n)*(1-a),f=t[(i*v+h)*2+1]*(1-n)*(1-a),c+=t[(i*v+r)*2+0]*n*(1-a),f+=t[(i*v+r)*2+1]*n*(1-a),c+=t[(u*v+h)*2+0]*(1-n)*a,f+=t[(u*v+h)*2+1]*(1-n)*a,c+=t[(u*v+r)*2+0]*n*a,f+=t[(u*v+r)*2+1]*n*a,[c,1-f]}generateMotionVectors(t,e){const i=t.bmotionvectorson===0?0:t.mv_a;let a=Math.floor(t.mv_x),h=Math.floor(t.mv_y);if(i>.001&&a>0&&h>0){let n=t.mv_x-a,r=t.mv_y-h;a>this.maxX&&(a=this.maxX,n=0),h>this.maxY&&(h=this.maxY,r=0);const u=t.mv_dx,v=t.mv_dy,c=t.mv_l,f=1/this.texsizeX;this.numVecVerts=0;for(let o=0;o<h;o++){let p=(o+.25)/(h+r+.25-1);if(p-=v,p>1e-4&&p<.9999)for(let d=0;d<a;d++){let P=(d+.25)/(a+n+.25-1);if(P+=u,P>1e-4&&P<.9999){const X=this.getMotionDir(e,P,p);let M=X[0],C=X[1],w=M-P,b=C-p;w*=c,b*=c;let _=Math.sqrt(w*w+b*b);_<f&&_>1e-8?(_=f/_,w*=_,b*=_):(w=f,w=f),M=P+w,C=p+b;const T=2*P-1,x=2*p-1,I=2*M-1,U=2*C-1;this.positions[this.numVecVerts*3+0]=T,this.positions[this.numVecVerts*3+1]=x,this.positions[this.numVecVerts*3+2]=0,this.positions[(this.numVecVerts+1)*3+0]=I,this.positions[(this.numVecVerts+1)*3+1]=U,this.positions[(this.numVecVerts+1)*3+2]=0,this.numVecVerts+=2}}}if(this.numVecVerts>0)return this.color=[t.mv_r,t.mv_g,t.mv_b,i],!0}return!1}drawMotionVectors(t,e){this.generateMotionVectors(t,e)&&(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc),this.gl.uniform4fv(this.colorLoc,this.color),this.gl.lineWidth(1),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.LINES,0,this.numVecVerts))}}},"./src/rendering/renderer.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return C});var l=m("./src/audio/audioLevels.js"),g=m("./src/blankPreset.js"),A=m.n(g),t=m("./src/equations/presetEquationRunner.js"),e=m("./src/equations/presetEquationRunnerWASM.js"),s=m("./src/rendering/waves/basicWaveform.js"),i=m("./src/rendering/waves/customWaveform.js"),a=m("./src/rendering/shapes/customShape.js"),h=m("./src/rendering/sprites/border.js"),n=m("./src/rendering/sprites/darkenCenter.js"),r=m("./src/rendering/motionVectors/motionVectors.js"),u=m("./src/rendering/shaders/warp.js"),v=m("./src/rendering/shaders/comp.js"),c=m("./src/rendering/shaders/output.js"),f=m("./src/rendering/shaders/resample.js"),o=m("./src/rendering/shaders/blur/blur.js"),p=m("./src/noise/noise.js"),d=m("./src/image/imageTextures.js"),P=m("./src/rendering/text/titleText.js"),X=m("./src/rendering/blendPattern.js"),M=m("./src/utils.js");class C{constructor(b,_,T){this.gl=b,this.audio=_,this.frameNum=0,this.fps=30,this.time=0,this.presetTime=0,this.lastTime=performance.now(),this.timeHist=[0],this.timeHistMax=120,this.blending=!1,this.blendStartTime=0,this.blendProgress=0,this.blendDuration=0,this.width=T.width||1200,this.height=T.height||900,this.mesh_width=T.meshWidth||48,this.mesh_height=T.meshHeight||36,this.pixelRatio=T.pixelRatio||window.devicePixelRatio||1,this.textureRatio=T.textureRatio||1,this.outputFXAA=T.outputFXAA||!1,this.texsizeX=this.width*this.pixelRatio*this.textureRatio,this.texsizeY=this.height*this.pixelRatio*this.textureRatio,this.aspectx=this.texsizeY>this.texsizeX?this.texsizeX/this.texsizeY:1,this.aspecty=this.texsizeX>this.texsizeY?this.texsizeY/this.texsizeX:1,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.qs=M.default.range(1,33).map(U=>`q${U}`),this.ts=M.default.range(1,9).map(U=>`t${U}`),this.regs=M.default.range(0,100).map(U=>U<10?`reg0${U}`:`reg${U}`),this.blurRatios=[[.5,.25],[.125,.125],[.0625,.0625]],this.audioLevels=new l.default(this.audio),this.prevFrameBuffer=this.gl.createFramebuffer(),this.targetFrameBuffer=this.gl.createFramebuffer(),this.prevTexture=this.gl.createTexture(),this.targetTexture=this.gl.createTexture(),this.compFrameBuffer=this.gl.createFramebuffer(),this.compTexture=this.gl.createTexture(),this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.bindFrameBufferTexture(this.prevFrameBuffer,this.prevTexture),this.bindFrameBufferTexture(this.targetFrameBuffer,this.targetTexture),this.bindFrameBufferTexture(this.compFrameBuffer,this.compTexture);const x={pixelRatio:this.pixelRatio,textureRatio:this.textureRatio,texsizeX:this.texsizeX,texsizeY:this.texsizeY,mesh_width:this.mesh_width,mesh_height:this.mesh_height,aspectx:this.aspectx,aspecty:this.aspecty};this.noise=new p.default(b),this.image=new d.default(b),this.warpShader=new u.default(b,this.noise,this.image,x),this.compShader=new v.default(b,this.noise,this.image,x),this.outputShader=new c.default(b,x),this.prevWarpShader=new u.default(b,this.noise,this.image,x),this.prevCompShader=new v.default(b,this.noise,this.image,x),this.numBlurPasses=0,this.blurShader1=new o.default(0,this.blurRatios,b,x),this.blurShader2=new o.default(1,this.blurRatios,b,x),this.blurShader3=new o.default(2,this.blurRatios,b,x),this.blurTexture1=this.blurShader1.blurVerticalTexture,this.blurTexture2=this.blurShader2.blurVerticalTexture,this.blurTexture3=this.blurShader3.blurVerticalTexture,this.basicWaveform=new s.default(b,x),this.customWaveforms=M.default.range(4).map(U=>new i.default(U,b,x)),this.customShapes=M.default.range(4).map(U=>new a.default(U,b,x)),this.prevCustomWaveforms=M.default.range(4).map(U=>new i.default(U,b,x)),this.prevCustomShapes=M.default.range(4).map(U=>new a.default(U,b,x)),this.darkenCenter=new n.default(b,x),this.innerBorder=new h.default(b,x),this.outerBorder=new h.default(b,x),this.motionVectors=new r.default(b,x),this.titleText=new P.default(b,x),this.blendPattern=new X.default(x),this.resampleShader=new f.default(b),this.supertext={startTime:-1},this.warpUVs=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*2),this.warpColor=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*4),this.gl.clearColor(0,0,0,1),this.blankPreset=A.a;const I={frame:0,time:0,fps:45,bass:1,bass_att:1,mid:1,mid_att:1,treb:1,treb_att:1};this.preset=A.a,this.prevPreset=this.preset,this.presetEquationRunner=new t.default(this.preset,I,x),this.prevPresetEquationRunner=new t.default(this.prevPreset,I,x),this.preset.useWASM||(this.regVars=this.presetEquationRunner.mdVSRegs)}static getHighestBlur(b){return/sampler_blur3/.test(b)?3:/sampler_blur2/.test(b)?2:/sampler_blur1/.test(b)?1:0}loadPreset(b,_){this.blendPattern.createBlendPattern(),this.blending=!0,this.blendStartTime=this.time,this.blendDuration=_,this.blendProgress=0,this.prevPresetEquationRunner=this.presetEquationRunner,this.prevPreset=this.preset,this.preset=b,this.presetTime=this.time;const T={frame:this.frameNum,time:this.time,fps:this.fps,bass:this.audioLevels.bass,bass_att:this.audioLevels.bass_att,mid:this.audioLevels.mid,mid_att:this.audioLevels.mid_att,treb:this.audioLevels.treb,treb_att:this.audioLevels.treb_att},x={pixelRatio:this.pixelRatio,textureRatio:this.textureRatio,texsizeX:this.texsizeX,texsizeY:this.texsizeY,mesh_width:this.mesh_width,mesh_height:this.mesh_height,aspectx:this.aspectx,aspecty:this.aspecty};b.useWASM?(this.preset.globalPools.perFrame.old_wave_mode.value=this.prevPreset.baseVals.wave_mode,this.preset.baseVals.old_wave_mode=this.prevPreset.baseVals.wave_mode,this.presetEquationRunner=new e.default(this.preset,T,x),this.preset.pixel_eqs_initialize_array&&this.preset.pixel_eqs_initialize_array(this.mesh_width,this.mesh_height)):(this.preset.baseVals.old_wave_mode=this.prevPreset.baseVals.wave_mode,this.presetEquationRunner=new t.default(this.preset,T,x),this.regVars=this.presetEquationRunner.mdVSRegs);const I=this.prevWarpShader;this.prevWarpShader=this.warpShader,this.warpShader=I;const U=this.prevCompShader;this.prevCompShader=this.compShader,this.compShader=U;const R=this.preset.warp.trim(),S=this.preset.comp.trim();this.warpShader.updateShader(R),this.compShader.updateShader(S),R.length===0?this.numBlurPasses=0:this.numBlurPasses=C.getHighestBlur(R),S.length!==0&&(this.numBlurPasses=Math.max(this.numBlurPasses,C.getHighestBlur(S)))}loadExtraImages(b){this.image.loadExtraImages(b)}setRendererSize(b,_,T){const x=this.texsizeX,I=this.texsizeY;if(this.width=b,this.height=_,this.mesh_width=T.meshWidth||this.mesh_width,this.mesh_height=T.meshHeight||this.mesh_height,this.pixelRatio=T.pixelRatio||this.pixelRatio,this.textureRatio=T.textureRatio||this.textureRatio,this.texsizeX=b*this.pixelRatio*this.textureRatio,this.texsizeY=_*this.pixelRatio*this.textureRatio,this.aspectx=this.texsizeY>this.texsizeX?this.texsizeX/this.texsizeY:1,this.aspecty=this.texsizeX>this.texsizeY?this.texsizeY/this.texsizeX:1,this.texsizeX!==x||this.texsizeY!==I){const U=this.gl.createTexture();this.bindFrameBufferTexture(this.targetFrameBuffer,U),this.bindFrambufferAndSetViewport(this.targetFrameBuffer,this.texsizeX,this.texsizeY),this.resampleShader.renderQuadTexture(this.targetTexture),this.targetTexture=U,this.bindFrameBufferTexture(this.prevFrameBuffer,this.prevTexture),this.bindFrameBufferTexture(this.compFrameBuffer,this.compTexture)}this.updateGlobals(),this.frameNum>0&&this.renderToScreen()}setInternalMeshSize(b,_){this.mesh_width=b,this.mesh_height=_,this.updateGlobals()}setOutputAA(b){this.outputFXAA=b}updateGlobals(){const b={pixelRatio:this.pixelRatio,textureRatio:this.textureRatio,texsizeX:this.texsizeX,texsizeY:this.texsizeY,mesh_width:this.mesh_width,mesh_height:this.mesh_height,aspectx:this.aspectx,aspecty:this.aspecty};this.presetEquationRunner.updateGlobals(b),this.prevPresetEquationRunner.updateGlobals(b),this.warpShader.updateGlobals(b),this.prevWarpShader.updateGlobals(b),this.compShader.updateGlobals(b),this.prevCompShader.updateGlobals(b),this.outputShader.updateGlobals(b),this.blurShader1.updateGlobals(b),this.blurShader2.updateGlobals(b),this.blurShader3.updateGlobals(b),this.basicWaveform.updateGlobals(b),this.customWaveforms.forEach(_=>_.updateGlobals(b)),this.customShapes.forEach(_=>_.updateGlobals(b)),this.prevCustomWaveforms.forEach(_=>_.updateGlobals(b)),this.prevCustomShapes.forEach(_=>_.updateGlobals(b)),this.darkenCenter.updateGlobals(b),this.innerBorder.updateGlobals(b),this.outerBorder.updateGlobals(b),this.motionVectors.updateGlobals(b),this.titleText.updateGlobals(b),this.blendPattern.updateGlobals(b),this.warpUVs=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*2),this.warpColor=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*4),this.preset.pixel_eqs_initialize_array&&this.preset.pixel_eqs_initialize_array(this.mesh_width,this.mesh_height)}calcTimeAndFPS(b){let _;if(b)_=b;else{const I=performance.now();_=(I-this.lastTime)/1e3,(_>1||_<0||this.frame<2)&&(_=1/30),this.lastTime=I}this.time+=1/this.fps,this.blending&&(this.blendProgress=(this.time-this.blendStartTime)/this.blendDuration,this.blendProgress>1&&(this.blending=!1));const T=this.timeHist[this.timeHist.length-1]+_;this.timeHist.push(T),this.timeHist.length>this.timeHistMax&&this.timeHist.shift();const x=this.timeHist.length/(T-this.timeHist[0]);Math.abs(x-this.fps)>3&&this.frame>this.timeHistMax?this.fps=x:this.fps=.93*this.fps+(1-.93)*x}runPixelEquations(b,_,T,x){const I=this.mesh_width,U=this.mesh_height,R=I+1,S=U+1,y=this.time*_.warpanimspeed,F=1/_.warpscale,D=11.68+4*Math.cos(y*1.413+10),z=8.77+3*Math.cos(y*1.113+7),O=10.54+3*Math.cos(y*1.233+3),V=11.49+4*Math.cos(y*.933+5),K=0/this.texsizeX,B=0/this.texsizeY,Q=this.aspectx,N=this.aspecty;let q=0,Y=0;if(b.preset.useWASM){const L=b.preset.globalPools.perVertex;if(M.default.setWasm(L,T,b.globalKeys),M.default.setWasm(L,b.mdVSQAfterFrame,b.qs),L.zoom.value=_.zoom,L.zoomexp.value=_.zoomexp,L.rot.value=_.rot,L.warp.value=_.warp,L.cx.value=_.cx,L.cy.value=_.cy,L.dx.value=_.dx,L.dy.value=_.dy,L.sx.value=_.sx,L.sy.value=_.sy,b.preset.pixel_eqs_wasm(b.runVertEQs,this.mesh_width,this.mesh_height,this.time,_.warpanimspeed,_.warpscale,this.aspectx,this.aspecty),!x)this.warpUVs=b.preset.pixel_eqs_get_array(),this.warpColor.fill(1);else{const it=b.preset.pixel_eqs_get_array();let G=0,at=0;for(let ot=0;ot<S;ot++)for(let ht=0;ht<R;ht++){const gt=it[G],st=it[G+1];let rt=this.blendPattern.vertInfoA[G/2]*this.blendProgress+this.blendPattern.vertInfoC[G/2];rt=Math.clamp(rt,0,1),this.warpUVs[G]=this.warpUVs[G]*rt+gt*(1-rt),this.warpUVs[G+1]=this.warpUVs[G+1]*rt+st*(1-rt),this.warpColor[at+0]=1,this.warpColor[at+1]=1,this.warpColor[at+2]=1,this.warpColor[at+3]=rt,G+=2,at+=4}}}else{let L=M.default.cloneVars(_),it=L.warp,G=L.zoom,at=L.zoomexp,ot=L.cx,ht=L.cy,gt=L.sx,st=L.sy,rt=L.dx,ut=L.dy,W=L.rot;for(let H=0;H<S;H++)for(let J=0;J<R;J++){const k=J/I*2-1,Z=H/U*2-1,$=Math.sqrt(k*k*Q*Q+Z*Z*N*N);if(b.runVertEQs){let nt;H===U/2&&J===I/2?nt=0:nt=M.default.atan2(Z*N,k*Q),L.x=k*.5*Q+.5,L.y=Z*-.5*N+.5,L.rad=$,L.ang=nt,L.zoom=_.zoom,L.zoomexp=_.zoomexp,L.rot=_.rot,L.warp=_.warp,L.cx=_.cx,L.cy=_.cy,L.dx=_.dx,L.dy=_.dy,L.sx=_.sx,L.sy=_.sy,L=b.runPixelEquations(L),it=L.warp,G=L.zoom,at=L.zoomexp,ot=L.cx,ht=L.cy,gt=L.sx,st=L.sy,rt=L.dx,ut=L.dy,W=L.rot}const At=1/G**at**($*2-1);let tt=k*.5*Q*At+.5,et=-Z*.5*N*At+.5;tt=(tt-ot)/gt+ot,et=(et-ht)/st+ht,it!==0&&(tt+=it*.0035*Math.sin(y*.333+F*(k*D-Z*V)),et+=it*.0035*Math.cos(y*.375-F*(k*O+Z*z)),tt+=it*.0035*Math.cos(y*.753-F*(k*z-Z*O)),et+=it*.0035*Math.sin(y*.825+F*(k*D+Z*V)));const dt=tt-ot,ft=et-ht,mt=Math.cos(W),ct=Math.sin(W);if(tt=dt*mt-ft*ct+ot,et=dt*ct+ft*mt+ht,tt-=rt,et-=ut,tt=(tt-.5)/Q+.5,et=(et-.5)/N+.5,tt+=K,et+=B,!x)this.warpUVs[q]=tt,this.warpUVs[q+1]=et,this.warpColor[Y+0]=1,this.warpColor[Y+1]=1,this.warpColor[Y+2]=1,this.warpColor[Y+3]=1;else{let nt=this.blendPattern.vertInfoA[q/2]*this.blendProgress+this.blendPattern.vertInfoC[q/2];nt=Math.clamp(nt,0,1),this.warpUVs[q]=this.warpUVs[q]*nt+tt*(1-nt),this.warpUVs[q+1]=this.warpUVs[q+1]*nt+et*(1-nt),this.warpColor[Y+0]=1,this.warpColor[Y+1]=1,this.warpColor[Y+2]=1,this.warpColor[Y+3]=nt}q+=2,Y+=4}this.mdVSVertex=L}}static mixFrameEquations(b,_,T){const x=.5-.5*Math.cos(b*Math.PI),I=1-x,U=.5,R=M.default.cloneVars(_);return R.decay=x*_.decay+I*T.decay,R.wave_a=x*_.wave_a+I*T.wave_a,R.wave_r=x*_.wave_r+I*T.wave_r,R.wave_g=x*_.wave_g+I*T.wave_g,R.wave_b=x*_.wave_b+I*T.wave_b,R.wave_x=x*_.wave_x+I*T.wave_x,R.wave_y=x*_.wave_y+I*T.wave_y,R.wave_mystery=x*_.wave_mystery+I*T.wave_mystery,R.ob_size=x*_.ob_size+I*T.ob_size,R.ob_r=x*_.ob_r+I*T.ob_r,R.ob_g=x*_.ob_g+I*T.ob_g,R.ob_b=x*_.ob_b+I*T.ob_b,R.ob_a=x*_.ob_a+I*T.ob_a,R.ib_size=x*_.ib_size+I*T.ib_size,R.ib_r=x*_.ib_r+I*T.ib_r,R.ib_g=x*_.ib_g+I*T.ib_g,R.ib_b=x*_.ib_b+I*T.ib_b,R.ib_a=x*_.ib_a+I*T.ib_a,R.mv_x=x*_.mv_x+I*T.mv_x,R.mv_y=x*_.mv_y+I*T.mv_y,R.mv_dx=x*_.mv_dx+I*T.mv_dx,R.mv_dy=x*_.mv_dy+I*T.mv_dy,R.mv_l=x*_.mv_l+I*T.mv_l,R.mv_r=x*_.mv_r+I*T.mv_r,R.mv_g=x*_.mv_g+I*T.mv_g,R.mv_b=x*_.mv_b+I*T.mv_b,R.mv_a=x*_.mv_a+I*T.mv_a,R.echo_zoom=x*_.echo_zoom+I*T.echo_zoom,R.echo_alpha=x*_.echo_alpha+I*T.echo_alpha,R.echo_orient=x*_.echo_orient+I*T.echo_orient,R.wave_dots=x<U?T.wave_dots:_.wave_dots,R.wave_thick=x<U?T.wave_thick:_.wave_thick,R.additivewave=x<U?T.additivewave:_.additivewave,R.wave_brighten=x<U?T.wave_brighten:_.wave_brighten,R.darken_center=x<U?T.darken_center:_.darken_center,R.gammaadj=x<U?T.gammaadj:_.gammaadj,R.wrap=x<U?T.wrap:_.wrap,R.invert=x<U?T.invert:_.invert,R.brighten=x<U?T.brighten:_.brighten,R.darken=x<U?T.darken:_.darken,R.solarize=x<U?T.brighten:_.solarize,R.b1n=x*_.b1n+I*T.b1n,R.b2n=x*_.b2n+I*T.b2n,R.b3n=x*_.b3n+I*T.b3n,R.b1x=x*_.b1x+I*T.b1x,R.b2x=x*_.b2x+I*T.b2x,R.b3x=x*_.b3x+I*T.b3x,R.b1ed=x*_.b1ed+I*T.b1ed,R}static getBlurValues(b){let _=b.b1n,T=b.b2n,x=b.b3n,I=b.b1x,U=b.b2x,R=b.b3x;const S=.1;if(I-_<S){const y=(_+I)*.5;_=y-S*.5,I=y-S*.5}if(U=Math.min(I,U),T=Math.max(_,T),U-T<S){const y=(T+U)*.5;T=y-S*.5,U=y-S*.5}if(R=Math.min(U,R),x=Math.max(T,x),R-x<S){const y=(x+R)*.5;x=y-S*.5,R=y-S*.5}return{blurMins:[_,T,x],blurMaxs:[I,U,R]}}bindFrambufferAndSetViewport(b,_,T){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,b),this.gl.viewport(0,0,_,T)}bindFrameBufferTexture(b,_){if(this.gl.bindTexture(this.gl.TEXTURE_2D,_),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.texsizeX,this.texsizeY,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array(this.texsizeX*this.texsizeY*4)),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const T=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,T)}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,b),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,_,0)}render({audioLevels:b,elapsedTime:_}={}){this.calcTimeAndFPS(_),this.frameNum+=1,b?this.audio.updateAudio(b.timeByteArray,b.timeByteArrayL,b.timeByteArrayR):this.audio.sampleAudio(),this.audioLevels.updateAudioLevels(this.fps,this.frameNum);const T={frame:this.frameNum,time:this.time,fps:this.fps,bass:this.audioLevels.bass,bass_att:this.audioLevels.bass_att,mid:this.audioLevels.mid,mid_att:this.audioLevels.mid_att,treb:this.audioLevels.treb,treb_att:this.audioLevels.treb_att,meshx:this.mesh_width,meshy:this.mesh_height,aspectx:this.invAspectx,aspecty:this.invAspecty,pixelsx:this.texsizeX,pixelsy:this.texsizeY},x=Object.assign({},T);this.prevPreset.useWASM||(x.gmegabuf=this.prevPresetEquationRunner.gmegabuf),this.preset.useWASM||(T.gmegabuf=this.presetEquationRunner.gmegabuf,Object.assign(T,this.regVars));const I=this.presetEquationRunner.runFrameEquations(T);this.runPixelEquations(this.presetEquationRunner,I,T,!1),this.preset.useWASM||(Object.assign(this.regVars,M.default.pick(this.mdVSVertex,this.regs)),Object.assign(T,this.regVars));let U;this.blending?(this.prevMDVSFrame=this.prevPresetEquationRunner.runFrameEquations(x),this.runPixelEquations(this.prevPresetEquationRunner,this.prevMDVSFrame,x,!0),U=C.mixFrameEquations(this.blendProgress,I,this.prevMDVSFrame)):U=I;const R=this.targetTexture;this.targetTexture=this.prevTexture,this.prevTexture=R;const S=this.targetFrameBuffer;this.targetFrameBuffer=this.prevFrameBuffer,this.prevFrameBuffer=S,this.gl.bindTexture(this.gl.TEXTURE_2D,this.prevTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.bindFrambufferAndSetViewport(this.targetFrameBuffer,this.texsizeX,this.texsizeY),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.enable(this.gl.BLEND),this.gl.blendEquation(this.gl.FUNC_ADD),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);const{blurMins:y,blurMaxs:F}=C.getBlurValues(U);this.blending?(this.prevWarpShader.renderQuadTexture(!1,this.prevTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,y,F,this.prevMDVSFrame,this.prevPresetEquationRunner.mdVSQAfterFrame,this.warpUVs,this.warpColor),this.warpShader.renderQuadTexture(!0,this.prevTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,y,F,U,this.presetEquationRunner.mdVSQAfterFrame,this.warpUVs,this.warpColor)):this.warpShader.renderQuadTexture(!1,this.prevTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,y,F,I,this.presetEquationRunner.mdVSQAfterFrame,this.warpUVs,this.warpColor),this.numBlurPasses>0&&(this.blurShader1.renderBlurTexture(this.targetTexture,I,y,F),this.numBlurPasses>1&&(this.blurShader2.renderBlurTexture(this.blurTexture1,I,y,F),this.numBlurPasses>2&&this.blurShader3.renderBlurTexture(this.blurTexture2,I,y,F)),this.bindFrambufferAndSetViewport(this.targetFrameBuffer,this.texsizeX,this.texsizeY)),this.motionVectors.drawMotionVectors(U,this.warpUVs),this.preset.shapes&&this.preset.shapes.length>0&&this.customShapes.forEach((O,V)=>{O.drawCustomShape(this.blending?this.blendProgress:1,T,this.presetEquationRunner,this.preset.shapes[V],this.prevTexture)}),this.preset.waves&&this.preset.waves.length>0&&this.customWaveforms.forEach((O,V)=>{O.drawCustomWaveform(this.blending?this.blendProgress:1,this.audio.timeArrayL,this.audio.timeArrayR,this.audio.freqArrayL,this.audio.freqArrayR,T,this.presetEquationRunner,this.preset.waves[V])}),this.blending&&(this.prevPreset.shapes&&this.prevPreset.shapes.length>0&&this.prevCustomShapes.forEach((O,V)=>{O.drawCustomShape(1-this.blendProgress,x,this.prevPresetEquationRunner,this.prevPreset.shapes[V],this.prevTexture)}),this.prevPreset.waves&&this.prevPreset.waves.length>0&&this.prevCustomWaveforms.forEach((O,V)=>{O.drawCustomWaveform(1-this.blendProgress,this.audio.timeArrayL,this.audio.timeArrayR,this.audio.freqArrayL,this.audio.freqArrayR,x,this.prevPresetEquationRunner,this.prevPreset.waves[V])})),this.basicWaveform.drawBasicWaveform(this.blending,this.blendProgress,this.audio.timeArrayL,this.audio.timeArrayR,U),this.darkenCenter.drawDarkenCenter(U);const D=[U.ob_r,U.ob_g,U.ob_b,U.ob_a];this.outerBorder.drawBorder(D,U.ob_size,0);const z=[U.ib_r,U.ib_g,U.ib_b,U.ib_a];if(this.innerBorder.drawBorder(z,U.ib_size,U.ob_size),this.supertext.startTime>=0){const O=(this.time-this.supertext.startTime)/this.supertext.duration;O>=1&&this.titleText.renderTitle(O,!0,T)}this.globalVars=T,this.mdVSFrame=I,this.mdVSFrameMixed=U,this.renderToScreen()}renderToScreen(){this.outputFXAA?this.bindFrambufferAndSetViewport(this.compFrameBuffer,this.texsizeX,this.texsizeY):this.bindFrambufferAndSetViewport(null,this.width,this.height),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.enable(this.gl.BLEND),this.gl.blendEquation(this.gl.FUNC_ADD),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);const{blurMins:b,blurMaxs:_}=C.getBlurValues(this.mdVSFrameMixed);if(this.blending?(this.prevCompShader.renderQuadTexture(!1,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,b,_,this.prevMDVSFrame,this.prevPresetEquationRunner.mdVSQAfterFrame,this.warpColor),this.compShader.renderQuadTexture(!0,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,b,_,this.mdVSFrameMixed,this.presetEquationRunner.mdVSQAfterFrame,this.warpColor)):this.compShader.renderQuadTexture(!1,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,b,_,this.mdVSFrame,this.presetEquationRunner.mdVSQAfterFrame,this.warpColor),this.supertext.startTime>=0){const T=(this.time-this.supertext.startTime)/this.supertext.duration;this.titleText.renderTitle(T,!1,this.globalVars),T>=1&&(this.supertext.startTime=-1)}this.outputFXAA&&(this.gl.bindTexture(this.gl.TEXTURE_2D,this.compTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.bindFrambufferAndSetViewport(null,this.width,this.height),this.outputShader.renderQuadTexture(this.compTexture))}launchSongTitleAnim(b){this.supertext={startTime:this.time,duration:1.7},this.titleText.generateTitleTexture(b)}toDataURL(){const b=new Uint8Array(this.texsizeX*this.texsizeY*4),_=this.gl.createFramebuffer(),T=this.gl.createTexture();this.bindFrameBufferTexture(_,T);const{blurMins:x,blurMaxs:I}=C.getBlurValues(this.mdVSFrameMixed);this.compShader.renderQuadTexture(!1,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,x,I,this.mdVSFrame,this.presetEquationRunner.mdVSQAfterFrame,this.warpColor),this.gl.readPixels(0,0,this.texsizeX,this.texsizeY,this.gl.RGBA,this.gl.UNSIGNED_BYTE,b),Array.from({length:this.texsizeY},(y,F)=>b.slice(F*this.texsizeX*4,(F+1)*this.texsizeX*4)).forEach((y,F)=>b.set(y,(this.texsizeY-F-1)*this.texsizeX*4));const U=document.createElement("canvas");U.width=this.texsizeX,U.height=this.texsizeY;const R=U.getContext("2d"),S=R.createImageData(this.texsizeX,this.texsizeY);return S.data.set(b),R.putImageData(S,0,0),this.gl.deleteTexture(T),this.gl.deleteFramebuffer(_),U.toDataURL()}warpBufferToDataURL(){const b=new Uint8Array(this.texsizeX*this.texsizeY*4);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.targetFrameBuffer),this.gl.readPixels(0,0,this.texsizeX,this.texsizeY,this.gl.RGBA,this.gl.UNSIGNED_BYTE,b);const _=document.createElement("canvas");_.width=this.texsizeX,_.height=this.texsizeY;const T=_.getContext("2d"),x=T.createImageData(this.texsizeX,this.texsizeY);return x.data.set(b),T.putImageData(x,0,0),_.toDataURL()}}},"./src/rendering/shaders/blur/blur.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return A});var l=m("./src/rendering/shaders/blur/blurVertical.js"),g=m("./src/rendering/shaders/blur/blurHorizontal.js");class A{constructor(e,s,i,a={}){this.blurLevel=e,this.blurRatios=s,this.gl=i,this.texsizeX=a.texsizeX,this.texsizeY=a.texsizeY,this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.blurHorizontalFrameBuffer=this.gl.createFramebuffer(),this.blurVerticalFrameBuffer=this.gl.createFramebuffer(),this.blurHorizontalTexture=this.gl.createTexture(),this.blurVerticalTexture=this.gl.createTexture(),this.setupFrameBufferTextures(),this.blurHorizontal=new g.default(i,this.blurLevel,a),this.blurVertical=new l.default(i,this.blurLevel,a)}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.setupFrameBufferTextures()}getTextureSize(e){let s=Math.max(this.texsizeX*e,16);s=Math.floor((s+3)/16)*16;let i=Math.max(this.texsizeY*e,16);return i=Math.floor((i+3)/4)*4,[s,i]}setupFrameBufferTextures(){const e=this.blurLevel>0?this.blurRatios[this.blurLevel-1]:[1,1],s=this.blurRatios[this.blurLevel],i=this.getTextureSize(e[1]),a=this.getTextureSize(s[0]);this.bindFrameBufferTexture(this.blurHorizontalFrameBuffer,this.blurHorizontalTexture,a);const h=a,n=this.getTextureSize(s[1]);this.bindFrameBufferTexture(this.blurVerticalFrameBuffer,this.blurVerticalTexture,n),this.horizontalTexsizes=[i,a],this.verticalTexsizes=[h,n]}bindFrambufferAndSetViewport(e,s){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e),this.gl.viewport(0,0,s[0],s[1])}bindFrameBufferTexture(e,s,i){if(this.gl.bindTexture(this.gl.TEXTURE_2D,s),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,i[0],i[1],0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array(i[0]*i[1]*4)),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const a=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,a)}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,s,0)}renderBlurTexture(e,s,i,a){this.bindFrambufferAndSetViewport(this.blurHorizontalFrameBuffer,this.horizontalTexsizes[1]),this.blurHorizontal.renderQuadTexture(e,s,i,a,this.horizontalTexsizes[0]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.blurHorizontalTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.bindFrambufferAndSetViewport(this.blurVerticalFrameBuffer,this.verticalTexsizes[1]),this.blurVertical.renderQuadTexture(this.blurHorizontalTexture,s,this.verticalTexsizes[0]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.blurVerticalTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D)}}},"./src/rendering/shaders/blur/blurHorizontal.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return g});var l=m("./src/rendering/shaders/shaderUtils.js");class g{constructor(t,e){this.gl=t,this.blurLevel=e;const s=[4,3.8,3.5,2.9,1.9,1.2,.7,.3],i=s[0]+s[1],a=s[2]+s[3],h=s[4]+s[5],n=s[6]+s[7],r=0+2*s[1]/i,u=2+2*s[3]/a,v=4+2*s[5]/h,c=6+2*s[7]/n;this.ws=new Float32Array([i,a,h,n]),this.ds=new Float32Array([r,u,v,c]),this.wDiv=.5/(i+a+h+n),this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=l.default.getFragmentFloatPrecision(this.gl),this.createShader()}createShader(){this.shaderProgram=this.gl.createProgram();const t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`
      #version 300 es
      const vec2 halfmad = vec2(0.5);
      in vec2 aPos;
      out vec2 uv;
      void main(void) {
        gl_Position = vec4(aPos, 0.0, 1.0);
        uv = aPos * halfmad + halfmad;
      }
      `.trim()),this.gl.compileShader(t);const e=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(e,`#version 300 es
       precision ${this.floatPrecision} float;
       precision highp int;
       precision mediump sampler2D;

       in vec2 uv;
       out vec4 fragColor;
       uniform sampler2D uTexture;
       uniform vec4 texsize;
       uniform float scale;
       uniform float bias;
       uniform vec4 ws;
       uniform vec4 ds;
       uniform float wdiv;

       void main(void) {
         float w1 = ws[0];
         float w2 = ws[1];
         float w3 = ws[2];
         float w4 = ws[3];
         float d1 = ds[0];
         float d2 = ds[1];
         float d3 = ds[2];
         float d4 = ds[3];

         vec2 uv2 = uv.xy;

         vec3 blur =
           ( texture(uTexture, uv2 + vec2( d1 * texsize.z,0.0) ).xyz
           + texture(uTexture, uv2 + vec2(-d1 * texsize.z,0.0) ).xyz) * w1 +
           ( texture(uTexture, uv2 + vec2( d2 * texsize.z,0.0) ).xyz
           + texture(uTexture, uv2 + vec2(-d2 * texsize.z,0.0) ).xyz) * w2 +
           ( texture(uTexture, uv2 + vec2( d3 * texsize.z,0.0) ).xyz
           + texture(uTexture, uv2 + vec2(-d3 * texsize.z,0.0) ).xyz) * w3 +
           ( texture(uTexture, uv2 + vec2( d4 * texsize.z,0.0) ).xyz
           + texture(uTexture, uv2 + vec2(-d4 * texsize.z,0.0) ).xyz) * w4;

         blur.xyz *= wdiv;
         blur.xyz = blur.xyz * scale + bias;

         fragColor = vec4(blur, 1.0);
       }`),this.gl.compileShader(e),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,e),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.texsizeLocation=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.scaleLoc=this.gl.getUniformLocation(this.shaderProgram,"scale"),this.biasLoc=this.gl.getUniformLocation(this.shaderProgram,"bias"),this.wsLoc=this.gl.getUniformLocation(this.shaderProgram,"ws"),this.dsLocation=this.gl.getUniformLocation(this.shaderProgram,"ds"),this.wdivLoc=this.gl.getUniformLocation(this.shaderProgram,"wdiv")}getScaleAndBias(t,e){const s=[1,1,1],i=[0,0,0];let a,h;return s[0]=1/(e[0]-t[0]),i[0]=-t[0]*s[0],a=(t[1]-t[0])/(e[0]-t[0]),h=(e[1]-t[0])/(e[0]-t[0]),s[1]=1/(h-a),i[1]=-a*s[1],a=(t[2]-t[1])/(e[1]-t[1]),h=(e[2]-t[1])/(e[1]-t[1]),s[2]=1/(h-a),i[2]=-a*s[2],{scale:s[this.blurLevel],bias:i[this.blurLevel]}}renderQuadTexture(t,e,s,i,a){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.uniform1i(this.textureLoc,0);const{scale:h,bias:n}=this.getScaleAndBias(s,i);this.gl.uniform4fv(this.texsizeLocation,[a[0],a[1],1/a[0],1/a[1]]),this.gl.uniform1f(this.scaleLoc,h),this.gl.uniform1f(this.biasLoc,n),this.gl.uniform4fv(this.wsLoc,this.ws),this.gl.uniform4fv(this.dsLocation,this.ds),this.gl.uniform1f(this.wdivLoc,this.wDiv),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}},"./src/rendering/shaders/blur/blurVertical.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return g});var l=m("./src/rendering/shaders/shaderUtils.js");class g{constructor(t,e){this.gl=t,this.blurLevel=e;const s=[4,3.8,3.5,2.9,1.9,1.2,.7,.3],i=s[0]+s[1]+s[2]+s[3],a=s[4]+s[5]+s[6]+s[7],h=0+2*((s[2]+s[3])/i),n=2+2*((s[6]+s[7])/a);this.wds=new Float32Array([i,a,h,n]),this.wDiv=1/((i+a)*2),this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=l.default.getFragmentFloatPrecision(this.gl),this.createShader()}createShader(){this.shaderProgram=this.gl.createProgram();const t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`
      #version 300 es
      const vec2 halfmad = vec2(0.5);
      in vec2 aPos;
      out vec2 uv;
      void main(void) {
        gl_Position = vec4(aPos, 0.0, 1.0);
        uv = aPos * halfmad + halfmad;
      }
      `.trim()),this.gl.compileShader(t);const e=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(e,`#version 300 es
       precision ${this.floatPrecision} float;
       precision highp int;
       precision mediump sampler2D;

       in vec2 uv;
       out vec4 fragColor;
       uniform sampler2D uTexture;
       uniform vec4 texsize;
       uniform float ed1;
       uniform float ed2;
       uniform float ed3;
       uniform vec4 wds;
       uniform float wdiv;

       void main(void) {
         float w1 = wds[0];
         float w2 = wds[1];
         float d1 = wds[2];
         float d2 = wds[3];

         vec2 uv2 = uv.xy;

         vec3 blur =
           ( texture(uTexture, uv2 + vec2(0.0, d1 * texsize.w) ).xyz
           + texture(uTexture, uv2 + vec2(0.0,-d1 * texsize.w) ).xyz) * w1 +
           ( texture(uTexture, uv2 + vec2(0.0, d2 * texsize.w) ).xyz
           + texture(uTexture, uv2 + vec2(0.0,-d2 * texsize.w) ).xyz) * w2;

         blur.xyz *= wdiv;

         float t = min(min(uv.x, uv.y), 1.0 - max(uv.x, uv.y));
         t = sqrt(t);
         t = ed1 + ed2 * clamp(t * ed3, 0.0, 1.0);
         blur.xyz *= t;

         fragColor = vec4(blur, 1.0);
       }`),this.gl.compileShader(e),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,e),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.texsizeLocation=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.ed1Loc=this.gl.getUniformLocation(this.shaderProgram,"ed1"),this.ed2Loc=this.gl.getUniformLocation(this.shaderProgram,"ed2"),this.ed3Loc=this.gl.getUniformLocation(this.shaderProgram,"ed3"),this.wdsLocation=this.gl.getUniformLocation(this.shaderProgram,"wds"),this.wdivLoc=this.gl.getUniformLocation(this.shaderProgram,"wdiv")}renderQuadTexture(t,e,s){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.uniform1i(this.textureLoc,0);const i=this.blurLevel===0?e.b1ed:0;this.gl.uniform4fv(this.texsizeLocation,[s[0],s[1],1/s[0],1/s[1]]),this.gl.uniform1f(this.ed1Loc,1-i),this.gl.uniform1f(this.ed2Loc,i),this.gl.uniform1f(this.ed3Loc,5),this.gl.uniform4fv(this.wdsLocation,this.wds),this.gl.uniform1f(this.wdivLoc,this.wDiv),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}},"./src/rendering/shaders/comp.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return g});var l=m("./src/rendering/shaders/shaderUtils.js");class g{constructor(t,e,s,i={}){this.gl=t,this.noise=e,this.image=s,this.mesh_width=i.mesh_width,this.mesh_height=i.mesh_height,this.texsizeX=i.texsizeX,this.texsizeY=i.texsizeY,this.aspectx=i.aspectx,this.aspecty=i.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.compWidth=32,this.compHeight=24,this.buildPositions(),this.indexBuf=t.createBuffer(),this.positionVertexBuf=this.gl.createBuffer(),this.compColorVertexBuf=this.gl.createBuffer(),this.floatPrecision=l.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.mainSampler=this.gl.createSampler(),this.mainSamplerFW=this.gl.createSampler(),this.mainSamplerFC=this.gl.createSampler(),this.mainSamplerPW=this.gl.createSampler(),this.mainSamplerPC=this.gl.createSampler(),t.samplerParameteri(this.mainSampler,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.samplerParameteri(this.mainSampler,t.TEXTURE_MAG_FILTER,t.LINEAR),t.samplerParameteri(this.mainSampler,t.TEXTURE_WRAP_S,t.REPEAT),t.samplerParameteri(this.mainSampler,t.TEXTURE_WRAP_T,t.REPEAT),t.samplerParameteri(this.mainSamplerFW,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.samplerParameteri(this.mainSamplerFW,t.TEXTURE_MAG_FILTER,t.LINEAR),t.samplerParameteri(this.mainSamplerFW,t.TEXTURE_WRAP_S,t.REPEAT),t.samplerParameteri(this.mainSamplerFW,t.TEXTURE_WRAP_T,t.REPEAT),t.samplerParameteri(this.mainSamplerFC,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.samplerParameteri(this.mainSamplerFC,t.TEXTURE_MAG_FILTER,t.LINEAR),t.samplerParameteri(this.mainSamplerFC,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.samplerParameteri(this.mainSamplerFC,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.samplerParameteri(this.mainSamplerPW,t.TEXTURE_MIN_FILTER,t.NEAREST_MIPMAP_NEAREST),t.samplerParameteri(this.mainSamplerPW,t.TEXTURE_MAG_FILTER,t.NEAREST),t.samplerParameteri(this.mainSamplerPW,t.TEXTURE_WRAP_S,t.REPEAT),t.samplerParameteri(this.mainSamplerPW,t.TEXTURE_WRAP_T,t.REPEAT),t.samplerParameteri(this.mainSamplerPC,t.TEXTURE_MIN_FILTER,t.NEAREST_MIPMAP_NEAREST),t.samplerParameteri(this.mainSamplerPC,t.TEXTURE_MAG_FILTER,t.NEAREST),t.samplerParameteri(this.mainSamplerPC,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.samplerParameteri(this.mainSamplerPC,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)}buildPositions(){const a=this.compWidth,h=this.compHeight,n=a+1,r=h+1,u=2/a,v=2/h,c=[];for(let o=0;o<r;o++){const p=o*v-1;for(let d=0;d<n;d++){const P=d*u-1;c.push(P,-p,0)}}const f=[];for(let o=0;o<h;o++)for(let p=0;p<a;p++){const d=p+n*o,P=p+n*(o+1),X=p+1+n*(o+1),M=p+1+n*o;f.push(d,P,M),f.push(P,X,M)}this.vertices=new Float32Array(c),this.indices=new Uint16Array(f)}updateGlobals(t){this.mesh_width=t.mesh_width,this.mesh_height=t.mesh_height,this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions()}createShader(t=""){let e,s;if(t.length===0)e=`float orient_horiz = mod(echo_orientation, 2.0);
                        float orient_x = (orient_horiz != 0.0) ? -1.0 : 1.0;
                        float orient_y = (echo_orientation >= 2.0) ? -1.0 : 1.0;
                        vec2 uv_echo = ((uv - 0.5) *
                                        (1.0 / echo_zoom) *
                                        vec2(orient_x, orient_y)) + 0.5;

                        ret = mix(texture(sampler_main, uv).rgb,
                                  texture(sampler_main, uv_echo).rgb,
                                  echo_alpha);

                        ret *= gammaAdj;

                        if(fShader >= 1.0) {
                          ret *= hue_shader;
                        } else if(fShader > 0.001) {
                          ret *= (1.0 - fShader) + (fShader * hue_shader);
                        }

                        if(brighten != 0) ret = sqrt(ret);
                        if(darken != 0) ret = ret*ret;
                        if(solarize != 0) ret = ret * (1.0 - ret) * 4.0;
                        if(invert != 0) ret = 1.0 - ret;`,s="";else{const h=l.default.getShaderParts(t);s=h[0],e=h[1]}e=e.replace(/texture2D/g,"texture"),e=e.replace(/texture3D/g,"texture"),this.userTextures=l.default.getUserSamplers(s),this.shaderProgram=this.gl.createProgram();const i=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(i,`
      #version 300 es
      const vec2 halfmad = vec2(0.5);
      in vec2 aPos;
      in vec4 aCompColor;
      out vec2 vUv;
      out vec4 vColor;
      void main(void) {
        gl_Position = vec4(aPos, 0.0, 1.0);
        vUv = aPos * halfmad + halfmad;
        vColor = aCompColor;
      }
      `.trim()),this.gl.compileShader(i);const a=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(a,`
      #version 300 es
      precision ${this.floatPrecision} float;
      precision highp int;
      precision mediump sampler2D;
      precision mediump sampler3D;

      vec3 lum(vec3 v){
          return vec3(dot(v, vec3(0.32,0.49,0.29)));
      }

      in vec2 vUv;
      in vec4 vColor;
      out vec4 fragColor;
      uniform sampler2D sampler_main;
      uniform sampler2D sampler_fw_main;
      uniform sampler2D sampler_fc_main;
      uniform sampler2D sampler_pw_main;
      uniform sampler2D sampler_pc_main;
      uniform sampler2D sampler_blur1;
      uniform sampler2D sampler_blur2;
      uniform sampler2D sampler_blur3;
      uniform sampler2D sampler_noise_lq;
      uniform sampler2D sampler_noise_lq_lite;
      uniform sampler2D sampler_noise_mq;
      uniform sampler2D sampler_noise_hq;
      uniform sampler2D sampler_pw_noise_lq;
      uniform sampler3D sampler_noisevol_lq;
      uniform sampler3D sampler_noisevol_hq;

      uniform float time;
      uniform float gammaAdj;
      uniform float echo_zoom;
      uniform float echo_alpha;
      uniform float echo_orientation;
      uniform int invert;
      uniform int brighten;
      uniform int darken;
      uniform int solarize;
      uniform vec2 resolution;
      uniform vec4 aspect;
      uniform vec4 texsize;
      uniform vec4 texsize_noise_lq;
      uniform vec4 texsize_noise_mq;
      uniform vec4 texsize_noise_hq;
      uniform vec4 texsize_noise_lq_lite;
      uniform vec4 texsize_noisevol_lq;
      uniform vec4 texsize_noisevol_hq;

      uniform float bass;
      uniform float mid;
      uniform float treb;
      uniform float vol;
      uniform float bass_att;
      uniform float mid_att;
      uniform float treb_att;
      uniform float vol_att;

      uniform float frame;
      uniform float fps;

      uniform vec4 _qa;
      uniform vec4 _qb;
      uniform vec4 _qc;
      uniform vec4 _qd;
      uniform vec4 _qe;
      uniform vec4 _qf;
      uniform vec4 _qg;
      uniform vec4 _qh;

      #define q1 _qa.x
      #define q2 _qa.y
      #define q3 _qa.z
      #define q4 _qa.w
      #define q5 _qb.x
      #define q6 _qb.y
      #define q7 _qb.z
      #define q8 _qb.w
      #define q9 _qc.x
      #define q10 _qc.y
      #define q11 _qc.z
      #define q12 _qc.w
      #define q13 _qd.x
      #define q14 _qd.y
      #define q15 _qd.z
      #define q16 _qd.w
      #define q17 _qe.x
      #define q18 _qe.y
      #define q19 _qe.z
      #define q20 _qe.w
      #define q21 _qf.x
      #define q22 _qf.y
      #define q23 _qf.z
      #define q24 _qf.w
      #define q25 _qg.x
      #define q26 _qg.y
      #define q27 _qg.z
      #define q28 _qg.w
      #define q29 _qh.x
      #define q30 _qh.y
      #define q31 _qh.z
      #define q32 _qh.w

      uniform vec4 slow_roam_cos;
      uniform vec4 roam_cos;
      uniform vec4 slow_roam_sin;
      uniform vec4 roam_sin;

      uniform float blur1_min;
      uniform float blur1_max;
      uniform float blur2_min;
      uniform float blur2_max;
      uniform float blur3_min;
      uniform float blur3_max;

      uniform float scale1;
      uniform float scale2;
      uniform float scale3;
      uniform float bias1;
      uniform float bias2;
      uniform float bias3;

      uniform vec4 rand_frame;
      uniform vec4 rand_preset;

      uniform float fShader;

      float PI = ${Math.PI};

      ${s}

      void main(void) {
        vec3 ret;
        vec2 uv = vUv;
        vec2 uv_orig = vUv;
        uv.y = 1.0 - uv.y;
        uv_orig.y = 1.0 - uv_orig.y;
        float rad = length(uv - 0.5);
        float ang = atan(uv.x - 0.5, uv.y - 0.5);
        vec3 hue_shader = vColor.rgb;

        ${e}

        fragColor = vec4(ret, vColor.a);
      }
      `.trim()),this.gl.compileShader(a),this.gl.attachShader(this.shaderProgram,i),this.gl.attachShader(this.shaderProgram,a),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.compColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aCompColor"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_main"),this.textureFWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fw_main"),this.textureFCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fc_main"),this.texturePWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_main"),this.texturePCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pc_main"),this.blurTexture1Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur1"),this.blurTexture2Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur2"),this.blurTexture3Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur3"),this.noiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq"),this.noiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_mq"),this.noiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_hq"),this.noiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq_lite"),this.noisePointLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_noise_lq"),this.noiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_lq"),this.noiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_hq"),this.timeLoc=this.gl.getUniformLocation(this.shaderProgram,"time"),this.gammaAdjLoc=this.gl.getUniformLocation(this.shaderProgram,"gammaAdj"),this.echoZoomLoc=this.gl.getUniformLocation(this.shaderProgram,"echo_zoom"),this.echoAlphaLoc=this.gl.getUniformLocation(this.shaderProgram,"echo_alpha"),this.echoOrientationLoc=this.gl.getUniformLocation(this.shaderProgram,"echo_orientation"),this.invertLoc=this.gl.getUniformLocation(this.shaderProgram,"invert"),this.brightenLoc=this.gl.getUniformLocation(this.shaderProgram,"brighten"),this.darkenLoc=this.gl.getUniformLocation(this.shaderProgram,"darken"),this.solarizeLoc=this.gl.getUniformLocation(this.shaderProgram,"solarize"),this.texsizeLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.texsizeNoiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq"),this.texsizeNoiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_mq"),this.texsizeNoiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_hq"),this.texsizeNoiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq_lite"),this.texsizeNoiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_lq"),this.texsizeNoiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_hq"),this.resolutionLoc=this.gl.getUniformLocation(this.shaderProgram,"resolution"),this.aspectLoc=this.gl.getUniformLocation(this.shaderProgram,"aspect"),this.bassLoc=this.gl.getUniformLocation(this.shaderProgram,"bass"),this.midLoc=this.gl.getUniformLocation(this.shaderProgram,"mid"),this.trebLoc=this.gl.getUniformLocation(this.shaderProgram,"treb"),this.volLoc=this.gl.getUniformLocation(this.shaderProgram,"vol"),this.bassAttLoc=this.gl.getUniformLocation(this.shaderProgram,"bass_att"),this.midAttLoc=this.gl.getUniformLocation(this.shaderProgram,"mid_att"),this.trebAttLoc=this.gl.getUniformLocation(this.shaderProgram,"treb_att"),this.volAttLoc=this.gl.getUniformLocation(this.shaderProgram,"vol_att"),this.frameLoc=this.gl.getUniformLocation(this.shaderProgram,"frame"),this.fpsLoc=this.gl.getUniformLocation(this.shaderProgram,"fps"),this.blur1MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_min"),this.blur1MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_max"),this.blur2MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_min"),this.blur2MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_max"),this.blur3MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_min"),this.blur3MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_max"),this.scale1Loc=this.gl.getUniformLocation(this.shaderProgram,"scale1"),this.scale2Loc=this.gl.getUniformLocation(this.shaderProgram,"scale2"),this.scale3Loc=this.gl.getUniformLocation(this.shaderProgram,"scale3"),this.bias1Loc=this.gl.getUniformLocation(this.shaderProgram,"bias1"),this.bias2Loc=this.gl.getUniformLocation(this.shaderProgram,"bias2"),this.bias3Loc=this.gl.getUniformLocation(this.shaderProgram,"bias3"),this.randPresetLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_preset"),this.randFrameLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_frame"),this.fShaderLoc=this.gl.getUniformLocation(this.shaderProgram,"fShader"),this.qaLoc=this.gl.getUniformLocation(this.shaderProgram,"_qa"),this.qbLoc=this.gl.getUniformLocation(this.shaderProgram,"_qb"),this.qcLoc=this.gl.getUniformLocation(this.shaderProgram,"_qc"),this.qdLoc=this.gl.getUniformLocation(this.shaderProgram,"_qd"),this.qeLoc=this.gl.getUniformLocation(this.shaderProgram,"_qe"),this.qfLoc=this.gl.getUniformLocation(this.shaderProgram,"_qf"),this.qgLoc=this.gl.getUniformLocation(this.shaderProgram,"_qg"),this.qhLoc=this.gl.getUniformLocation(this.shaderProgram,"_qh"),this.slowRoamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_cos"),this.roamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_cos"),this.slowRoamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_sin"),this.roamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_sin");for(let h=0;h<this.userTextures.length;h++){const n=this.userTextures[h];n.textureLoc=this.gl.getUniformLocation(this.shaderProgram,`sampler_${n.sampler}`)}}updateShader(t){this.createShader(t)}bindBlurVals(t,e){const s=t[0],i=t[1],a=t[2],h=e[0],n=e[1],r=e[2],u=h-s,v=s,c=n-i,f=i,o=r-a,p=a;this.gl.uniform1f(this.blur1MinLoc,s),this.gl.uniform1f(this.blur1MaxLoc,h),this.gl.uniform1f(this.blur2MinLoc,i),this.gl.uniform1f(this.blur2MaxLoc,n),this.gl.uniform1f(this.blur3MinLoc,a),this.gl.uniform1f(this.blur3MaxLoc,r),this.gl.uniform1f(this.scale1Loc,u),this.gl.uniform1f(this.scale2Loc,c),this.gl.uniform1f(this.scale3Loc,o),this.gl.uniform1f(this.bias1Loc,v),this.gl.uniform1f(this.bias2Loc,f),this.gl.uniform1f(this.bias3Loc,p)}static generateHueBase(t){const e=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1]);for(let s=0;s<4;s++){e[s*3+0]=.6+.3*Math.sin(t.time*30*.0143+3+s*21+t.rand_start[3]),e[s*3+1]=.6+.3*Math.sin(t.time*30*.0107+1+s*13+t.rand_start[1]),e[s*3+2]=.6+.3*Math.sin(t.time*30*.0129+6+s*9+t.rand_start[2]);const i=Math.max(e[s*3],e[s*3+1],e[s*3+2]);for(let a=0;a<3;a++)e[s*3+a]=e[s*3+a]/i,e[s*3+a]=.5+.5*e[s*3+a]}return e}generateCompColors(t,e,s){const i=g.generateHueBase(e),a=this.compWidth+1,h=this.compHeight+1,n=new Float32Array(a*h*4);let r=0;for(let u=0;u<h;u++)for(let v=0;v<a;v++){let c=v/this.compWidth,f=u/this.compHeight;const o=[1,1,1];for(let d=0;d<3;d++)o[d]=i[0+d]*c*f+i[3+d]*(1-c)*f+i[6+d]*c*(1-f)+i[9+d]*(1-c)*(1-f);let p=1;if(t){c*=this.mesh_width+1,f*=this.mesh_height+1,c=Math.clamp(c,0,this.mesh_width-1),f=Math.clamp(f,0,this.mesh_height-1);const d=Math.floor(c),P=Math.floor(f),X=c-d,M=f-P,C=s[(P*(this.mesh_width+1)+d)*4+3],w=s[(P*(this.mesh_width+1)+(d+1))*4+3],b=s[((P+1)*(this.mesh_width+1)+d)*4+3],_=s[((P+1)*(this.mesh_width+1)+(d+1))*4+3];p=C*(1-X)*(1-M)+w*X*(1-M)+b*(1-X)*M+_*X*M}n[r+0]=o[0],n[r+1]=o[1],n[r+2]=o[2],n[r+3]=p,r+=4}return n}renderQuadTexture(t,e,s,i,a,h,n,r,u,v){const c=this.generateCompColors(t,r,v);this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuf),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.indices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.compColorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,c,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.compColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.compColorLocation);const f=r.wrap!==0?this.gl.REPEAT:this.gl.CLAMP_TO_EDGE;this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_S,f),this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_T,f),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(0,this.mainSampler),this.gl.uniform1i(this.textureLoc,0),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(1,this.mainSamplerFW),this.gl.uniform1i(this.textureFWLoc,1),this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(2,this.mainSamplerFC),this.gl.uniform1i(this.textureFCLoc,2),this.gl.activeTexture(this.gl.TEXTURE3),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(3,this.mainSamplerPW),this.gl.uniform1i(this.texturePWLoc,3),this.gl.activeTexture(this.gl.TEXTURE4),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(4,this.mainSamplerPC),this.gl.uniform1i(this.texturePCLoc,4),this.gl.activeTexture(this.gl.TEXTURE5),this.gl.bindTexture(this.gl.TEXTURE_2D,s),this.gl.uniform1i(this.blurTexture1Loc,5),this.gl.activeTexture(this.gl.TEXTURE6),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.uniform1i(this.blurTexture2Loc,6),this.gl.activeTexture(this.gl.TEXTURE7),this.gl.bindTexture(this.gl.TEXTURE_2D,a),this.gl.uniform1i(this.blurTexture3Loc,7),this.gl.activeTexture(this.gl.TEXTURE8),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.uniform1i(this.noiseLQLoc,8),this.gl.activeTexture(this.gl.TEXTURE9),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexMQ),this.gl.uniform1i(this.noiseMQLoc,9),this.gl.activeTexture(this.gl.TEXTURE10),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexHQ),this.gl.uniform1i(this.noiseHQLoc,10),this.gl.activeTexture(this.gl.TEXTURE11),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQLite),this.gl.uniform1i(this.noiseLQLiteLoc,11),this.gl.activeTexture(this.gl.TEXTURE12),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.bindSampler(12,this.noise.noiseTexPointLQ),this.gl.uniform1i(this.noisePointLQLoc,12),this.gl.activeTexture(this.gl.TEXTURE13),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolLQ),this.gl.uniform1i(this.noiseVolLQLoc,13),this.gl.activeTexture(this.gl.TEXTURE14),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolHQ),this.gl.uniform1i(this.noiseVolHQLoc,14);for(let o=0;o<this.userTextures.length;o++){const p=this.userTextures[o];this.gl.activeTexture(this.gl.TEXTURE15+o),this.gl.bindTexture(this.gl.TEXTURE_2D,this.image.getTexture(p.sampler)),this.gl.uniform1i(p.textureLoc,15+o)}this.gl.uniform1f(this.timeLoc,r.time),this.gl.uniform1f(this.gammaAdjLoc,r.gammaadj),this.gl.uniform1f(this.echoZoomLoc,r.echo_zoom),this.gl.uniform1f(this.echoAlphaLoc,r.echo_alpha),this.gl.uniform1f(this.echoOrientationLoc,r.echo_orient),this.gl.uniform1i(this.invertLoc,r.invert),this.gl.uniform1i(this.brightenLoc,r.brighten),this.gl.uniform1i(this.darkenLoc,r.darken),this.gl.uniform1i(this.solarizeLoc,r.solarize),this.gl.uniform2fv(this.resolutionLoc,[this.texsizeX,this.texsizeY]),this.gl.uniform4fv(this.aspectLoc,[this.aspectx,this.aspecty,this.invAspectx,this.invAspecty]),this.gl.uniform4fv(this.texsizeLoc,new Float32Array([this.texsizeX,this.texsizeY,1/this.texsizeX,1/this.texsizeY])),this.gl.uniform4fv(this.texsizeNoiseLQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseMQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseHQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseLQLiteLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolLQLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolHQLoc,[32,32,1/32,1/32]),this.gl.uniform1f(this.bassLoc,r.bass),this.gl.uniform1f(this.midLoc,r.mid),this.gl.uniform1f(this.trebLoc,r.treb),this.gl.uniform1f(this.volLoc,(r.bass+r.mid+r.treb)/3),this.gl.uniform1f(this.bassAttLoc,r.bass_att),this.gl.uniform1f(this.midAttLoc,r.mid_att),this.gl.uniform1f(this.trebAttLoc,r.treb_att),this.gl.uniform1f(this.volAttLoc,(r.bass_att+r.mid_att+r.treb_att)/3),this.gl.uniform1f(this.frameLoc,r.frame),this.gl.uniform1f(this.fpsLoc,r.fps),this.gl.uniform4fv(this.randPresetLoc,r.rand_preset),this.gl.uniform4fv(this.randFrameLoc,new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()])),this.gl.uniform1f(this.fShaderLoc,r.fshader),this.gl.uniform4fv(this.qaLoc,new Float32Array([u.q1||0,u.q2||0,u.q3||0,u.q4||0])),this.gl.uniform4fv(this.qbLoc,new Float32Array([u.q5||0,u.q6||0,u.q7||0,u.q8||0])),this.gl.uniform4fv(this.qcLoc,new Float32Array([u.q9||0,u.q10||0,u.q11||0,u.q12||0])),this.gl.uniform4fv(this.qdLoc,new Float32Array([u.q13||0,u.q14||0,u.q15||0,u.q16||0])),this.gl.uniform4fv(this.qeLoc,new Float32Array([u.q17||0,u.q18||0,u.q19||0,u.q20||0])),this.gl.uniform4fv(this.qfLoc,new Float32Array([u.q21||0,u.q22||0,u.q23||0,u.q24||0])),this.gl.uniform4fv(this.qgLoc,new Float32Array([u.q25||0,u.q26||0,u.q27||0,u.q28||0])),this.gl.uniform4fv(this.qhLoc,new Float32Array([u.q29||0,u.q30||0,u.q31||0,u.q32||0])),this.gl.uniform4fv(this.slowRoamCosLoc,[.5+.5*Math.cos(r.time*.005),.5+.5*Math.cos(r.time*.008),.5+.5*Math.cos(r.time*.013),.5+.5*Math.cos(r.time*.022)]),this.gl.uniform4fv(this.roamCosLoc,[.5+.5*Math.cos(r.time*.3),.5+.5*Math.cos(r.time*1.3),.5+.5*Math.cos(r.time*5),.5+.5*Math.cos(r.time*20)]),this.gl.uniform4fv(this.slowRoamSinLoc,[.5+.5*Math.sin(r.time*.005),.5+.5*Math.sin(r.time*.008),.5+.5*Math.sin(r.time*.013),.5+.5*Math.sin(r.time*.022)]),this.gl.uniform4fv(this.roamSinLoc,[.5+.5*Math.sin(r.time*.3),.5+.5*Math.sin(r.time*1.3),.5+.5*Math.sin(r.time*5),.5+.5*Math.sin(r.time*20)]),this.bindBlurVals(h,n),t?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA):this.gl.disable(this.gl.BLEND),this.gl.drawElements(this.gl.TRIANGLES,this.indices.length,this.gl.UNSIGNED_SHORT,0),t||this.gl.enable(this.gl.BLEND)}}},"./src/rendering/shaders/output.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return g});var l=m("./src/rendering/shaders/shaderUtils.js");class g{constructor(t,e){this.gl=t,this.textureRatio=e.textureRatio,this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=l.default.getFragmentFloatPrecision(this.gl),this.useFXAA()?this.createFXAAShader():this.createShader()}useFXAA(){return this.textureRatio<=1}updateGlobals(t){this.textureRatio=t.textureRatio,this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.gl.deleteProgram(this.shaderProgram),this.useFXAA()?this.createFXAAShader():this.createShader()}createFXAAShader(){this.shaderProgram=this.gl.createProgram();const t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`#version 300 es
       const vec2 halfmad = vec2(0.5);
       in vec2 aPos;
       out vec2 v_rgbM;
       out vec2 v_rgbNW;
       out vec2 v_rgbNE;
       out vec2 v_rgbSW;
       out vec2 v_rgbSE;
       uniform vec4 texsize;
       void main(void) {
         gl_Position = vec4(aPos, 0.0, 1.0);

         v_rgbM = aPos * halfmad + halfmad;
         v_rgbNW = v_rgbM + (vec2(-1.0, -1.0) * texsize.zx);
         v_rgbNE = v_rgbM + (vec2(1.0, -1.0) * texsize.zx);
         v_rgbSW = v_rgbM + (vec2(-1.0, 1.0) * texsize.zx);
         v_rgbSE = v_rgbM + (vec2(1.0, 1.0) * texsize.zx);
       }`),this.gl.compileShader(t);const e=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(e,`#version 300 es
       precision ${this.floatPrecision} float;
       precision highp int;
       precision mediump sampler2D;

       in vec2 v_rgbM;
       in vec2 v_rgbNW;
       in vec2 v_rgbNE;
       in vec2 v_rgbSW;
       in vec2 v_rgbSE;
       out vec4 fragColor;
       uniform vec4 texsize;
       uniform sampler2D uTexture;

       #ifndef FXAA_REDUCE_MIN
         #define FXAA_REDUCE_MIN   (1.0/ 128.0)
       #endif
       #ifndef FXAA_REDUCE_MUL
         #define FXAA_REDUCE_MUL   (1.0 / 8.0)
       #endif
       #ifndef FXAA_SPAN_MAX
         #define FXAA_SPAN_MAX     8.0
       #endif

       void main(void) {
         vec4 color;
         vec3 rgbNW = textureLod(uTexture, v_rgbNW, 0.0).xyz;
         vec3 rgbNE = textureLod(uTexture, v_rgbNE, 0.0).xyz;
         vec3 rgbSW = textureLod(uTexture, v_rgbSW, 0.0).xyz;
         vec3 rgbSE = textureLod(uTexture, v_rgbSE, 0.0).xyz;
         vec3 rgbM  = textureLod(uTexture, v_rgbM, 0.0).xyz;
         vec3 luma = vec3(0.299, 0.587, 0.114);
         float lumaNW = dot(rgbNW, luma);
         float lumaNE = dot(rgbNE, luma);
         float lumaSW = dot(rgbSW, luma);
         float lumaSE = dot(rgbSE, luma);
         float lumaM  = dot(rgbM,  luma);
         float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
         float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

         mediump vec2 dir;
         dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
         dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

         float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                               (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

         float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
         dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
                   max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                   dir * rcpDirMin)) * texsize.zw;

         vec3 rgbA = 0.5 * (
             textureLod(uTexture, v_rgbM + dir * (1.0 / 3.0 - 0.5), 0.0).xyz +
             textureLod(uTexture, v_rgbM + dir * (2.0 / 3.0 - 0.5), 0.0).xyz);
         vec3 rgbB = rgbA * 0.5 + 0.25 * (
             textureLod(uTexture, v_rgbM + dir * -0.5, 0.0).xyz +
             textureLod(uTexture, v_rgbM + dir * 0.5, 0.0).xyz);

         float lumaB = dot(rgbB, luma);
         if ((lumaB < lumaMin) || (lumaB > lumaMax))
           color = vec4(rgbA, 1.0);
         else
           color = vec4(rgbB, 1.0);

         fragColor = color;
       }`),this.gl.compileShader(e),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,e),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.texsizeLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize")}createShader(){this.shaderProgram=this.gl.createProgram();const t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`#version 300 es
       const vec2 halfmad = vec2(0.5);
       in vec2 aPos;
       out vec2 uv;
       void main(void) {
         gl_Position = vec4(aPos, 0.0, 1.0);
         uv = aPos * halfmad + halfmad;
       }`),this.gl.compileShader(t);const e=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(e,`#version 300 es
       precision ${this.floatPrecision} float;
       precision highp int;
       precision mediump sampler2D;

       in vec2 uv;
       out vec4 fragColor;
       uniform sampler2D uTexture;

       void main(void) {
         fragColor = vec4(texture(uTexture, uv).rgb, 1.0);
       }`),this.gl.compileShader(e),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,e),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture")}renderQuadTexture(t){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.uniform1i(this.textureLoc,0),this.useFXAA()&&this.gl.uniform4fv(this.texsizeLoc,new Float32Array([this.texsizeX,this.texsizeY,1/this.texsizeX,1/this.texsizeY])),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}},"./src/rendering/shaders/resample.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return g});var l=m("./src/rendering/shaders/shaderUtils.js");class g{constructor(t){this.gl=t,this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=l.default.getFragmentFloatPrecision(this.gl),this.createShader()}createShader(){this.shaderProgram=this.gl.createProgram();const t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`#version 300 es
       const vec2 halfmad = vec2(0.5);
       in vec2 aPos;
       out vec2 uv;
       void main(void) {
         gl_Position = vec4(aPos, 0.0, 1.0);
         uv = aPos * halfmad + halfmad;
       }`),this.gl.compileShader(t);const e=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(e,`#version 300 es
       precision ${this.floatPrecision} float;
       precision highp int;
       precision mediump sampler2D;

       in vec2 uv;
       out vec4 fragColor;
       uniform sampler2D uTexture;

       void main(void) {
         fragColor = vec4(texture(uTexture, uv).rgb, 1.0);
       }`),this.gl.compileShader(e),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,e),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture")}renderQuadTexture(t){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.uniform1i(this.textureLoc,0),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}},"./src/rendering/shaders/shaderUtils.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return A});const l=/uniform sampler2D sampler_(?:.+?);/g,g=/uniform sampler2D sampler_(.+?);/;class A{static getShaderParts(e){const s=e.indexOf("shader_body");if(e&&s>-1){const i=e.substring(0,s),a=e.substring(s),h=a.indexOf("{"),n=a.lastIndexOf("}"),r=a.substring(h+1,n);return[i,r]}return["",e]}static getFragmentFloatPrecision(e){return e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0?"highp":e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}static getUserSamplers(e){const s=[],i=e.match(l);if(i&&i.length>0)for(let a=0;a<i.length;a++){const h=i[a].match(g);if(h&&h.length>0){const n=h[1];s.push({sampler:n})}}return s}}},"./src/rendering/shaders/warp.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return g});var l=m("./src/rendering/shaders/shaderUtils.js");class g{constructor(t,e,s,i={}){this.gl=t,this.noise=e,this.image=s,this.texsizeX=i.texsizeX,this.texsizeY=i.texsizeY,this.mesh_width=i.mesh_width,this.mesh_height=i.mesh_height,this.aspectx=i.aspectx,this.aspecty=i.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions(),this.indexBuf=t.createBuffer(),this.positionVertexBuf=this.gl.createBuffer(),this.warpUvVertexBuf=this.gl.createBuffer(),this.warpColorVertexBuf=this.gl.createBuffer(),this.floatPrecision=l.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.mainSampler=this.gl.createSampler(),this.mainSamplerFW=this.gl.createSampler(),this.mainSamplerFC=this.gl.createSampler(),this.mainSamplerPW=this.gl.createSampler(),this.mainSamplerPC=this.gl.createSampler(),t.samplerParameteri(this.mainSampler,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.samplerParameteri(this.mainSampler,t.TEXTURE_MAG_FILTER,t.LINEAR),t.samplerParameteri(this.mainSampler,t.TEXTURE_WRAP_S,t.REPEAT),t.samplerParameteri(this.mainSampler,t.TEXTURE_WRAP_T,t.REPEAT),t.samplerParameteri(this.mainSamplerFW,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.samplerParameteri(this.mainSamplerFW,t.TEXTURE_MAG_FILTER,t.LINEAR),t.samplerParameteri(this.mainSamplerFW,t.TEXTURE_WRAP_S,t.REPEAT),t.samplerParameteri(this.mainSamplerFW,t.TEXTURE_WRAP_T,t.REPEAT),t.samplerParameteri(this.mainSamplerFC,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.samplerParameteri(this.mainSamplerFC,t.TEXTURE_MAG_FILTER,t.LINEAR),t.samplerParameteri(this.mainSamplerFC,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.samplerParameteri(this.mainSamplerFC,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.samplerParameteri(this.mainSamplerPW,t.TEXTURE_MIN_FILTER,t.NEAREST_MIPMAP_NEAREST),t.samplerParameteri(this.mainSamplerPW,t.TEXTURE_MAG_FILTER,t.NEAREST),t.samplerParameteri(this.mainSamplerPW,t.TEXTURE_WRAP_S,t.REPEAT),t.samplerParameteri(this.mainSamplerPW,t.TEXTURE_WRAP_T,t.REPEAT),t.samplerParameteri(this.mainSamplerPC,t.TEXTURE_MIN_FILTER,t.NEAREST_MIPMAP_NEAREST),t.samplerParameteri(this.mainSamplerPC,t.TEXTURE_MAG_FILTER,t.NEAREST),t.samplerParameteri(this.mainSamplerPC,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.samplerParameteri(this.mainSamplerPC,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)}buildPositions(){const a=this.mesh_width,h=this.mesh_height,n=a+1,r=h+1,u=2/a,v=2/h,c=[];for(let o=0;o<r;o++){const p=o*v-1;for(let d=0;d<n;d++){const P=d*u-1;c.push(P,-p,0)}}const f=[];for(let o=0;o<h;o++)for(let p=0;p<a;p++){const d=p+n*o,P=p+n*(o+1),X=p+1+n*(o+1),M=p+1+n*o;f.push(d,P,M),f.push(P,X,M)}this.vertices=new Float32Array(c),this.indices=new Uint16Array(f)}updateGlobals(t){this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.mesh_width=t.mesh_width,this.mesh_height=t.mesh_height,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions()}createShader(t=""){let e,s;if(t.length===0)e="ret = texture(sampler_main, uv).rgb * decay;",s="";else{const h=l.default.getShaderParts(t);s=h[0],e=h[1]}e=e.replace(/texture2D/g,"texture"),e=e.replace(/texture3D/g,"texture"),this.userTextures=l.default.getUserSamplers(s),this.shaderProgram=this.gl.createProgram();const i=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(i,`
      #version 300 es
      precision ${this.floatPrecision} float;
      const vec2 halfmad = vec2(0.5);
      in vec2 aPos;
      in vec2 aWarpUv;
      in vec4 aWarpColor;
      out vec2 uv;
      out vec2 uv_orig;
      out vec4 vColor;
      void main(void) {
        gl_Position = vec4(aPos, 0.0, 1.0);
        uv_orig = aPos * halfmad + halfmad;
        uv = aWarpUv;
        vColor = aWarpColor;
      }
      `.trim()),this.gl.compileShader(i);const a=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(a,`
      #version 300 es
      precision ${this.floatPrecision} float;
      precision highp int;
      precision mediump sampler2D;
      precision mediump sampler3D;

      in vec2 uv;
      in vec2 uv_orig;
      in vec4 vColor;
      out vec4 fragColor;
      uniform sampler2D sampler_main;
      uniform sampler2D sampler_fw_main;
      uniform sampler2D sampler_fc_main;
      uniform sampler2D sampler_pw_main;
      uniform sampler2D sampler_pc_main;
      uniform sampler2D sampler_blur1;
      uniform sampler2D sampler_blur2;
      uniform sampler2D sampler_blur3;
      uniform sampler2D sampler_noise_lq;
      uniform sampler2D sampler_noise_lq_lite;
      uniform sampler2D sampler_noise_mq;
      uniform sampler2D sampler_noise_hq;
      uniform sampler2D sampler_pw_noise_lq;
      uniform sampler3D sampler_noisevol_lq;
      uniform sampler3D sampler_noisevol_hq;
      uniform float time;
      uniform float decay;
      uniform vec2 resolution;
      uniform vec4 aspect;
      uniform vec4 texsize;
      uniform vec4 texsize_noise_lq;
      uniform vec4 texsize_noise_mq;
      uniform vec4 texsize_noise_hq;
      uniform vec4 texsize_noise_lq_lite;
      uniform vec4 texsize_noisevol_lq;
      uniform vec4 texsize_noisevol_hq;

      uniform float bass;
      uniform float mid;
      uniform float treb;
      uniform float vol;
      uniform float bass_att;
      uniform float mid_att;
      uniform float treb_att;
      uniform float vol_att;

      uniform float frame;
      uniform float fps;

      uniform vec4 _qa;
      uniform vec4 _qb;
      uniform vec4 _qc;
      uniform vec4 _qd;
      uniform vec4 _qe;
      uniform vec4 _qf;
      uniform vec4 _qg;
      uniform vec4 _qh;

      #define q1 _qa.x
      #define q2 _qa.y
      #define q3 _qa.z
      #define q4 _qa.w
      #define q5 _qb.x
      #define q6 _qb.y
      #define q7 _qb.z
      #define q8 _qb.w
      #define q9 _qc.x
      #define q10 _qc.y
      #define q11 _qc.z
      #define q12 _qc.w
      #define q13 _qd.x
      #define q14 _qd.y
      #define q15 _qd.z
      #define q16 _qd.w
      #define q17 _qe.x
      #define q18 _qe.y
      #define q19 _qe.z
      #define q20 _qe.w
      #define q21 _qf.x
      #define q22 _qf.y
      #define q23 _qf.z
      #define q24 _qf.w
      #define q25 _qg.x
      #define q26 _qg.y
      #define q27 _qg.z
      #define q28 _qg.w
      #define q29 _qh.x
      #define q30 _qh.y
      #define q31 _qh.z
      #define q32 _qh.w

      uniform vec4 slow_roam_cos;
      uniform vec4 roam_cos;
      uniform vec4 slow_roam_sin;
      uniform vec4 roam_sin;

      uniform float blur1_min;
      uniform float blur1_max;
      uniform float blur2_min;
      uniform float blur2_max;
      uniform float blur3_min;
      uniform float blur3_max;

      uniform float scale1;
      uniform float scale2;
      uniform float scale3;
      uniform float bias1;
      uniform float bias2;
      uniform float bias3;

      uniform vec4 rand_frame;
      uniform vec4 rand_preset;

      float PI = ${Math.PI};

      ${s}

      void main(void) {
        vec3 ret;
        float rad = length(uv_orig - 0.5);
        float ang = atan(uv_orig.x - 0.5, uv_orig.y - 0.5);

        ${e}

        fragColor = vec4(ret, 1.0) * vColor;
      }
      `.trim()),this.gl.compileShader(a),this.gl.attachShader(this.shaderProgram,i),this.gl.attachShader(this.shaderProgram,a),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.warpUvLocation=this.gl.getAttribLocation(this.shaderProgram,"aWarpUv"),this.warpColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aWarpColor"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_main"),this.textureFWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fw_main"),this.textureFCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fc_main"),this.texturePWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_main"),this.texturePCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pc_main"),this.blurTexture1Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur1"),this.blurTexture2Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur2"),this.blurTexture3Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur3"),this.noiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq"),this.noiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_mq"),this.noiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_hq"),this.noiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq_lite"),this.noisePointLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_noise_lq"),this.noiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_lq"),this.noiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_hq"),this.decayLoc=this.gl.getUniformLocation(this.shaderProgram,"decay"),this.texsizeLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.texsizeNoiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq"),this.texsizeNoiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_mq"),this.texsizeNoiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_hq"),this.texsizeNoiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq_lite"),this.texsizeNoiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_lq"),this.texsizeNoiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_hq"),this.resolutionLoc=this.gl.getUniformLocation(this.shaderProgram,"resolution"),this.aspectLoc=this.gl.getUniformLocation(this.shaderProgram,"aspect"),this.bassLoc=this.gl.getUniformLocation(this.shaderProgram,"bass"),this.midLoc=this.gl.getUniformLocation(this.shaderProgram,"mid"),this.trebLoc=this.gl.getUniformLocation(this.shaderProgram,"treb"),this.volLoc=this.gl.getUniformLocation(this.shaderProgram,"vol"),this.bassAttLoc=this.gl.getUniformLocation(this.shaderProgram,"bass_att"),this.midAttLoc=this.gl.getUniformLocation(this.shaderProgram,"mid_att"),this.trebAttLoc=this.gl.getUniformLocation(this.shaderProgram,"treb_att"),this.volAttLoc=this.gl.getUniformLocation(this.shaderProgram,"vol_att"),this.timeLoc=this.gl.getUniformLocation(this.shaderProgram,"time"),this.frameLoc=this.gl.getUniformLocation(this.shaderProgram,"frame"),this.fpsLoc=this.gl.getUniformLocation(this.shaderProgram,"fps"),this.blur1MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_min"),this.blur1MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_max"),this.blur2MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_min"),this.blur2MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_max"),this.blur3MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_min"),this.blur3MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_max"),this.scale1Loc=this.gl.getUniformLocation(this.shaderProgram,"scale1"),this.scale2Loc=this.gl.getUniformLocation(this.shaderProgram,"scale2"),this.scale3Loc=this.gl.getUniformLocation(this.shaderProgram,"scale3"),this.bias1Loc=this.gl.getUniformLocation(this.shaderProgram,"bias1"),this.bias2Loc=this.gl.getUniformLocation(this.shaderProgram,"bias2"),this.bias3Loc=this.gl.getUniformLocation(this.shaderProgram,"bias3"),this.randPresetLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_preset"),this.randFrameLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_frame"),this.qaLoc=this.gl.getUniformLocation(this.shaderProgram,"_qa"),this.qbLoc=this.gl.getUniformLocation(this.shaderProgram,"_qb"),this.qcLoc=this.gl.getUniformLocation(this.shaderProgram,"_qc"),this.qdLoc=this.gl.getUniformLocation(this.shaderProgram,"_qd"),this.qeLoc=this.gl.getUniformLocation(this.shaderProgram,"_qe"),this.qfLoc=this.gl.getUniformLocation(this.shaderProgram,"_qf"),this.qgLoc=this.gl.getUniformLocation(this.shaderProgram,"_qg"),this.qhLoc=this.gl.getUniformLocation(this.shaderProgram,"_qh"),this.slowRoamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_cos"),this.roamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_cos"),this.slowRoamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_sin"),this.roamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_sin");for(let h=0;h<this.userTextures.length;h++){const n=this.userTextures[h];n.textureLoc=this.gl.getUniformLocation(this.shaderProgram,`sampler_${n.sampler}`)}}updateShader(t){this.createShader(t)}bindBlurVals(t,e){const s=t[0],i=t[1],a=t[2],h=e[0],n=e[1],r=e[2],u=h-s,v=s,c=n-i,f=i,o=r-a,p=a;this.gl.uniform1f(this.blur1MinLoc,s),this.gl.uniform1f(this.blur1MaxLoc,h),this.gl.uniform1f(this.blur2MinLoc,i),this.gl.uniform1f(this.blur2MaxLoc,n),this.gl.uniform1f(this.blur3MinLoc,a),this.gl.uniform1f(this.blur3MaxLoc,r),this.gl.uniform1f(this.scale1Loc,u),this.gl.uniform1f(this.scale2Loc,c),this.gl.uniform1f(this.scale3Loc,o),this.gl.uniform1f(this.bias1Loc,v),this.gl.uniform1f(this.bias2Loc,f),this.gl.uniform1f(this.bias3Loc,p)}renderQuadTexture(t,e,s,i,a,h,n,r,u,v,c){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuf),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.indices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.warpUvVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,v,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.warpUvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.warpUvLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.warpColorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,c,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.warpColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.warpColorLocation);const f=r.wrap!==0?this.gl.REPEAT:this.gl.CLAMP_TO_EDGE;this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_S,f),this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_T,f),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(0,this.mainSampler),this.gl.uniform1i(this.textureLoc,0),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(1,this.mainSamplerFW),this.gl.uniform1i(this.textureFWLoc,1),this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(2,this.mainSamplerFC),this.gl.uniform1i(this.textureFCLoc,2),this.gl.activeTexture(this.gl.TEXTURE3),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(3,this.mainSamplerPW),this.gl.uniform1i(this.texturePWLoc,3),this.gl.activeTexture(this.gl.TEXTURE4),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(4,this.mainSamplerPC),this.gl.uniform1i(this.texturePCLoc,4),this.gl.activeTexture(this.gl.TEXTURE5),this.gl.bindTexture(this.gl.TEXTURE_2D,s),this.gl.uniform1i(this.blurTexture1Loc,5),this.gl.activeTexture(this.gl.TEXTURE6),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.uniform1i(this.blurTexture2Loc,6),this.gl.activeTexture(this.gl.TEXTURE7),this.gl.bindTexture(this.gl.TEXTURE_2D,a),this.gl.uniform1i(this.blurTexture3Loc,7),this.gl.activeTexture(this.gl.TEXTURE8),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.uniform1i(this.noiseLQLoc,8),this.gl.activeTexture(this.gl.TEXTURE9),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexMQ),this.gl.uniform1i(this.noiseMQLoc,9),this.gl.activeTexture(this.gl.TEXTURE10),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexHQ),this.gl.uniform1i(this.noiseHQLoc,10),this.gl.activeTexture(this.gl.TEXTURE11),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQLite),this.gl.uniform1i(this.noiseLQLiteLoc,11),this.gl.activeTexture(this.gl.TEXTURE12),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.bindSampler(12,this.noise.noiseTexPointLQ),this.gl.uniform1i(this.noisePointLQLoc,12),this.gl.activeTexture(this.gl.TEXTURE13),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolLQ),this.gl.uniform1i(this.noiseVolLQLoc,13),this.gl.activeTexture(this.gl.TEXTURE14),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolHQ),this.gl.uniform1i(this.noiseVolHQLoc,14);for(let o=0;o<this.userTextures.length;o++){const p=this.userTextures[o];this.gl.activeTexture(this.gl.TEXTURE15+o),this.gl.bindTexture(this.gl.TEXTURE_2D,this.image.getTexture(p.sampler)),this.gl.uniform1i(p.textureLoc,15+o)}this.gl.uniform1f(this.decayLoc,r.decay),this.gl.uniform2fv(this.resolutionLoc,[this.texsizeX,this.texsizeY]),this.gl.uniform4fv(this.aspectLoc,[this.aspectx,this.aspecty,this.invAspectx,this.invAspecty]),this.gl.uniform4fv(this.texsizeLoc,[this.texsizeX,this.texsizeY,1/this.texsizeX,1/this.texsizeY]),this.gl.uniform4fv(this.texsizeNoiseLQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseMQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseHQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseLQLiteLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolLQLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolHQLoc,[32,32,1/32,1/32]),this.gl.uniform1f(this.bassLoc,r.bass),this.gl.uniform1f(this.midLoc,r.mid),this.gl.uniform1f(this.trebLoc,r.treb),this.gl.uniform1f(this.volLoc,(r.bass+r.mid+r.treb)/3),this.gl.uniform1f(this.bassAttLoc,r.bass_att),this.gl.uniform1f(this.midAttLoc,r.mid_att),this.gl.uniform1f(this.trebAttLoc,r.treb_att),this.gl.uniform1f(this.volAttLoc,(r.bass_att+r.mid_att+r.treb_att)/3),this.gl.uniform1f(this.timeLoc,r.time),this.gl.uniform1f(this.frameLoc,r.frame),this.gl.uniform1f(this.fpsLoc,r.fps),this.gl.uniform4fv(this.randPresetLoc,r.rand_preset),this.gl.uniform4fv(this.randFrameLoc,new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()])),this.gl.uniform4fv(this.qaLoc,new Float32Array([u.q1||0,u.q2||0,u.q3||0,u.q4||0])),this.gl.uniform4fv(this.qbLoc,new Float32Array([u.q5||0,u.q6||0,u.q7||0,u.q8||0])),this.gl.uniform4fv(this.qcLoc,new Float32Array([u.q9||0,u.q10||0,u.q11||0,u.q12||0])),this.gl.uniform4fv(this.qdLoc,new Float32Array([u.q13||0,u.q14||0,u.q15||0,u.q16||0])),this.gl.uniform4fv(this.qeLoc,new Float32Array([u.q17||0,u.q18||0,u.q19||0,u.q20||0])),this.gl.uniform4fv(this.qfLoc,new Float32Array([u.q21||0,u.q22||0,u.q23||0,u.q24||0])),this.gl.uniform4fv(this.qgLoc,new Float32Array([u.q25||0,u.q26||0,u.q27||0,u.q28||0])),this.gl.uniform4fv(this.qhLoc,new Float32Array([u.q29||0,u.q30||0,u.q31||0,u.q32||0])),this.gl.uniform4fv(this.slowRoamCosLoc,[.5+.5*Math.cos(r.time*.005),.5+.5*Math.cos(r.time*.008),.5+.5*Math.cos(r.time*.013),.5+.5*Math.cos(r.time*.022)]),this.gl.uniform4fv(this.roamCosLoc,[.5+.5*Math.cos(r.time*.3),.5+.5*Math.cos(r.time*1.3),.5+.5*Math.cos(r.time*5),.5+.5*Math.cos(r.time*20)]),this.gl.uniform4fv(this.slowRoamSinLoc,[.5+.5*Math.sin(r.time*.005),.5+.5*Math.sin(r.time*.008),.5+.5*Math.sin(r.time*.013),.5+.5*Math.sin(r.time*.022)]),this.gl.uniform4fv(this.roamSinLoc,[.5+.5*Math.sin(r.time*.3),.5+.5*Math.sin(r.time*1.3),.5+.5*Math.sin(r.time*5),.5+.5*Math.sin(r.time*20)]),this.bindBlurVals(h,n),t?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA):this.gl.disable(this.gl.BLEND),this.gl.drawElements(this.gl.TRIANGLES,this.indices.length,this.gl.UNSIGNED_SHORT,0),t||this.gl.enable(this.gl.BLEND)}}},"./src/rendering/shapes/customShape.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return A});var l=m("./src/utils.js"),g=m("./src/rendering/shaders/shaderUtils.js");class A{constructor(e,s,i){this.index=e,this.gl=s;const a=101;this.positions=new Float32Array((a+2)*3),this.colors=new Float32Array((a+2)*4),this.uvs=new Float32Array((a+2)*2),this.borderPositions=new Float32Array((a+1)*3),this.texsizeX=i.texsizeX,this.texsizeY=i.texsizeY,this.mesh_width=i.mesh_width,this.mesh_height=i.mesh_height,this.aspectx=i.aspectx,this.aspecty=i.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.positionVertexBuf=this.gl.createBuffer(),this.colorVertexBuf=this.gl.createBuffer(),this.uvVertexBuf=this.gl.createBuffer(),this.borderPositionVertexBuf=this.gl.createBuffer(),this.floatPrecision=g.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.createBorderShader(),this.mainSampler=this.gl.createSampler(),s.samplerParameteri(this.mainSampler,s.TEXTURE_MIN_FILTER,s.LINEAR_MIPMAP_LINEAR),s.samplerParameteri(this.mainSampler,s.TEXTURE_MAG_FILTER,s.LINEAR),s.samplerParameteri(this.mainSampler,s.TEXTURE_WRAP_S,s.REPEAT),s.samplerParameteri(this.mainSampler,s.TEXTURE_WRAP_T,s.REPEAT)}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,`
      #version 300 es
      in vec3 aPos;
      in vec4 aColor;
      in vec2 aUv;
      out vec4 vColor;
      out vec2 vUv;
      void main(void) {
        vColor = aColor;
        vUv = aUv;
        gl_Position = vec4(aPos, 1.0);
      }
      `.trim()),this.gl.compileShader(e);const s=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(s,`
      #version 300 es
      precision ${this.floatPrecision} float;
      precision highp int;
      precision mediump sampler2D;
      uniform sampler2D uTexture;
      uniform float uTextured;
      in vec4 vColor;
      in vec2 vUv;
      out vec4 fragColor;
      void main(void) {
        if (uTextured != 0.0) {
          fragColor = texture(uTexture, vUv) * vColor;
        } else {
          fragColor = vColor;
        }
      }
      `.trim()),this.gl.compileShader(s),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,s),this.gl.linkProgram(this.shaderProgram),this.aPosLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.aColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aColor"),this.aUvLocation=this.gl.getAttribLocation(this.shaderProgram,"aUv"),this.texturedLoc=this.gl.getUniformLocation(this.shaderProgram,"uTextured"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture")}createBorderShader(){this.borderShaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,`
      #version 300 es
      in vec3 aBorderPos;
      uniform vec2 thickOffset;
      void main(void) {
        gl_Position = vec4(aBorderPos +
                            vec3(thickOffset, 0.0), 1.0);
      }
      `.trim()),this.gl.compileShader(e);const s=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(s,`
      #version 300 es
      precision ${this.floatPrecision} float;
      precision highp int;
      precision mediump sampler2D;
      out vec4 fragColor;
      uniform vec4 uBorderColor;
      void main(void) {
        fragColor = uBorderColor;
      }
      `.trim()),this.gl.compileShader(s),this.gl.attachShader(this.borderShaderProgram,e),this.gl.attachShader(this.borderShaderProgram,s),this.gl.linkProgram(this.borderShaderProgram),this.aBorderPosLoc=this.gl.getAttribLocation(this.borderShaderProgram,"aBorderPos"),this.uBorderColorLoc=this.gl.getUniformLocation(this.borderShaderProgram,"uBorderColor"),this.thickOffsetLoc=this.gl.getUniformLocation(this.shaderProgram,"thickOffset")}drawCustomShape(e,s,i,a,h){if(a.baseVals.enabled!==0)if(i.preset.useWASM){this.setupShapeBuffers(i.preset.globalPools.perFrame.wrap.value);const n=i.preset.shapes[this.index].baseVals,r=i.preset.globalPools[`shapePerFrame${this.index}`];l.default.setWasm(r,s,i.globalKeys),i.preset.shapes[this.index].frame_eqs||i.preset.restore_qs(),l.default.setWasm(r,i.mdVSTShapeInits[this.index],i.ts),i.preset.save_ts(),r.x.value=n.x,r.y.value=n.y,r.rad.value=n.rad,r.ang.value=n.ang,r.r.value=n.r,r.g.value=n.g,r.b.value=n.b,r.a.value=n.a,r.r2.value=n.r2,r.g2.value=n.g2,r.b2.value=n.b2,r.a2.value=n.a2,r.border_r.value=n.border_r,r.border_g.value=n.border_g,r.border_b.value=n.border_b,r.border_a.value=n.border_a,r.thickoutline.value=n.thickoutline,r.textured.value=n.textured,r.tex_zoom.value=n.tex_zoom,r.tex_ang.value=n.tex_ang,r.additive.value=n.additive,i.preset.shapes[this.index].frame_eqs_save();const u=Math.clamp(n.num_inst,1,1024);for(let v=0;v<u;v++){r.instance.value=v,i.preset.shapes[this.index].frame_eqs&&(i.preset.shapes[this.index].frame_eqs_restore(),i.preset.restore_qs(),i.preset.restore_ts(),i.preset.shapes[this.index].frame_eqs());let c=r.sides.value;c=Math.clamp(c,3,100),c=Math.floor(c);const f=r.rad.value,o=r.ang.value,p=r.x.value*2-1,d=r.y.value*-2+1,P=r.r.value,X=r.g.value,M=r.b.value,C=r.a.value,w=r.r2.value,b=r.g2.value,_=r.b2.value,T=r.a2.value,x=r.border_r.value,I=r.border_g.value,U=r.border_b.value,R=r.border_a.value;this.borderColor=[x,I,U,R*e];const S=r.thickoutline.value,y=r.textured.value,F=r.tex_zoom.value,D=r.tex_ang.value,z=r.additive.value,O=this.borderColor[3]>0,V=Math.abs(y)>=1,K=Math.abs(S)>=1,B=Math.abs(z)>=1;this.positions[0]=p,this.positions[1]=d,this.positions[2]=0,this.colors[0]=P,this.colors[1]=X,this.colors[2]=M,this.colors[3]=C*e,V&&(this.uvs[0]=.5,this.uvs[1]=.5);const Q=Math.PI*.25;for(let N=1;N<=c+1;N++){const Y=(N-1)/c*2*Math.PI,L=Y+o+Q;if(this.positions[N*3+0]=p+f*Math.cos(L)*this.aspecty,this.positions[N*3+1]=d+f*Math.sin(L),this.positions[N*3+2]=0,this.colors[N*4+0]=w,this.colors[N*4+1]=b,this.colors[N*4+2]=_,this.colors[N*4+3]=T*e,V){const it=Y+D+Q;this.uvs[N*2+0]=.5+.5*Math.cos(it)/F*this.aspecty,this.uvs[N*2+1]=.5+.5*Math.sin(it)/F}O&&(this.borderPositions[(N-1)*3+0]=this.positions[N*3+0],this.borderPositions[(N-1)*3+1]=this.positions[N*3+1],this.borderPositions[(N-1)*3+2]=this.positions[N*3+2])}this.drawCustomShapeInstance(h,c,V,O,K,B)}}else{this.setupShapeBuffers(i.mdVSFrame.wrap);let n=Object.assign({},i.mdVSShapes[this.index],i.mdVSFrameMapShapes[this.index],s);i.preset.shapes[this.index].frame_eqs_str===""&&(n=Object.assign(n,i.mdVSQAfterFrame,i.mdVSTShapeInits[this.index]));const r=i.preset.shapes[this.index].baseVals,u=Math.clamp(r.num_inst,1,1024);for(let f=0;f<u;f++){n.instance=f,n.x=r.x,n.y=r.y,n.rad=r.rad,n.ang=r.ang,n.r=r.r,n.g=r.g,n.b=r.b,n.a=r.a,n.r2=r.r2,n.g2=r.g2,n.b2=r.b2,n.a2=r.a2,n.border_r=r.border_r,n.border_g=r.border_g,n.border_b=r.border_b,n.border_a=r.border_a,n.thickoutline=r.thickoutline,n.textured=r.textured,n.tex_zoom=r.tex_zoom,n.tex_ang=r.tex_ang,n.additive=r.additive;let o;i.preset.shapes[this.index].frame_eqs_str!==""?(n=Object.assign(n,i.mdVSQAfterFrame,i.mdVSTShapeInits[this.index]),o=i.runShapeFrameEquations(this.index,n)):o=n;let p=o.sides;p=Math.clamp(p,3,100),p=Math.floor(p);const d=o.rad,P=o.ang,X=o.x*2-1,M=o.y*-2+1,C=o.r,w=o.g,b=o.b,_=o.a,T=o.r2,x=o.g2,I=o.b2,U=o.a2,R=o.border_r,S=o.border_g,y=o.border_b,F=o.border_a;this.borderColor=[R,S,y,F*e];const D=o.thickoutline,z=o.textured,O=o.tex_zoom,V=o.tex_ang,K=o.additive,B=this.borderColor[3]>0,Q=Math.abs(z)>=1,N=Math.abs(D)>=1,q=Math.abs(K)>=1;this.positions[0]=X,this.positions[1]=M,this.positions[2]=0,this.colors[0]=C,this.colors[1]=w,this.colors[2]=b,this.colors[3]=_*e,Q&&(this.uvs[0]=.5,this.uvs[1]=.5);const Y=Math.PI*.25;for(let L=1;L<=p+1;L++){const G=(L-1)/p*2*Math.PI,at=G+P+Y;if(this.positions[L*3+0]=X+d*Math.cos(at)*this.aspecty,this.positions[L*3+1]=M+d*Math.sin(at),this.positions[L*3+2]=0,this.colors[L*4+0]=T,this.colors[L*4+1]=x,this.colors[L*4+2]=I,this.colors[L*4+3]=U*e,Q){const ot=G+V+Y;this.uvs[L*2+0]=.5+.5*Math.cos(ot)/O*this.aspecty,this.uvs[L*2+1]=.5+.5*Math.sin(ot)/O}B&&(this.borderPositions[(L-1)*3+0]=this.positions[L*3+0],this.borderPositions[(L-1)*3+1]=this.positions[L*3+1],this.borderPositions[(L-1)*3+2]=this.positions[L*3+2])}this.mdVSShapeFrame=o,this.drawCustomShapeInstance(h,p,Q,B,N,q)}const v=i.mdVSUserKeysShapes[this.index],c=l.default.pick(this.mdVSShapeFrame,v);i.mdVSFrameMapShapes[this.index]=c}}setupShapeBuffers(e){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.colors,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.uvVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.uvs,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aUvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aUvLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.borderPositionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.borderPositions,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aBorderPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aBorderPosLoc);const s=e!==0?this.gl.REPEAT:this.gl.CLAMP_TO_EDGE;this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_S,s),this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_T,s)}drawCustomShapeInstance(e,s,i,a,h,n){if(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,this.positions,0,(s+2)*3),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,this.colors,0,(s+2)*4),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation),i&&(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.uvVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,this.uvs,0,(s+2)*2),this.gl.vertexAttribPointer(this.aUvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aUvLocation)),this.gl.uniform1f(this.texturedLoc,i?1:0),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(0,this.mainSampler),this.gl.uniform1i(this.textureLoc,0),n?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE):this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_FAN,0,s+2),a){this.gl.useProgram(this.borderShaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.borderPositionVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,this.borderPositions,0,(s+1)*3),this.gl.vertexAttribPointer(this.aBorderPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aBorderPosLoc),this.gl.uniform4fv(this.uBorderColorLoc,this.borderColor);const r=h?4:1;for(let u=0;u<r;u++)u===0?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):u===1?this.gl.uniform2fv(this.thickOffsetLoc,[2/this.texsizeX,0]):u===2?this.gl.uniform2fv(this.thickOffsetLoc,[0,2/this.texsizeY]):u===3&&this.gl.uniform2fv(this.thickOffsetLoc,[2/this.texsizeX,2/this.texsizeY]),this.gl.drawArrays(this.gl.LINE_STRIP,0,s+1)}}}},"./src/rendering/sprites/border.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return g});var l=m("./src/rendering/shaders/shaderUtils.js");class g{constructor(t,e={}){this.gl=t,this.positions=new Float32Array(72),this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.floatPrecision=l.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.vertexBuf=this.gl.createBuffer()}updateGlobals(t){this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}createShader(){this.shaderProgram=this.gl.createProgram();const t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`
      #version 300 es
      in vec3 aPos;
      void main(void) {
        gl_Position = vec4(aPos, 1.0);
      }
      `.trim()),this.gl.compileShader(t);const e=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(e,`
      #version 300 es
      precision ${this.floatPrecision} float;
      precision highp int;
      precision mediump sampler2D;
      out vec4 fragColor;
      uniform vec4 u_color;
      void main(void) {
        fragColor = u_color;
      }
      `.trim()),this.gl.compileShader(e),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,e),this.gl.linkProgram(this.shaderProgram),this.aPosLoc=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.colorLoc=this.gl.getUniformLocation(this.shaderProgram,"u_color")}addTriangle(t,e,s,i){this.positions[t+0]=e[0],this.positions[t+1]=e[1],this.positions[t+2]=e[2],this.positions[t+3]=s[0],this.positions[t+4]=s[1],this.positions[t+5]=s[2],this.positions[t+6]=i[0],this.positions[t+7]=i[1],this.positions[t+8]=i[2]}generateBorder(t,e,s){if(e>0&&t[3]>0){const r=s/2,u=e/2+r,v=r*2,c=r*2,f=u*2,o=u*2;let p=[-1+v,-1+o,0],d=[-1+v,1-o,0],P=[-1+f,1-o,0],X=[-1+f,-1+o,0];return this.addTriangle(0,X,d,p),this.addTriangle(9,X,P,d),p=[1-v,-1+o,0],d=[1-v,1-o,0],P=[1-f,1-o,0],X=[1-f,-1+o,0],this.addTriangle(18,p,d,X),this.addTriangle(27,d,P,X),p=[-1+v,-1+c,0],d=[-1+v,o-1,0],P=[1-v,o-1,0],X=[1-v,-1+c,0],this.addTriangle(36,X,d,p),this.addTriangle(45,X,P,d),p=[-1+v,1-c,0],d=[-1+v,1-o,0],P=[1-v,1-o,0],X=[1-v,1-c,0],this.addTriangle(54,p,d,X),this.addTriangle(63,d,P,X),!0}return!1}drawBorder(t,e,s){this.generateBorder(t,e,s)&&(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc),this.gl.uniform4fv(this.colorLoc,t),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLES,0,this.positions.length/3))}}},"./src/rendering/sprites/darkenCenter.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return g});var l=m("./src/rendering/shaders/shaderUtils.js");class g{constructor(t,e){this.gl=t,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.generatePositions(),this.colors=new Float32Array([0,0,0,3/32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),this.positionVertexBuf=this.gl.createBuffer(),this.colorVertexBuf=this.gl.createBuffer(),this.floatPrecision=l.default.getFragmentFloatPrecision(this.gl),this.createShader()}updateGlobals(t){this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.generatePositions()}generatePositions(){this.positions=new Float32Array([0,0,0,-.05*this.aspecty,0,0,0,-.05,0,.05*this.aspecty,0,0,0,.05,0,-.05*this.aspecty,0,0])}createShader(){this.shaderProgram=this.gl.createProgram();const t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`
      #version 300 es
      in vec3 aPos;
      in vec4 aColor;
      out vec4 vColor;
      void main(void) {
        vColor = aColor;
        gl_Position = vec4(aPos, 1.0);
      }
      `.trim()),this.gl.compileShader(t);const e=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(e,`
      #version 300 es
      precision ${this.floatPrecision} float;
      precision highp int;
      precision mediump sampler2D;
      in vec4 vColor;
      out vec4 fragColor;
      void main(void) {
        fragColor = vColor;
      }
      `.trim()),this.gl.compileShader(e),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,e),this.gl.linkProgram(this.shaderProgram),this.aPosLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.aColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aColor")}drawDarkenCenter(t){t.darken_center!==0&&(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.colors,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_FAN,0,this.positions.length/3))}}},"./src/rendering/text/titleText.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return g});var l=m("./src/rendering/shaders/shaderUtils.js");class g{constructor(t,e={}){this.gl=t,this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions(),this.textTexture=this.gl.createTexture(),this.indexBuf=t.createBuffer(),this.positionVertexBuf=this.gl.createBuffer(),this.vertexBuf=this.gl.createBuffer(),this.canvas=document.createElement("canvas"),this.canvas.width=this.texsizeX,this.canvas.height=this.texsizeY,this.context2D=this.canvas.getContext("2d"),this.floatPrecision=l.default.getFragmentFloatPrecision(this.gl),this.createShader()}generateTitleTexture(t){this.context2D.clearRect(0,0,this.texsizeX,this.texsizeY),this.fontSize=Math.floor(16*(this.texsizeX/256)),this.fontSize=Math.max(this.fontSize,6),this.context2D.font=`italic ${this.fontSize}px Times New Roman`;let e=t,s=this.context2D.measureText(e).width;if(s>this.texsizeX){const a=.91*(this.texsizeX/s);e=`${e.substring(0,Math.floor(e.length*a))}...`,s=this.context2D.measureText(e).width}this.context2D.fillStyle="#FFFFFF",this.context2D.fillText(e,(this.texsizeX-s)/2,this.texsizeY/2);const i=new Uint8Array(this.context2D.getImageData(0,0,this.texsizeX,this.texsizeY).data.buffer);this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.texsizeX,this.texsizeY,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,i),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}updateGlobals(t){this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.canvas.width=this.texsizeX,this.canvas.height=this.texsizeY}buildPositions(){const u=.13333333333333333,v=2/7,c=[];for(let o=0;o<8;o++){const p=o*v-1;for(let d=0;d<16;d++){const P=d*u-1;c.push(P,-p,0)}}const f=[];for(let o=0;o<7;o++)for(let p=0;p<15;p++){const d=p+16*o,P=p+16*(o+1),X=p+1+16*(o+1),M=p+1+16*o;f.push(d,P,M),f.push(P,X,M)}this.vertices=new Float32Array(c),this.indices=new Uint16Array(f)}createShader(){this.shaderProgram=this.gl.createProgram();const t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`#version 300 es
       const vec2 halfmad = vec2(0.5);
       in vec2 aPos;
       in vec2 aUv;
       out vec2 uv_orig;
       out vec2 uv;
       void main(void) {
         gl_Position = vec4(aPos, 0.0, 1.0);
         uv_orig = aPos * halfmad + halfmad;
         uv = aUv;
       }`),this.gl.compileShader(t);const e=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(e,`#version 300 es
       precision ${this.floatPrecision} float;
       precision highp int;
       precision mediump sampler2D;

       in vec2 uv_orig;
       in vec2 uv;
       out vec4 fragColor;
       uniform sampler2D uTexture;
       uniform float textColor;

       void main(void) {
         fragColor = texture(uTexture, uv) * vec4(textColor);
       }`),this.gl.compileShader(e),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,e),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.uvLocation=this.gl.getAttribLocation(this.shaderProgram,"aUv"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.textColorLoc=this.gl.getUniformLocation(this.shaderProgram,"textColor")}generateUvs(t,e,s){const r=[];for(let o=0;o<8;o++)for(let p=0;p<16;p++){const d=p/15,P=(o/7-.5)*.75+.5,X=d*2-1;let M=P*2-1;t>=1&&(M+=1/this.texsizeY),r.push(X,e?M:-M)}const c=Math.max(0,1-t*1.5)**1.8*1.3;for(let o=0;o<8;o++)for(let p=0;p<16;p++){const d=o*16+p;r[d]+=c*.07*Math.sin(s.time*.31+r[d]*.39-r[d+1]*1.94),r[d]+=c*.044*Math.sin(s.time*.81-r[d]*1.91+r[d+1]*.27),r[d]+=c*.061*Math.sin(s.time*1.31+r[d]*.61+r[d+1]*.74),r[d+1]+=c*.061*Math.sin(s.time*.37+r[d]*1.83+r[d+1]*.69),r[d+1]+=c*.07*Math.sin(s.time*.67+r[d]*.42-r[d+1]*1.39),r[d+1]+=c*.087*Math.sin(s.time*1.07+r[d]*3.55+r[d+1]*.89)}const f=1.01/(t**.21+.01);for(let o=0;o<r.length/2;o++)r[o*2]*=f,r[o*2+1]*=f*this.invAspecty,r[o*2]=(r[o*2]+1)/2,r[o*2+1]=(r[o*2+1]+1)/2;return new Float32Array(r)}renderTitle(t,e,s){this.gl.useProgram(this.shaderProgram);const i=this.generateUvs(t,e,s);this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuf),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.indices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,i,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.uvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.uvLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textTexture),this.gl.uniform1i(this.textureLoc,0),this.gl.uniform1f(this.textColorLoc,t**.3),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawElements(this.gl.TRIANGLES,this.indices.length,this.gl.UNSIGNED_SHORT,0)}}},"./src/rendering/waves/basicWaveform.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return A});var l=m("./src/rendering/shaders/shaderUtils.js"),g=m("./src/rendering/waves/waveUtils.js");class A{constructor(e,s={}){this.gl=e;const i=512;this.positions=new Float32Array(i*3),this.positions2=new Float32Array(i*3),this.oldPositions=new Float32Array(i*3),this.oldPositions2=new Float32Array(i*3),this.smoothedPositions=new Float32Array((i*2-1)*3),this.smoothedPositions2=new Float32Array((i*2-1)*3),this.color=[0,0,0,1],this.texsizeX=s.texsizeX,this.texsizeY=s.texsizeY,this.aspectx=s.aspectx,this.aspecty=s.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.floatPrecision=l.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.vertexBuf=this.gl.createBuffer()}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,`
      #version 300 es
      in vec3 aPos;
      uniform vec2 thickOffset;
      void main(void) {
        gl_Position = vec4(aPos + vec3(thickOffset, 0.0), 1.0);
      }
      `.trim()),this.gl.compileShader(e);const s=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(s,`
      #version 300 es
      precision ${this.floatPrecision} float;
      precision highp int;
      precision mediump sampler2D;
      out vec4 fragColor;
      uniform vec4 u_color;
      void main(void) {
        fragColor = u_color;
      }
      `.trim()),this.gl.compileShader(s),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,s),this.gl.linkProgram(this.shaderProgram),this.aPosLoc=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.colorLoc=this.gl.getUniformLocation(this.shaderProgram,"u_color"),this.thickOffsetLoc=this.gl.getUniformLocation(this.shaderProgram,"thickOffset")}static processWaveform(e,s){const i=[],a=s.wave_scale/128,h=s.wave_smoothing,n=a*(1-h);i.push(e[0]*a);for(let r=1;r<e.length;r++)i.push(e[r]*n+i[r-1]*h);return i}generateWaveform(e,s,i,a,h){let n=h.wave_a;const r=(h.bass+h.mid+h.treb)/3;if(r>-.01&&n>.001&&i.length>0){const u=A.processWaveform(i,h),v=A.processWaveform(a,h),c=Math.floor(h.wave_mode)%8,f=Math.floor(h.old_wave_mode)%8,o=h.wave_x*2-1,p=h.wave_y*2-1;this.numVert=0,this.oldNumVert=0;const d=e&&c!==f?2:1;for(let b=0;b<d;b++){const _=b===0?c:f;let T=h.wave_mystery;(_===0||_===1||_===4)&&(T<-1||T>1)&&(T=T*.5+.5,T-=Math.floor(T),T=Math.abs(T),T=T*2-1);let x,I,U;if(b===0?(I=this.positions,U=this.positions2):(I=this.oldPositions,U=this.oldPositions2),n=h.wave_a,_===0){if(h.modwavealphabyvolume>0){const y=h.modwavealphaend-h.modwavealphastart;n*=(r-h.modwavealphastart)/y}n=Math.clamp(n,0,1),x=Math.floor(u.length/2)+1;const R=1/(x-1),S=Math.floor((u.length-x)/2);for(let y=0;y<x-1;y++){let F=.5+.4*v[y+S]+T;const D=y*R*2*Math.PI+h.time*.2;if(y<x/10){let z=y/(x*.1);z=.5-.5*Math.cos(z*Math.PI);const O=.5+.4*v[y+x+S]+T;F=(1-z)*O+F*z}I[y*3+0]=F*Math.cos(D)*this.aspecty+o,I[y*3+1]=F*Math.sin(D)*this.aspectx+p,I[y*3+2]=0}I[(x-1)*3+0]=I[0],I[(x-1)*3+1]=I[1],I[(x-1)*3+2]=0}else if(_===1){if(n*=1.25,h.modwavealphabyvolume>0){const R=h.modwavealphaend-h.modwavealphastart;n*=(r-h.modwavealphastart)/R}n=Math.clamp(n,0,1),x=Math.floor(u.length/2);for(let R=0;R<x;R++){const S=.53+.43*v[R]+T,y=u[R+32]*.5*Math.PI+h.time*2.3;I[R*3+0]=S*Math.cos(y)*this.aspecty+o,I[R*3+1]=S*Math.sin(y)*this.aspectx+p,I[R*3+2]=0}}else if(_===2){if(this.texsizeX<1024?n*=.09:this.texsizeX>=1024&&this.texsizeX<2048?n*=.11:n*=.13,h.modwavealphabyvolume>0){const R=h.modwavealphaend-h.modwavealphastart;n*=(r-h.modwavealphastart)/R}n=Math.clamp(n,0,1),x=u.length;for(let R=0;R<u.length;R++)I[R*3+0]=v[R]*this.aspecty+o,I[R*3+1]=u[(R+32)%u.length]*this.aspectx+p,I[R*3+2]=0}else if(_===3){if(this.texsizeX<1024?n*=.15:this.texsizeX>=1024&&this.texsizeX<2048?n*=.22:n*=.33,n*=1.3,n*=h.treb*h.treb,h.modwavealphabyvolume>0){const R=h.modwavealphaend-h.modwavealphastart;n*=(r-h.modwavealphastart)/R}n=Math.clamp(n,0,1),x=u.length;for(let R=0;R<u.length;R++)I[R*3+0]=v[R]*this.aspecty+o,I[R*3+1]=u[(R+32)%u.length]*this.aspectx+p,I[R*3+2]=0}else if(_===4){if(h.modwavealphabyvolume>0){const D=h.modwavealphaend-h.modwavealphastart;n*=(r-h.modwavealphastart)/D}n=Math.clamp(n,0,1),x=u.length,x>this.texsizeX/3&&(x=Math.floor(this.texsizeX/3));const R=1/x,S=Math.floor((u.length-x)/2),y=.45+.5*(T*.5+.5),F=1-y;for(let D=0;D<x;D++){let z=2*D*R+(o-1)+v[(D+25+S)%u.length]*.44,O=u[D+S]*.47+p;D>1&&(z=z*F+y*(I[(D-1)*3+0]*2-I[(D-2)*3+0]),O=O*F+y*(I[(D-1)*3+1]*2-I[(D-2)*3+1])),I[D*3+0]=z,I[D*3+1]=O,I[D*3+2]=0}}else if(_===5){if(this.texsizeX<1024?n*=.09:this.texsizeX>=1024&&this.texsizeX<2048?n*=.11:n*=.13,h.modwavealphabyvolume>0){const y=h.modwavealphaend-h.modwavealphastart;n*=(r-h.modwavealphastart)/y}n=Math.clamp(n,0,1);const R=Math.cos(h.time*.3),S=Math.sin(h.time*.3);x=u.length;for(let y=0;y<u.length;y++){const F=(y+32)%u.length,D=v[y]*u[F]+u[y]*v[F],z=v[y]*v[y]-u[F]*u[F];I[y*3+0]=(D*R-z*S)*(this.aspecty+o),I[y*3+1]=(D*S+z*R)*(this.aspectx+p),I[y*3+2]=0}}else if(_===6||_===7){if(h.modwavealphabyvolume>0){const B=h.modwavealphaend-h.modwavealphastart;n*=(r-h.modwavealphastart)/B}n=Math.clamp(n,0,1),x=Math.floor(u.length/2),x>this.texsizeX/3&&(x=Math.floor(this.texsizeX/3));const R=Math.floor((u.length-x)/2),S=Math.PI*.5*T;let y=Math.cos(S),F=Math.sin(S);const D=[o*Math.cos(S+Math.PI*.5)-y*3,o*Math.cos(S+Math.PI*.5)+y*3],z=[o*Math.sin(S+Math.PI*.5)-F*3,o*Math.sin(S+Math.PI*.5)+F*3];for(let B=0;B<2;B++)for(let Q=0;Q<4;Q++){let N,q=!1;switch(Q){case 0:D[B]>1.1&&(N=(1.1-D[1-B])/(D[B]-D[1-B]),q=!0);break;case 1:D[B]<-1.1&&(N=(-1.1-D[1-B])/(D[B]-D[1-B]),q=!0);break;case 2:z[B]>1.1&&(N=(1.1-z[1-B])/(z[B]-z[1-B]),q=!0);break;case 3:z[B]<-1.1&&(N=(-1.1-z[1-B])/(z[B]-z[1-B]),q=!0);break}if(q){const Y=D[B]-D[1-B],L=z[B]-z[1-B];D[B]=D[1-B]+Y*N,z[B]=z[1-B]+L*N}}y=(D[1]-D[0])/x,F=(z[1]-z[0])/x;const O=Math.atan2(F,y),V=Math.cos(O+Math.PI*.5),K=Math.sin(O+Math.PI*.5);if(_===6)for(let B=0;B<x;B++){const Q=u[B+R];I[B*3+0]=D[0]+y*B+V*.25*Q,I[B*3+1]=z[0]+F*B+K*.25*Q,I[B*3+2]=0}else if(_===7){const B=(p*.5+.5)**2;for(let Q=0;Q<x;Q++){const N=u[Q+R];I[Q*3+0]=D[0]+y*Q+V*(.25*N+B),I[Q*3+1]=z[0]+F*Q+K*(.25*N+B),I[Q*3+2]=0}for(let Q=0;Q<x;Q++){const N=v[Q+R];U[Q*3+0]=D[0]+y*Q+V*(.25*N-B),U[Q*3+1]=z[0]+F*Q+K*(.25*N-B),U[Q*3+2]=0}}}b===0?(this.positions=I,this.positions2=U,this.numVert=x,this.alpha=n):(this.oldPositions=I,this.oldPositions2=U,this.oldNumVert=x,this.oldAlpha=n)}const P=.5-.5*Math.cos(s*Math.PI),X=1-P;this.oldNumVert>0&&(n=P*this.alpha+X*this.oldAlpha);let M=Math.clamp(h.wave_r,0,1),C=Math.clamp(h.wave_g,0,1),w=Math.clamp(h.wave_b,0,1);if(h.wave_brighten!==0){const b=Math.max(M,C,w);b>.01&&(M/=b,C/=b,w/=b)}if(this.color=[M,C,w,n],this.oldNumVert>0)if(c===7){const b=(this.oldNumVert-1)/(this.numVert*2);for(let _=0;_<this.numVert;_++){const T=_*b,x=Math.floor(T),I=T-x,U=this.oldPositions[x*3+0]*(1-I)+this.oldPositions[(x+1)*3+0]*I,R=this.oldPositions[x*3+1]*(1-I)+this.oldPositions[(x+1)*3+1]*I;this.positions[_*3+0]=this.positions[_*3+0]*P+U*X,this.positions[_*3+1]=this.positions[_*3+1]*P+R*X,this.positions[_*3+2]=0}for(let _=0;_<this.numVert;_++){const T=(_+this.numVert)*b,x=Math.floor(T),I=T-x,U=this.oldPositions[x*3+0]*(1-I)+this.oldPositions[(x+1)*3+0]*I,R=this.oldPositions[x*3+1]*(1-I)+this.oldPositions[(x+1)*3+1]*I;this.positions2[_*3+0]=this.positions2[_*3+0]*P+U*X,this.positions2[_*3+1]=this.positions2[_*3+1]*P+R*X,this.positions2[_*3+2]=0}}else if(f===7){const b=this.numVert/2,_=(this.oldNumVert-1)/b;for(let T=0;T<b;T++){const x=T*_,I=Math.floor(x),U=x-I,R=this.oldPositions[I*3+0]*(1-U)+this.oldPositions[(I+1)*3+0]*U,S=this.oldPositions[I*3+1]*(1-U)+this.oldPositions[(I+1)*3+1]*U;this.positions[T*3+0]=this.positions[T*3+0]*P+R*X,this.positions[T*3+1]=this.positions[T*3+1]*P+S*X,this.positions[T*3+2]=0}for(let T=0;T<b;T++){const x=T*_,I=Math.floor(x),U=x-I,R=this.oldPositions2[I*3+0]*(1-U)+this.oldPositions2[(I+1)*3+0]*U,S=this.oldPositions2[I*3+1]*(1-U)+this.oldPositions2[(I+1)*3+1]*U;this.positions2[T*3+0]=this.positions[(T+b)*3+0]*P+R*X,this.positions2[T*3+1]=this.positions[(T+b)*3+1]*P+S*X,this.positions2[T*3+2]=0}}else{const b=(this.oldNumVert-1)/this.numVert;for(let _=0;_<this.numVert;_++){const T=_*b,x=Math.floor(T),I=T-x,U=this.oldPositions[x*3+0]*(1-I)+this.oldPositions[(x+1)*3+0]*I,R=this.oldPositions[x*3+1]*(1-I)+this.oldPositions[(x+1)*3+1]*I;this.positions[_*3+0]=this.positions[_*3+0]*P+U*X,this.positions[_*3+1]=this.positions[_*3+1]*P+R*X,this.positions[_*3+2]=0}}for(let b=0;b<this.numVert;b++)this.positions[b*3+1]=-this.positions[b*3+1];if(this.smoothedNumVert=this.numVert*2-1,g.default.smoothWave(this.positions,this.smoothedPositions,this.numVert),c===7||f===7){for(let b=0;b<this.numVert;b++)this.positions2[b*3+1]=-this.positions2[b*3+1];g.default.smoothWave(this.positions2,this.smoothedPositions2,this.numVert)}return!0}return!1}drawBasicWaveform(e,s,i,a,h){if(this.generateWaveform(e,s,i,a,h)){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.smoothedPositions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc),this.gl.uniform4fv(this.colorLoc,this.color);let n=1;(h.wave_thick!==0||h.wave_dots!==0)&&(n=4),h.additivewave!==0?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE):this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);const r=h.wave_dots!==0?this.gl.POINTS:this.gl.LINE_STRIP;for(let v=0;v<n;v++)v===0?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):v===1?this.gl.uniform2fv(this.thickOffsetLoc,[2/this.texsizeX,0]):v===2?this.gl.uniform2fv(this.thickOffsetLoc,[0,2/this.texsizeY]):v===3&&this.gl.uniform2fv(this.thickOffsetLoc,[2/this.texsizeX,2/this.texsizeY]),this.gl.drawArrays(r,0,this.smoothedNumVert);if(Math.floor(h.wave_mode)%8===7){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.smoothedPositions2,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc);for(let v=0;v<n;v++)v===0?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):v===1?this.gl.uniform2fv(this.thickOffsetLoc,[2/this.texsizeX,0]):v===2?this.gl.uniform2fv(this.thickOffsetLoc,[0,2/this.texsizeY]):v===3&&this.gl.uniform2fv(this.thickOffsetLoc,[2/this.texsizeX,2/this.texsizeY]),this.gl.drawArrays(r,0,this.smoothedNumVert)}}}}},"./src/rendering/waves/customWaveform.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return t});var l=m("./src/utils.js"),g=m("./src/rendering/shaders/shaderUtils.js"),A=m("./src/rendering/waves/waveUtils.js");class t{constructor(s,i,a){this.index=s,this.gl=i;const h=512;this.pointsData=[new Float32Array(h),new Float32Array(h)],this.positions=new Float32Array(h*3),this.colors=new Float32Array(h*4),this.smoothedPositions=new Float32Array((h*2-1)*3),this.smoothedColors=new Float32Array((h*2-1)*4),this.texsizeX=a.texsizeX,this.texsizeY=a.texsizeY,this.mesh_width=a.mesh_width,this.mesh_height=a.mesh_height,this.aspectx=a.aspectx,this.aspecty=a.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.positionVertexBuf=this.gl.createBuffer(),this.colorVertexBuf=this.gl.createBuffer(),this.floatPrecision=g.default.getFragmentFloatPrecision(this.gl),this.createShader()}updateGlobals(s){this.texsizeX=s.texsizeX,this.texsizeY=s.texsizeY,this.mesh_width=s.mesh_width,this.mesh_height=s.mesh_height,this.aspectx=s.aspectx,this.aspecty=s.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}createShader(){this.shaderProgram=this.gl.createProgram();const s=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(s,`
      #version 300 es
      uniform float uSize;
      uniform vec2 thickOffset;
      in vec3 aPos;
      in vec4 aColor;
      out vec4 vColor;
      void main(void) {
        vColor = aColor;
        gl_PointSize = uSize;
        gl_Position = vec4(aPos + vec3(thickOffset, 0.0), 1.0);
      }
      `.trim()),this.gl.compileShader(s);const i=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(i,`
      #version 300 es
      precision ${this.floatPrecision} float;
      precision highp int;
      precision mediump sampler2D;
      in vec4 vColor;
      out vec4 fragColor;
      void main(void) {
        fragColor = vColor;
      }
      `.trim()),this.gl.compileShader(i),this.gl.attachShader(this.shaderProgram,s),this.gl.attachShader(this.shaderProgram,i),this.gl.linkProgram(this.shaderProgram),this.aPosLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.aColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aColor"),this.sizeLoc=this.gl.getUniformLocation(this.shaderProgram,"uSize"),this.thickOffsetLoc=this.gl.getUniformLocation(this.shaderProgram,"thickOffset")}generateWaveform(s,i,a,h,n,r,u,v){if(u.baseVals.enabled!==0&&s.length>0){let c;if(r.preset.useWASM)c=r.runWaveFrameEquations(this.index,n);else{const x=Object.assign({},r.mdVSWaves[this.index],r.mdVSFrameMapWaves[this.index],r.mdVSQAfterFrame,r.mdVSTWaveInits[this.index],n);c=r.runWaveFrameEquations(this.index,x)}const f=512;Object.prototype.hasOwnProperty.call(c,"samples")?this.samples=c.samples:this.samples=f,this.samples>f&&(this.samples=f),this.samples=Math.floor(this.samples);const o=r.preset.waves[this.index].baseVals,p=Math.floor(c.sep),d=c.scaling,P=c.spectrum,X=c.smoothing,M=o.usedots,C=c.r,w=c.g,b=c.b,_=c.a,T=r.preset.baseVals.wave_scale;if(this.samples-=p,this.samples>=2||M!==0&&this.samples>=1){const x=P!==0,I=(x?.15:.004)*d*T,U=x?a:s,R=x?h:i,S=x?0:Math.floor((f-this.samples)/2-p/2),y=x?0:Math.floor((f-this.samples)/2+p/2),F=x?(f-p)/this.samples:1,D=(X*.98)**.5,z=1-D;this.pointsData[0][0]=U[S],this.pointsData[1][0]=R[y];for(let O=1;O<this.samples;O++){const V=U[Math.floor(O*F+S)],K=R[Math.floor(O*F+y)];this.pointsData[0][O]=V*z+this.pointsData[0][O-1]*D,this.pointsData[1][O]=K*z+this.pointsData[1][O-1]*D}for(let O=this.samples-2;O>=0;O--)this.pointsData[0][O]=this.pointsData[0][O]*z+this.pointsData[0][O+1]*D,this.pointsData[1][O]=this.pointsData[1][O]*z+this.pointsData[1][O+1]*D;for(let O=0;O<this.samples;O++)this.pointsData[0][O]*=I,this.pointsData[1][O]*=I;if(r.preset.useWASM){const O=r.preset.globalPools[`wavePerFrame${this.index}`];for(let V=0;V<this.samples;V++){const K=this.pointsData[0][V],B=this.pointsData[1][V];O.sample.value=V/(this.samples-1),O.value1.value=K,O.value2.value=B,O.x.value=.5+K,O.y.value=.5+B,O.r.value=C,O.g.value=w,O.b.value=b,O.a.value=_,u.point_eqs&&r.preset.waves[this.index].point_eqs();const Q=(O.x.value*2-1)*this.invAspectx,N=(O.y.value*-2+1)*this.invAspecty,q=O.r.value,Y=O.g.value,L=O.b.value,it=O.a.value;this.positions[V*3+0]=Q,this.positions[V*3+1]=N,this.positions[V*3+2]=0,this.colors[V*4+0]=q,this.colors[V*4+1]=Y,this.colors[V*4+2]=L,this.colors[V*4+3]=it*v}}else for(let O=0;O<this.samples;O++){const V=this.pointsData[0][O],K=this.pointsData[1][O];c.sample=O/(this.samples-1),c.value1=V,c.value2=K,c.x=.5+V,c.y=.5+K,c.r=C,c.g=w,c.b=b,c.a=_,u.point_eqs!==""&&(c=r.runWavePointEquations(this.index,c));const B=(c.x*2-1)*this.invAspectx,Q=(c.y*-2+1)*this.invAspecty,N=c.r,q=c.g,Y=c.b,L=c.a;this.positions[O*3+0]=B,this.positions[O*3+1]=Q,this.positions[O*3+2]=0,this.colors[O*4+0]=N,this.colors[O*4+1]=q,this.colors[O*4+2]=Y,this.colors[O*4+3]=L*v}if(r.preset.useWASM)c.usedots=M,c.thick=o.thick,c.additive=o.additive;else{const O=r.mdVSUserKeysWaves[this.index],V=l.default.pick(c,O);r.mdVSFrameMapWaves[this.index]=V}return this.mdVSWaveFrame=c,M===0&&A.default.smoothWaveAndColor(this.positions,this.colors,this.smoothedPositions,this.smoothedColors,this.samples),!0}}return!1}drawCustomWaveform(s,i,a,h,n,r,u,v){if(v&&this.generateWaveform(i,a,h,n,r,u,v,s)){this.gl.useProgram(this.shaderProgram);const c=this.mdVSWaveFrame.usedots!==0,f=this.mdVSWaveFrame.thick!==0,o=this.mdVSWaveFrame.additive!==0;let p,d,P;c?(p=this.positions,d=this.colors,P=this.samples):(p=this.smoothedPositions,d=this.smoothedColors,P=this.samples*2-1),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,p,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,d,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation);let X=1;c?f?this.gl.uniform1f(this.sizeLoc,2+(this.texsizeX>=1024?1:0)):this.gl.uniform1f(this.sizeLoc,1+(this.texsizeX>=1024?1:0)):(this.gl.uniform1f(this.sizeLoc,1),f&&(X=4)),o?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE):this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);const M=c?this.gl.POINTS:this.gl.LINE_STRIP;for(let C=0;C<X;C++)C===0?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):C===1?this.gl.uniform2fv(this.thickOffsetLoc,[2/this.texsizeX,0]):C===2?this.gl.uniform2fv(this.thickOffsetLoc,[0,2/this.texsizeY]):C===3&&this.gl.uniform2fv(this.thickOffsetLoc,[2/this.texsizeX,2/this.texsizeY]),this.gl.drawArrays(M,0,P)}}}},"./src/rendering/waves/waveUtils.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return l});class l{static smoothWave(A,t,e,s=!1){let u=0,v=0,c,f=1;for(let o=0;o<e-1;o++){c=f,f=Math.min(e-1,o+2);for(let p=0;p<3;p++)t[u*3+p]=A[o*3+p];if(s)for(let p=0;p<3;p++)t[(u+1)*3+p]=(-.15*A[v*3+p]+1.15*A[o*3+p]+1.15*A[c*3+p]+-.15*A[f*3+p])*.5;else{for(let p=0;p<2;p++)t[(u+1)*3+p]=(-.15*A[v*3+p]+1.15*A[o*3+p]+1.15*A[c*3+p]+-.15*A[f*3+p])*.5;t[(u+1)*3+2]=0}v=o,u+=2}for(let o=0;o<3;o++)t[u*3+o]=A[(e-1)*3+o]}static smoothWaveAndColor(A,t,e,s,i,a=!1){let c=0,f=0,o,p=1;for(let d=0;d<i-1;d++){o=p,p=Math.min(i-1,d+2);for(let P=0;P<3;P++)e[c*3+P]=A[d*3+P];if(a)for(let P=0;P<3;P++)e[(c+1)*3+P]=(-.15*A[f*3+P]+1.15*A[d*3+P]+1.15*A[o*3+P]+-.15*A[p*3+P])*.5;else{for(let P=0;P<2;P++)e[(c+1)*3+P]=(-.15*A[f*3+P]+1.15*A[d*3+P]+1.15*A[o*3+P]+-.15*A[p*3+P])*.5;e[(c+1)*3+2]=0}for(let P=0;P<4;P++)s[c*4+P]=t[d*4+P],s[(c+1)*4+P]=t[d*4+P];f=d,c+=2}for(let d=0;d<3;d++)e[c*3+d]=A[(i-1)*3+d];for(let d=0;d<4;d++)s[c*4+d]=t[(i-1)*4+d]}}},"./src/utils.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return l});class l{static atan2(A,t){let e=Math.atan2(A,t);return e<0&&(e+=2*Math.PI),e}static cloneVars(A){return Object.assign({},A)}static range(A,t){return t===void 0?[...Array(A).keys()]:Array.from({length:t-A},(e,s)=>s+A)}static pick(A,t){const e={};for(let s=0;s<t.length;s++){const i=t[s];e[i]=A[i]||0}return e}static omit(A,t){const e=Object.assign({},A);for(let s=0;s<t.length;s++){const i=t[s];delete e[i]}return e}static setWasm(A,t,e){for(let s=0;s<e.length;s++){const i=e[s];A[i].value=t[i]}}static pickWasm(A,t){const e={};for(let s=0;s<t.length;s++){const i=t[s];e[i]=A[i].value}return e}}},"./src/visualizer.js":function(j,E,m){m.r(E),m.d(E,"default",function(){return u});var l=m("./node_modules/@babel/runtime/helpers/defineProperty.js"),g=m.n(l),A=m("./node_modules/eel-wasm/dist/src/index.js"),t=m("./node_modules/@assemblyscript/loader/index.js"),e=m("./src/audio/audioProcessor.js"),s=m("./src/rendering/renderer.js"),i=m("./src/utils.js"),a=m("./src/assemblyscript/presetFunctions.ts"),h=m.n(a);function n(v,c){var f=Object.keys(v);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(v);c&&(o=o.filter(function(p){return Object.getOwnPropertyDescriptor(v,p).enumerable})),f.push.apply(f,o)}return f}function r(v){for(var c=1;c<arguments.length;c++){var f=arguments[c]!=null?arguments[c]:{};c%2?n(Object(f),!0).forEach(function(o){g()(v,o,f[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(f)):n(Object(f)).forEach(function(o){Object.defineProperty(v,o,Object.getOwnPropertyDescriptor(f,o))})}return v}class u{constructor(c,f,o){this.opts=o,this.audio=new e.default(c);const p=o.width||1200,d=o.height||900;this.internalCanvas=document.createElement("canvas"),this.internalCanvas.width=p,this.internalCanvas.height=d,this.gl=this.internalCanvas.getContext("webgl2",{alpha:!1,antialias:!1,depth:!1,stencil:!1,premultipliedAlpha:!1}),this.outputGl=f.getContext("2d"),this.baseValsDefaults={decay:.98,gammaadj:2,echo_zoom:2,echo_alpha:0,echo_orient:0,red_blue:0,brighten:0,darken:0,wrap:1,darken_center:0,solarize:0,invert:0,bmotionvectorson:1,fshader:0,b1n:0,b2n:0,b3n:0,b1x:1,b2x:1,b3x:1,b1ed:.25,wave_mode:0,additivewave:0,wave_dots:0,wave_thick:0,wave_a:.8,wave_scale:1,wave_smoothing:.75,wave_mystery:0,modwavealphabyvolume:0,modwavealphastart:.75,modwavealphaend:.95,wave_r:1,wave_g:1,wave_b:1,wave_x:.5,wave_y:.5,wave_brighten:1,mv_x:12,mv_y:9,mv_dx:0,mv_dy:0,mv_l:.9,mv_r:1,mv_g:1,mv_b:1,mv_a:1,warpanimspeed:1,warpscale:1,zoomexp:1,zoom:1,rot:0,cx:.5,cy:.5,dx:0,dy:0,warp:1,sx:1,sy:1,ob_size:.01,ob_r:0,ob_g:0,ob_b:0,ob_a:0,ib_size:.01,ib_r:.25,ib_g:.25,ib_b:.25,ib_a:0},this.shapeBaseValsDefaults={enabled:0,sides:4,additive:0,thickoutline:0,textured:0,num_inst:1,tex_zoom:1,tex_ang:0,x:.5,y:.5,rad:.1,ang:0,r:1,g:0,b:0,a:1,r2:0,g2:1,b2:0,a2:0,border_r:1,border_g:1,border_b:1,border_a:.1},this.waveBaseValsDefaults={enabled:0,samples:512,sep:0,scaling:1,smoothing:.5,r:1,g:1,b:1,a:1,spectrum:0,usedots:0,thick:0,additive:0},this.qs=i.default.range(1,33).map(P=>`q${P}`),this.ts=i.default.range(1,9).map(P=>`t${P}`),this.globalPerFrameVars=["old_wave_mode","frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy","rand_start","rand_preset"],this.globalPerPixelVars=["frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy","rand_start","rand_preset","x","y","rad","ang"],this.globalShapeVars=["frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy","rand_start","rand_preset","instance"],this.shapeBaseVars=["x","y","rad","ang","r","g","b","a","r2","g2","b2","a2","border_r","border_g","border_b","border_a","thickoutline","textured","tex_zoom","tex_ang","additive"],this.globalWaveVars=["frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy","rand_start","rand_preset","x","y","sample","value1","value2"],this.renderer=new s.default(this.gl,this.audio,o)}loseGLContext(){this.gl.getExtension("WEBGL_lose_context").loseContext(),this.outputGl=null}connectAudio(c){this.audioNode=c,this.audio.connectAudio(c)}disconnectAudio(c){this.audio.disconnectAudio(c)}static overrideDefaultVars(c,f){const o={};return Object.keys(c).forEach(p=>{Object.prototype.hasOwnProperty.call(f,p)?o[p]=f[p]:o[p]=c[p]}),o}createQVars(){const c={};return this.qs.forEach(f=>{c[f]=new WebAssembly.Global({value:"f64",mutable:!0},0)}),c}createTVars(){const c={};return this.ts.forEach(f=>{c[f]=new WebAssembly.Global({value:"f64",mutable:!0},0)}),c}createPerFramePool(c){const f={};return Object.keys(this.baseValsDefaults).forEach(o=>{f[o]=new WebAssembly.Global({value:"f64",mutable:!0},c[o])}),this.globalPerFrameVars.forEach(o=>{f[o]=new WebAssembly.Global({value:"f64",mutable:!0},0)}),f}createPerPixelPool(c){const f={};return Object.keys(this.baseValsDefaults).forEach(o=>{f[o]=new WebAssembly.Global({value:"f64",mutable:!0},c[o])}),this.globalPerPixelVars.forEach(o=>{f[o]=new WebAssembly.Global({value:"f64",mutable:!0},0)}),f}createCustomShapePerFramePool(c){const f={};return Object.keys(this.shapeBaseValsDefaults).forEach(o=>{f[o]=new WebAssembly.Global({value:"f64",mutable:!0},c[o])}),this.globalShapeVars.forEach(o=>{f[o]=new WebAssembly.Global({value:"f64",mutable:!0},0)}),f}createCustomWavePerFramePool(c){const f={};return Object.keys(this.waveBaseValsDefaults).forEach(o=>{f[o]=new WebAssembly.Global({value:"f64",mutable:!0},c[o])}),this.globalWaveVars.forEach(o=>{f[o]=new WebAssembly.Global({value:"f64",mutable:!0},0)}),f}static makeShapeResetPool(c,f,o){return f.reduce((p,d)=>r(r({},p),{},{[`${d}_${o}`]:c[d]}),{})}static base64ToArrayBuffer(c){for(var f=window.atob(c),o=f.length,p=new Uint8Array(o),d=0;d<o;d++)p[d]=f.charCodeAt(d);return p.buffer}async loadPreset(c,f=0){const o=JSON.parse(JSON.stringify(c));o.baseVals=u.overrideDefaultVars(this.baseValsDefaults,o.baseVals);for(let d=0;d<o.shapes.length;d++)o.shapes[d].baseVals=u.overrideDefaultVars(this.shapeBaseValsDefaults,o.shapes[d].baseVals);for(let d=0;d<o.waves.length;d++)o.waves[d].baseVals=u.overrideDefaultVars(this.waveBaseValsDefaults,o.waves[d].baseVals);const p=o.useJS&&!this.opts.onlyUseWASM;Object.prototype.hasOwnProperty.call(o,"init_eqs_eel")&&!p?(o.useWASM=!0,await this.loadWASMPreset(o,f)):this.opts.onlyUseWASM?console.warn("Tried to load a preset that doesn't support WASM with onlyUseWASM on"):Object.prototype.hasOwnProperty.call(o,"init_eqs_str")?this.loadJSPreset(o,f):console.warn("Tried to load a JS preset that doesn't have converted strings")}async loadWASMPreset(c,f){const o=this.createQVars(),p=this.createTVars(),d={perFrame:r(r({},o),this.createPerFramePool(c.baseVals)),perVertex:r(r({},o),this.createPerPixelPool(c.baseVals))},P={presetInit:{pool:"perFrame",code:c.init_eqs_eel},perFrame:{pool:"perFrame",code:c.frame_eqs_eel}};c.pixel_eqs_eel!==""&&(P.perPixel={pool:"perVertex",code:c.pixel_eqs_eel});for(let w=0;w<c.shapes.length;w++)d[`shapePerFrame${w}`]=r(r(r({},o),p),this.createCustomShapePerFramePool(c.shapes[w].baseVals)),c.shapes[w].baseVals.enabled!==0&&(P[`shapes_${w}_init_eqs`]={pool:`shapePerFrame${w}`,code:c.shapes[w].init_eqs_eel},P[`shapes_${w}_frame_eqs`]={pool:`shapePerFrame${w}`,code:c.shapes[w].frame_eqs_eel});for(let w=0;w<c.waves.length;w++)c.waves[w].baseVals.enabled!==0&&(d[`wavePerFrame${w}`]=r(r(r({},o),p),this.createCustomWavePerFramePool(c.waves[w].baseVals)),P[`waves_${w}_init_eqs`]={pool:`wavePerFrame${w}`,code:c.waves[w].init_eqs_eel},P[`waves_${w}_frame_eqs`]={pool:`wavePerFrame${w}`,code:c.waves[w].frame_eqs_eel},c.waves[w].point_eqs_eel&&c.waves[w].point_eqs_eel!==""&&(P[`waves_${w}_point_eqs`]={pool:`wavePerFrame${w}`,code:c.waves[w].point_eqs_eel}));const X=await Object(A.loadModule)({pools:d,functions:P,eelVersion:c.version||2}),M=w=>w||(()=>{}),C=await t.default.instantiate(u.base64ToArrayBuffer(h()()),{pixelEqs:{perPixelEqs:M(X.exports.perPixel)},pixelVarPool:{warp:d.perVertex.warp,zoom:d.perVertex.zoom,zoomexp:d.perVertex.zoomexp,cx:d.perVertex.cx,cy:d.perVertex.cy,sx:d.perVertex.sx,sy:d.perVertex.sy,dx:d.perVertex.dx,dy:d.perVertex.dy,rot:d.perVertex.rot,x:d.perVertex.x,y:d.perVertex.y,ang:d.perVertex.ang,rad:d.perVertex.rad},qVarPool:o,tVarPool:p,shapePool0:u.makeShapeResetPool(d.shapePerFrame0,this.shapeBaseVars,0),shapePool1:u.makeShapeResetPool(d.shapePerFrame1,this.shapeBaseVars,1),shapePool2:u.makeShapeResetPool(d.shapePerFrame2,this.shapeBaseVars,2),shapePool3:u.makeShapeResetPool(d.shapePerFrame3,this.shapeBaseVars,3),console:{logi:w=>{console.log("logi: "+w)},logf:w=>{console.log("logf: "+w)}},env:{abort:()=>{}}});c.globalPools=d,c.init_eqs=M(X.exports.presetInit),c.frame_eqs=M(X.exports.perFrame),c.save_qs=C.exports.saveQs,c.restore_qs=C.exports.restoreQs,c.save_ts=C.exports.saveTs,c.restore_ts=C.exports.restoreTs,X.exports.perPixel&&(c.pixel_eqs=X.exports.perPixel),c.pixel_eqs_initialize_array=(w,b)=>{const _=C.exports.createFloat32Array((w+1)*(b+1)*2);c.pixel_eqs_array=_},c.pixel_eqs_get_array=()=>C.exports.__getFloat32ArrayView(c.pixel_eqs_array),c.pixel_eqs_wasm=(...w)=>C.exports.runPixelEquations(c.pixel_eqs_array,...w);for(let w=0;w<c.shapes.length;w++)c.shapes[w].baseVals.enabled!==0&&(c.shapes[w].init_eqs=M(X.exports[`shapes_${w}_init_eqs`]),c.shapes[w].frame_eqs=X.exports[`shapes_${w}_frame_eqs`],c.shapes[w].frame_eqs_save=()=>C.exports[`shape${w}_save`](),c.shapes[w].frame_eqs_restore=()=>C.exports[`shape${w}_restore`]());for(let w=0;w<c.waves.length;w++)if(c.waves[w].baseVals.enabled!==0){const b={init_eqs:M(X.exports[`waves_${w}_init_eqs`]),frame_eqs:M(X.exports[`waves_${w}_frame_eqs`])};c.waves[w].point_eqs_eel&&c.waves[w].point_eqs_eel!==""?b.point_eqs=X.exports[`waves_${w}_point_eqs`]:b.point_eqs="",c.waves[w]=Object.assign({},c.waves[w],b)}this.renderer.loadPreset(c,f)}loadJSPreset(c,f){if(typeof c.init_eqs!="function"){c.init_eqs=new Function("a",`${c.init_eqs_str} return a;`),c.frame_eqs=new Function("a",`${c.frame_eqs_str} return a;`),c.pixel_eqs_str&&c.pixel_eqs_str!==""?c.pixel_eqs=new Function("a",`${c.pixel_eqs_str} return a;`):c.pixel_eqs="";for(let o=0;o<c.shapes.length;o++)c.shapes[o].baseVals.enabled!==0&&(c.shapes[o]=Object.assign({},c.shapes[o],{init_eqs:new Function("a",`${c.shapes[o].init_eqs_str} return a;`),frame_eqs:new Function("a",`${c.shapes[o].frame_eqs_str} return a;`)}));for(let o=0;o<c.waves.length;o++)if(c.waves[o].baseVals.enabled!==0){const p={init_eqs:new Function("a",`${c.waves[o].init_eqs_str} return a;`),frame_eqs:new Function("a",`${c.waves[o].frame_eqs_str} return a;`)};c.waves[o].point_eqs_str&&c.waves[o].point_eqs_str!==""?p.point_eqs=new Function("a",`${c.waves[o].point_eqs_str} return a;`):p.point_eqs="",c.waves[o]=Object.assign({},c.waves[o],p)}}this.renderer.loadPreset(c,f)}loadExtraImages(c){this.renderer.loadExtraImages(c)}setRendererSize(c,f,o={}){this.internalCanvas.width=c,this.internalCanvas.height=f,this.renderer.setRendererSize(c,f,o)}setInternalMeshSize(c,f){this.renderer.setInternalMeshSize(c,f)}setOutputAA(c){this.renderer.setOutputAA(c)}setCanvas(c){this.outputGl=c.getContext("2d")}render(c){const f=this.renderer.render(c);return this.outputGl&&this.outputGl.drawImage(this.internalCanvas,0,0),f}launchSongTitleAnim(c){this.renderer.launchSongTitleAnim(c)}toDataURL(){return this.renderer.toDataURL()}warpBufferToDataURL(){return this.renderer.warpBufferToDataURL()}}}})})}(pt)),pt.exports}var xt=bt();const Tt=vt(xt),wt=Object.freeze(Object.defineProperty({__proto__:null,default:Tt},Symbol.toStringTag,{value:"Module"}));export{wt as b};
